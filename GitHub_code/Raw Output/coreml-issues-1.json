{
  "total_count": 412,
  "incomplete_results": false,
  "items": [
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1451",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1451/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1451/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1451/events",
      "html_url": "https://github.com/apple/coremltools/issues/1451",
      "id": 1202057015,
      "node_id": "I_kwDOBba_B85Hpe83",
      "number": 1451,
      "title": "Is there an efficient way to pre-allocate a list of tensors?",
      "user": {
        "login": "JRGit4UE",
        "id": 7815524,
        "node_id": "MDQ6VXNlcjc4MTU1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7815524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JRGit4UE",
        "html_url": "https://github.com/JRGit4UE",
        "followers_url": "https://api.github.com/users/JRGit4UE/followers",
        "following_url": "https://api.github.com/users/JRGit4UE/following{/other_user}",
        "gists_url": "https://api.github.com/users/JRGit4UE/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/JRGit4UE/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/JRGit4UE/subscriptions",
        "organizations_url": "https://api.github.com/users/JRGit4UE/orgs",
        "repos_url": "https://api.github.com/users/JRGit4UE/repos",
        "events_url": "https://api.github.com/users/JRGit4UE/events{/privacy}",
        "received_events_url": "https://api.github.com/users/JRGit4UE/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-04-12T16:00:29Z",
      "updated_at": "2022-04-12T17:38:25Z",
      "closed_at": "2022-04-12T17:38:25Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I am trying to port a model from **PyTorch 1.9.1** to **CoreML** with **CoreMLTools 5.2.0**  \r\nOne of the issues I am struggling with deals with lists of tensors.  \r\n \r\nSince **append()** is not supported in CoreMLTools, I can workaround with pre-allocated lists of tensors  \r\ne.g.\r\n```\r\ndef forward(self, x)->List[Tensor]: # or ->List[Optional[Tensor]]:\r\n    a: Tensor = torch.zeros(1, dtype=torch.float32) # placeholder\r\n    b: Tensor = a\r\n    result: List[Tensor] = [] # Does not work, as append()-ing to result is not allowed\r\n    result: List[Optional[Tensor]] = [None] # Does not work\r\n    result: List[Tensor] = [a] # Works, allows to set result[0] to something else\r\n    result: List[Tensor] = [a] * 5 # Does not work # AttributeError: 'list' object has no attribute 'dtype' \r\n    result: List[Tensor] = [a, a] # Does not work # ValueError: Ops ['identity_0'] not found in block block0\r\n    result: List[Tensor] = [a, b] # Does not work # ValueError: Ops ['identity_0'] not found in block block0\r\n    result: List[Tensor] = [a, torch.zeros(1, dtype=torch.float32)] # Works, allows to set result[0] and result[1] \r\n\r\n    result[0] = self.do-something-with(x)\r\n    result[1] = self.do-another-something()\r\n    return result\r\n```\r\nAs only pre-allocation with different tensors seems to be my possible choice, the question is  \r\nabout the most efficient way to pre-allocate such a list of  tensors?\r\nThx\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1451/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1451/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1449",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1449/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1449/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1449/events",
      "html_url": "https://github.com/apple/coremltools/issues/1449",
      "id": 1199510254,
      "node_id": "I_kwDOBba_B85HfxLu",
      "number": 1449,
      "title": "Hello, what does this error represent? What should I do?",
      "user": {
        "login": "Wangzhipeng777",
        "id": 48475293,
        "node_id": "MDQ6VXNlcjQ4NDc1Mjkz",
        "avatar_url": "https://avatars.githubusercontent.com/u/48475293?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Wangzhipeng777",
        "html_url": "https://github.com/Wangzhipeng777",
        "followers_url": "https://api.github.com/users/Wangzhipeng777/followers",
        "following_url": "https://api.github.com/users/Wangzhipeng777/following{/other_user}",
        "gists_url": "https://api.github.com/users/Wangzhipeng777/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Wangzhipeng777/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Wangzhipeng777/subscriptions",
        "organizations_url": "https://api.github.com/users/Wangzhipeng777/orgs",
        "repos_url": "https://api.github.com/users/Wangzhipeng777/repos",
        "events_url": "https://api.github.com/users/Wangzhipeng777/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Wangzhipeng777/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-04-11T07:23:33Z",
      "updated_at": "2022-04-13T02:14:56Z",
      "closed_at": "2022-04-13T02:14:55Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Traceback (most recent call last):\r\n  File \"convert.py\", line 12, in <module>\r\n    coreml_model = convert(model_proto, image_input_names=['input'], image_output_names=['output'],minimum_ios_deployment_target='13')\r\n  File \"/home/deeplab/anaconda3/envs/onnxrun/lib/python3.6/site-packages/onnx_coreml/converter.py\", line 501, in convert\r\n    graph = _prepare_onnx_graph(onnx_model.graph, transformers, onnx_model.ir_version)\r\n  File \"/home/deeplab/anaconda3/envs/onnxrun/lib/python3.6/site-packages/onnx_coreml/converter.py\", line 373, in _prepare_onnx_graph\r\n    graph_ = graph_.transformed(transformers)\r\n  File \"/home/deeplab/anaconda3/envs/onnxrun/lib/python3.6/site-packages/onnx_coreml/_graph.py\", line 201, in transformed\r\n    return _apply_graph_transformations(graph, transformers) # type: ignore\r\n  File \"/home/deeplab/anaconda3/envs/onnxrun/lib/python3.6/site-packages/onnx_coreml/_graph.py\", line 60, in _apply_graph_transformations\r\n    graph = transformer(graph)\r\n  File \"/home/deeplab/anaconda3/envs/onnxrun/lib/python3.6/site-packages/onnx_coreml/_transformers.py\", line 758, in __call__\r\n    ends = node.attrs['ends']\r\nKeyError: 'ends'\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1449/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1449/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1428",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1428/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1428/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1428/events",
      "html_url": "https://github.com/apple/coremltools/issues/1428",
      "id": 1177455840,
      "node_id": "I_kwDOBba_B85GLozg",
      "number": 1428,
      "title": "Prediction Mismatch between Pytorch and CoreML",
      "user": {
        "login": "b8591340",
        "id": 70052269,
        "node_id": "MDQ6VXNlcjcwMDUyMjY5",
        "avatar_url": "https://avatars.githubusercontent.com/u/70052269?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/b8591340",
        "html_url": "https://github.com/b8591340",
        "followers_url": "https://api.github.com/users/b8591340/followers",
        "following_url": "https://api.github.com/users/b8591340/following{/other_user}",
        "gists_url": "https://api.github.com/users/b8591340/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/b8591340/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/b8591340/subscriptions",
        "organizations_url": "https://api.github.com/users/b8591340/orgs",
        "repos_url": "https://api.github.com/users/b8591340/repos",
        "events_url": "https://api.github.com/users/b8591340/events{/privacy}",
        "received_events_url": "https://api.github.com/users/b8591340/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 0,
      "created_at": "2022-03-23T00:44:39Z",
      "updated_at": "2022-03-24T19:24:11Z",
      "closed_at": "2022-03-24T19:24:11Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "```\r\npython: 3.8.12\r\npytorch: 1.10.2\r\nnumpy: 1.22.3\r\ntransformers: 4.17.0\r\ncoremltools: 5.2.0\r\nvenv\r\nmacOS 12.3 on M1\r\n```\r\n\r\n```python\r\nimport numpy as np\r\nimport torch.nn.functional as F\r\nimport torch\r\nfrom transformers import AutoTokenizer, AutoModel\r\nimport coremltools as ct\r\n\r\ndef mean_pooling(token_embeddings, attention_mask):\r\n    input_mask_expanded = attention_mask.unsqueeze(-1).expand(token_embeddings.size()).float()\r\n    return torch.sum(token_embeddings * input_mask_expanded, 1) / torch.clamp(input_mask_expanded.sum(1), min=1e-9)\r\n\r\nsentences = ['This is an example sentence', 'Each sentence is converted']\r\n\r\ntokenizer = AutoTokenizer.from_pretrained('sentence-transformers/all-MiniLM-L12-v2')\r\nmodel     =     AutoModel.from_pretrained('sentence-transformers/all-MiniLM-L12-v2', torchscript=True).eval()\r\n\r\nencoded_input = tokenizer(sentences, padding=True, truncation=True, return_tensors='pt')\r\n\r\ntraced_model   = torch.jit.trace(model, tuple(encoded_input.values()))\r\nscripted_model = torch.jit.script(traced_model)\r\n\r\nmodel = ct.convert(scripted_model, source=\"pytorch\",\r\n                   inputs=[ct.TensorType(name=\"input_ids\",      shape=encoded_input.input_ids.shape,      dtype=np.int32),\r\n                           ct.TensorType(name=\"token_type_ids\", shape=encoded_input.token_type_ids.shape, dtype=np.int32),\r\n                           ct.TensorType(name=\"attention_mask\", shape=encoded_input.attention_mask.shape, dtype=np.int32)],\r\n                   convert_to=\"mlprogram\")\r\nmodel.save(\"all-MiniLM-L12-v2.mlpackage\")\r\n\r\nwith torch.no_grad():\r\n    t_output = scripted_model(**encoded_input)\r\n\r\ns_emb = mean_pooling(t_output[0], encoded_input.attention_mask)\r\ns_emb = F.normalize(s_emb, p=2, dim=1)\r\n\r\nprint(t_output)\r\nprint(t_output[0])\r\nprint(s_emb)\r\n\r\ncml_inputs = {k: v.to(torch.int32).numpy() for k, v in encoded_input.items()}\r\ns_emb_cml = model.predict(cml_inputs)\r\nprint(s_emb_cml)\r\ns_emb_cml = torch.tensor(s_emb_cml['hidden_states'])\r\nprint(s_emb_cml)\r\ns_emb_cml = mean_pooling(s_emb_cml, encoded_input.attention_mask)\r\ns_emb_cml = F.normalize(s_emb_cml, p=2, dim=1)\r\n\r\nprint(s_emb_cml)\r\n```\r\n\r\nOther than having to convert to `np.int32` (#1039), these are the warnings:\r\n\r\n```\r\nWARNING:root:Tuple detected at graph output. This will be flattened in the converted model.`\r\nWARNING:root:CoreML embedding (gather) layer does not support any inputs besides the weights and indices. Those given will be ignored.\r\n```\r\n\r\n<details>\r\n<summary>PyTorch</summary>\r\n\r\n```\r\n\r\n(tensor([[[ 0.0519, -0.0301,  0.2138,  ...,  0.1786,  0.0573, -0.0119],\r\n         [-0.1315,  0.6603,  0.1879,  ...,  0.1245,  0.7793,  0.3559],\r\n         [-0.3818,  0.8267, -0.1493,  ...,  0.5605,  0.6444,  0.0144],\r\n         ...,\r\n         [ 0.2044,  0.2914, -0.1791,  ...,  0.6415, -0.1513,  0.3829],\r\n         [ 0.3050,  0.1932,  0.5416,  ...,  0.2212, -0.1725, -1.3564],\r\n         [ 0.0519, -0.0301,  0.2138,  ...,  0.1786,  0.0573, -0.0119]],\r\n\r\n        [[ 0.1354, -0.0059, -0.0358,  ...,  0.1728, -0.0623,  0.0604],\r\n         [ 0.3847,  0.2801, -0.0853,  ...,  0.0207, -0.0719, -0.1033],\r\n         [ 0.4146,  0.1954,  0.2227,  ...,  0.3385,  0.0899, -1.2342],\r\n         ...,\r\n         [ 0.4115,  0.3859, -0.3168,  ..., -0.0344,  0.3251, -0.3241],\r\n         [ 0.1354, -0.0059, -0.0358,  ...,  0.1728, -0.0623,  0.0604],\r\n         [ 0.1354, -0.0059, -0.0358,  ...,  0.1728, -0.0623,  0.0604]]]), tensor([[-1.1637e-02,  4.3438e-02,  1.1005e-02,  7.3876e-02, -4.0274e-03,\r\n         -5.1419e-02,  8.0025e-02,  3.4098e-02, -5.1265e-02, -8.0178e-03,\r\n         -1.8577e-02,  5.7345e-03, -1.9360e-03, -7.2690e-03, -2.4573e-02,\r\n          4.5442e-03,  2.6857e-02,  4.1663e-03, -1.3409e-02,  4.3999e-02,\r\n         -2.6221e-02, -6.5087e-03,  2.7203e-02, -4.4586e-03,  1.8633e-02,\r\n          8.3428e-02, -2.6539e-02, -5.2575e-02,  1.7507e-02,  6.4603e-02,\r\n          3.2941e-02,  8.3957e-02, -3.7839e-02,  1.0957e-02,  1.9769e-02,\r\n          1.2902e-02, -2.2633e-03,  2.9233e-02, -1.0109e-02, -2.9243e-02,\r\n          3.7460e-02,  2.2684e-02, -4.5474e-02,  3.7973e-02, -3.2218e-03,\r\n          2.0561e-02, -7.8137e-02, -4.7217e-03, -2.1800e-02,  3.1887e-02,\r\n         -7.8155e-02,  4.4641e-02,  1.6375e-02, -3.1566e-02, -1.1186e-02,\r\n         -2.8705e-02,  6.6696e-02,  3.8438e-02,  2.2163e-02,  2.4225e-02,\r\n          9.9407e-03,  2.7421e-02, -1.4204e-02,  1.7012e-02, -7.1283e-03,\r\n          6.3867e-04, -3.9536e-02, -8.5272e-02,  7.2112e-03, -2.4628e-02,\r\n         -2.3086e-02, -1.1556e-03,  1.1238e-02,  1.7366e-02, -2.0846e-02,\r\n          2.6787e-02, -1.9572e-02,  4.6982e-02, -1.3359e-02,  4.5756e-02,\r\n          5.5587e-02,  2.1910e-02,  4.5829e-02, -9.7479e-03, -4.8961e-02,\r\n         -5.5567e-02, -1.3715e-02,  7.6456e-02, -4.7371e-02,  4.0320e-02,\r\n          5.2951e-02,  1.2186e-02, -4.6224e-02,  4.9201e-02,  7.1436e-02,\r\n         -8.5114e-03,  5.4087e-03,  4.1609e-04, -7.8818e-02, -7.2572e-02,\r\n          2.5936e-02,  1.2622e-03, -5.5405e-02,  6.2350e-03,  2.2851e-02,\r\n         -4.1954e-02, -2.9527e-02,  5.7243e-02, -1.0347e-02,  2.3085e-02,\r\n          2.7804e-02,  1.0098e-02,  6.2157e-02,  3.4263e-02, -6.2499e-02,\r\n          3.7052e-02, -1.5950e-02, -8.3504e-03, -9.9704e-02,  6.6789e-02,\r\n          8.0486e-02, -5.8363e-02,  1.1420e-02,  1.7721e-02,  8.0641e-03,\r\n         -1.6337e-02,  2.3231e-02, -8.6311e-03, -7.8944e-02, -5.1679e-02,\r\n          1.0326e-01, -2.8727e-02,  3.0756e-02, -5.4355e-02, -1.3017e-02,\r\n          5.5566e-02, -1.0169e-02, -7.2519e-02, -1.7781e-02,  7.3861e-02,\r\n          4.5578e-02, -9.2612e-02, -1.0375e-02, -3.0164e-02,  2.0564e-02,\r\n          1.7890e-02, -7.0898e-02, -7.6322e-02, -4.1140e-02, -5.8775e-02,\r\n          7.2267e-02, -2.7976e-02, -5.0545e-02,  3.0302e-02, -1.0334e-02,\r\n          2.9446e-02,  1.3561e-02,  1.8946e-04,  2.1489e-03, -6.1226e-02,\r\n         -3.8928e-02, -5.2701e-02,  5.8804e-02,  5.1632e-02,  1.1442e-02,\r\n         -1.9341e-02, -9.9518e-05, -3.1024e-02, -3.1571e-03, -3.5719e-02,\r\n         -6.3383e-02, -1.2151e-02,  1.4217e-04, -6.3491e-02, -1.3159e-02,\r\n          3.8156e-02,  2.2042e-02, -3.6084e-02, -2.1935e-02, -1.8420e-02,\r\n          3.2427e-02, -4.7006e-02, -3.2963e-02, -2.6213e-02,  2.0160e-02,\r\n          1.4474e-02, -1.3222e-02, -1.0701e-02,  4.2277e-02, -9.5138e-03,\r\n          1.7696e-02,  2.3213e-02, -1.9542e-02,  3.0969e-02, -4.2152e-02,\r\n         -5.2581e-02, -3.5416e-02, -1.3903e-02,  2.6395e-02, -3.3919e-02,\r\n          6.5346e-03,  4.1743e-02, -9.3635e-03,  4.7801e-02, -3.4424e-02,\r\n          1.5371e-03, -1.4392e-02, -9.7107e-02,  9.0939e-03, -8.4884e-03,\r\n          6.7720e-02,  1.4276e-02,  2.1383e-03, -7.4074e-02, -5.3741e-02,\r\n         -3.9373e-02,  6.1707e-02,  7.2264e-02,  6.4885e-02, -3.1244e-02,\r\n         -2.6297e-02,  2.5506e-03, -3.2941e-03, -7.9622e-02, -7.5972e-02,\r\n         -3.2476e-02,  2.3078e-03, -4.2413e-02,  2.7338e-02,  3.1050e-02,\r\n         -3.4699e-02,  5.0878e-02,  3.1761e-02,  5.0234e-02, -3.5678e-03,\r\n         -3.1118e-03, -6.5132e-03, -1.5127e-02,  2.6090e-02,  3.6917e-02,\r\n         -8.7035e-02,  8.3993e-02,  3.4386e-03, -3.4088e-02, -3.1719e-02,\r\n          1.3637e-02,  4.9672e-02,  2.0191e-02, -3.5282e-02, -1.8682e-02,\r\n          4.8245e-02, -4.6952e-03,  8.2132e-03,  1.3297e-02, -4.6115e-02,\r\n          3.6300e-02,  5.3497e-02,  9.7878e-03,  2.8815e-02,  2.0836e-02,\r\n          9.4665e-03,  3.3347e-02, -1.2637e-02,  3.1219e-02, -5.2831e-02,\r\n          2.1369e-02,  4.7609e-02, -1.8184e-02, -5.3412e-02, -3.8579e-02,\r\n          3.3440e-02,  2.6687e-02, -7.1447e-02,  2.4320e-03,  3.6349e-02,\r\n          1.8165e-02, -1.4797e-03, -5.8302e-02,  6.3248e-02,  2.0998e-02,\r\n          1.5458e-02,  5.9330e-02,  4.4973e-02, -2.0015e-02,  4.2013e-02,\r\n         -2.0978e-02, -7.5661e-03, -4.2613e-02,  4.1515e-02,  4.9919e-02,\r\n         -1.7330e-02, -8.0984e-03, -1.0048e-02,  2.1131e-02, -1.8791e-02,\r\n          5.0610e-02,  3.1795e-02,  3.0162e-02,  1.7638e-02, -3.0876e-04,\r\n         -7.8138e-04, -4.0952e-02,  1.0451e-02, -3.8765e-02, -5.3474e-03,\r\n          2.8776e-02, -3.2460e-02, -4.3370e-02, -1.4338e-03, -8.6156e-04,\r\n          3.5997e-02,  6.1921e-02,  9.3925e-03,  5.7694e-02, -8.8538e-03,\r\n         -1.5782e-02, -4.0797e-03, -4.4272e-02,  3.0746e-03, -5.4605e-02,\r\n         -2.7912e-02, -5.1145e-02,  4.4330e-03,  4.8924e-02,  3.9556e-02,\r\n         -4.5181e-03,  1.9825e-02,  4.9739e-02, -3.7077e-02,  1.1502e-02,\r\n          1.4701e-02, -7.6187e-03,  3.0773e-02,  5.7829e-02,  1.8572e-02,\r\n         -4.4969e-02, -4.5410e-03,  7.3356e-04,  1.0993e-02,  2.4571e-02,\r\n         -1.8921e-02, -7.4363e-02,  1.3878e-03, -8.0367e-02,  2.7971e-02,\r\n         -6.9986e-02,  3.2894e-02,  8.8159e-03,  3.0742e-02, -4.5240e-02,\r\n         -2.5651e-02, -6.2415e-03,  6.0697e-02, -1.2084e-02,  3.4421e-02,\r\n         -6.0747e-02, -2.9464e-02,  2.9158e-03,  5.2349e-02, -2.8220e-02,\r\n          1.6866e-02, -3.1460e-02,  4.6467e-03, -4.7919e-02,  3.2750e-02,\r\n         -2.7960e-02,  1.8992e-02, -7.9851e-03,  2.0383e-02, -6.3057e-04,\r\n         -6.1400e-02,  4.2438e-02,  5.8125e-02,  4.1352e-02, -5.0970e-02,\r\n         -1.0355e-02, -6.5911e-02,  5.0877e-02,  1.5415e-02, -5.4691e-02,\r\n         -7.2964e-04, -1.4012e-02, -4.0532e-02, -3.7228e-02],\r\n        [-5.3036e-02,  4.0348e-02,  1.6017e-03,  5.2558e-02, -4.4198e-04,\r\n          3.2167e-02,  5.2063e-02,  1.9446e-02, -3.6935e-02,  3.7320e-02,\r\n         -4.2492e-02, -1.1438e-03,  3.7584e-02, -3.9674e-03, -6.3883e-02,\r\n          2.4663e-02, -5.8066e-03,  3.7606e-02, -4.6658e-02,  4.6543e-02,\r\n         -1.9175e-02,  6.1084e-03, -2.1122e-02, -7.2684e-02,  1.7017e-02,\r\n          6.7127e-02,  9.7433e-03, -2.8987e-02,  1.3721e-02,  8.4001e-02,\r\n          6.7893e-02,  2.9343e-02, -5.2049e-02,  2.7982e-03, -8.3397e-05,\r\n          2.1617e-02, -2.4285e-02,  5.8344e-02, -8.8264e-03,  6.8435e-02,\r\n          1.7942e-02,  4.7534e-02,  5.5181e-03,  6.5648e-02, -1.9064e-02,\r\n          3.2418e-02, -6.9140e-02,  4.1436e-02,  1.3415e-02,  2.8723e-03,\r\n         -8.8308e-02,  3.2858e-02,  5.5150e-02, -6.5797e-02,  2.3292e-02,\r\n          5.6008e-02,  5.7490e-02,  1.1735e-02,  1.3422e-02, -9.0829e-03,\r\n          3.2354e-02,  3.4055e-02, -2.0022e-02, -1.9271e-02,  1.2892e-02,\r\n         -1.5786e-02, -6.0912e-02, -7.7058e-02, -3.0411e-02,  5.4957e-03,\r\n         -3.2713e-02, -9.2179e-03, -6.5653e-03,  4.7593e-02, -3.4650e-03,\r\n          6.2347e-02, -4.7546e-02,  1.7897e-02,  4.4825e-04,  3.9374e-02,\r\n          9.5587e-02, -4.2439e-02,  5.6543e-02, -7.3343e-02, -6.5757e-02,\r\n          1.0509e-02, -2.0973e-02,  7.0843e-02, -6.4901e-02, -3.0399e-02,\r\n          4.4194e-02, -6.6296e-02, -9.7096e-02,  2.2847e-02,  3.4407e-02,\r\n         -3.0855e-03, -6.0678e-02,  4.6085e-02, -5.7601e-02, -7.3359e-02,\r\n          3.9608e-02, -4.2937e-02, -1.3540e-01, -3.6434e-02,  2.5552e-02,\r\n         -3.6097e-03, -1.4431e-02,  2.0956e-02,  1.0902e-02,  3.7791e-02,\r\n          3.5708e-02,  3.8644e-02,  2.2140e-02,  1.8353e-02, -6.4543e-02,\r\n         -2.8977e-02,  2.2092e-04, -1.9017e-02, -9.0072e-02,  6.1320e-02,\r\n          6.0106e-02, -3.9070e-02,  2.5983e-03,  2.9249e-02,  4.7699e-02,\r\n         -2.0360e-02,  5.9605e-02,  1.6030e-02, -6.5370e-02, -5.2747e-02,\r\n          1.3257e-01, -5.7395e-02, -1.2205e-02, -1.0264e-01, -1.4135e-02,\r\n          8.6135e-02,  3.2875e-02, -2.2668e-02, -3.3296e-02,  9.1361e-02,\r\n         -2.9644e-02, -7.5540e-02, -1.5528e-02, -6.7781e-02,  7.3171e-02,\r\n          6.7801e-03, -7.6132e-02, -6.4288e-03, -6.2306e-02, -6.6187e-02,\r\n          1.2088e-01, -5.4777e-02, -4.0723e-02,  4.2435e-02, -4.2425e-02,\r\n          2.2555e-02, -3.6456e-02,  1.4398e-02,  5.3388e-03, -5.2997e-02,\r\n         -5.1038e-02, -1.7022e-02,  1.0258e-02,  3.2024e-02,  3.3597e-02,\r\n         -3.2051e-02, -1.2118e-02, -2.3766e-03, -4.2491e-02,  2.4748e-03,\r\n         -7.2595e-02, -5.8518e-02, -2.7378e-02, -5.2504e-02,  2.3622e-02,\r\n          6.8455e-02, -4.3174e-02, -5.7094e-02,  2.8622e-03,  3.3262e-02,\r\n          3.2023e-02, -6.5172e-02, -6.4467e-02, -6.0206e-02,  1.4445e-02,\r\n          4.3230e-02,  1.0011e-02,  7.7367e-04,  9.3973e-02,  1.4243e-02,\r\n         -1.5010e-02, -4.2691e-02,  2.9395e-02,  3.7637e-02, -5.0444e-02,\r\n         -6.8496e-02, -1.6514e-02,  3.1707e-04,  1.9912e-02, -2.1561e-02,\r\n         -3.4185e-02,  1.0135e-02, -2.7069e-02,  1.4814e-03, -2.5350e-02,\r\n          3.3745e-02, -1.7138e-02, -1.1634e-01, -2.0741e-02,  9.5868e-02,\r\n          2.3221e-02,  7.5573e-02, -2.8431e-03, -9.1888e-02,  4.1704e-03,\r\n         -9.5057e-02,  4.7743e-02,  6.4065e-02,  8.7444e-02,  1.3021e-02,\r\n          4.2778e-02,  2.1943e-02,  1.3530e-02, -8.5864e-02,  4.6510e-03,\r\n          3.7785e-03, -2.3797e-02, -5.0983e-02,  4.3754e-02,  3.5503e-02,\r\n         -4.1627e-02,  5.8349e-02,  5.4723e-02,  1.1501e-01, -5.5849e-03,\r\n          2.8927e-02, -1.6171e-03,  8.0775e-03,  2.5721e-02,  2.6748e-02,\r\n         -6.0211e-02,  1.5124e-01,  3.1586e-02, -4.1241e-02, -5.7711e-02,\r\n          4.1954e-02,  5.2340e-02,  5.3760e-02,  2.9074e-02, -3.3842e-02,\r\n          5.7718e-02,  5.9437e-02, -7.4326e-02,  2.4316e-02, -6.0424e-04,\r\n          2.1677e-02,  5.4441e-06, -7.6842e-02,  1.0748e-01,  6.3480e-02,\r\n         -4.8457e-03,  4.6786e-02, -7.0556e-02,  4.9835e-02,  3.4774e-03,\r\n          6.1297e-02,  3.3707e-02, -7.2238e-03,  5.0604e-02, -7.6415e-03,\r\n          1.1520e-02,  5.0026e-02, -1.0303e-01,  1.5929e-02, -2.7597e-02,\r\n          1.7627e-02,  4.7689e-03, -1.2748e-01,  3.5131e-02, -1.1406e-02,\r\n         -2.8899e-03,  1.5166e-02,  5.7537e-04, -3.3497e-02,  5.0851e-02,\r\n         -3.7177e-02,  4.4577e-04, -3.0824e-04,  2.7792e-02,  8.8823e-02,\r\n         -3.5720e-02,  7.0087e-03, -1.0314e-02, -1.2659e-03, -2.2453e-02,\r\n          4.7022e-02,  5.1147e-02,  4.1200e-02, -1.5634e-02, -1.6724e-02,\r\n         -7.2314e-02,  1.1527e-02,  6.4637e-02, -9.6029e-02, -5.0812e-03,\r\n          1.2710e-02,  2.6177e-03, -3.4748e-02, -1.6141e-02, -3.6273e-02,\r\n          1.8440e-02,  9.3933e-02,  2.0765e-03,  8.4972e-02,  9.7697e-03,\r\n          1.2437e-02,  7.6406e-02, -3.3954e-02,  4.0181e-02, -5.2402e-02,\r\n         -5.8233e-03, -4.7821e-03, -6.5150e-04,  1.0102e-02,  7.5371e-03,\r\n          5.8810e-03, -1.9272e-02,  6.1471e-02,  3.0255e-02,  2.4927e-02,\r\n          1.5497e-02, -3.1646e-02,  6.5235e-02,  1.8356e-02,  4.0945e-02,\r\n         -4.2193e-02,  5.7378e-02, -5.5912e-02, -9.1574e-03,  1.0156e-01,\r\n         -2.3003e-02, -2.6645e-02,  8.3507e-03, -4.8994e-02,  4.7367e-02,\r\n         -6.1843e-02,  2.9625e-02, -4.1033e-02,  4.8161e-02, -1.3996e-02,\r\n         -5.1490e-03,  3.3728e-02,  6.4946e-02, -5.9914e-03, -2.5476e-02,\r\n         -7.9689e-02, -2.8231e-02, -2.5098e-02,  9.2983e-03,  1.4038e-02,\r\n          6.6977e-02, -7.3957e-03, -5.2031e-02,  4.3680e-04,  5.2491e-02,\r\n         -2.3893e-02, -3.8039e-03, -3.3311e-03,  7.2740e-03, -8.4825e-03,\r\n         -2.6547e-02,  1.6722e-02,  4.3694e-02,  1.5265e-02, -7.0134e-02,\r\n          1.8203e-02, -3.4456e-02,  6.5752e-02, -8.8637e-03, -1.0283e-01,\r\n          5.0218e-03,  2.3994e-02, -3.3444e-02, -4.3584e-02]]))\r\ntensor([[[ 0.0519, -0.0301,  0.2138,  ...,  0.1786,  0.0573, -0.0119],\r\n         [-0.1315,  0.6603,  0.1879,  ...,  0.1245,  0.7793,  0.3559],\r\n         [-0.3818,  0.8267, -0.1493,  ...,  0.5605,  0.6444,  0.0144],\r\n         ...,\r\n         [ 0.2044,  0.2914, -0.1791,  ...,  0.6415, -0.1513,  0.3829],\r\n         [ 0.3050,  0.1932,  0.5416,  ...,  0.2212, -0.1725, -1.3564],\r\n         [ 0.0519, -0.0301,  0.2138,  ...,  0.1786,  0.0573, -0.0119]],\r\n\r\n        [[ 0.1354, -0.0059, -0.0358,  ...,  0.1728, -0.0623,  0.0604],\r\n         [ 0.3847,  0.2801, -0.0853,  ...,  0.0207, -0.0719, -0.1033],\r\n         [ 0.4146,  0.1954,  0.2227,  ...,  0.3385,  0.0899, -1.2342],\r\n         ...,\r\n         [ 0.4115,  0.3859, -0.3168,  ..., -0.0344,  0.3251, -0.3241],\r\n         [ 0.1354, -0.0059, -0.0358,  ...,  0.1728, -0.0623,  0.0604],\r\n         [ 0.1354, -0.0059, -0.0358,  ...,  0.1728, -0.0623,  0.0604]]])\r\ntensor([[-2.0263e-04,  8.1480e-02,  3.1362e-02,  2.9205e-03,  2.6156e-02,\r\n          2.9074e-02,  7.8262e-02, -1.8042e-03,  1.0134e-01, -4.5171e-02,\r\n          5.8435e-02, -1.5320e-02,  5.4996e-02, -9.8644e-02, -3.5025e-02,\r\n          8.4567e-03,  1.5861e-02,  1.0563e-02, -3.4271e-02, -4.7506e-03,\r\n          9.9902e-02, -2.0602e-02, -4.4784e-02,  3.1214e-02, -1.1924e-02,\r\n         -5.1501e-02, -1.3361e-02,  1.8962e-02,  9.7681e-02, -5.4411e-02,\r\n         -3.4331e-02,  8.1291e-02,  4.8812e-02, -1.1028e-02,  2.1352e-02,\r\n          1.2719e-02, -1.4397e-02,  3.6286e-02, -7.6123e-02,  3.2329e-02,\r\n          2.0810e-02, -4.2202e-02,  9.1291e-02,  2.0853e-02, -3.0802e-02,\r\n         -8.3851e-02,  1.3089e-02, -3.0063e-02,  4.1123e-02, -1.2750e-01,\r\n         -7.7803e-02, -3.9341e-02,  1.5260e-03, -2.8011e-02,  3.4166e-02,\r\n          1.4671e-02, -7.7165e-02,  1.6362e-01,  4.1130e-02, -5.2446e-02,\r\n         -4.1877e-02,  1.8053e-02, -1.3892e-02, -3.6819e-02,  6.9498e-02,\r\n         -2.5709e-02,  3.5855e-02,  2.1019e-02, -3.8845e-02,  5.4893e-03,\r\n         -5.2454e-02,  2.5310e-02, -3.3734e-02,  1.3260e-01, -6.1091e-02,\r\n          3.2604e-02,  5.7725e-02, -2.3485e-02,  2.1315e-02, -1.9392e-04,\r\n         -6.7914e-03, -9.2327e-02,  8.6956e-03,  4.6764e-02, -1.0960e-02,\r\n          3.9058e-02,  4.6745e-02, -6.9786e-02, -8.7697e-03, -4.9557e-03,\r\n         -4.6012e-03, -1.3325e-02,  2.3268e-02, -3.5346e-02,  4.8448e-03,\r\n          1.1384e-02, -1.2826e-02, -6.8646e-02,  9.0570e-02,  1.4658e-01,\r\n         -2.5707e-03,  1.9660e-03, -4.4464e-02,  8.9292e-02, -1.8447e-03,\r\n         -7.3945e-02,  2.7054e-02, -1.6221e-02, -6.7888e-03,  5.0310e-03,\r\n          2.8731e-03,  1.0946e-01,  5.2622e-03, -2.6717e-02,  2.4030e-02,\r\n         -1.0200e-01, -5.5133e-02,  3.1116e-02, -4.2566e-02,  2.4117e-02,\r\n          8.6225e-02,  1.4062e-02,  5.4398e-02,  6.5820e-03, -6.5459e-03,\r\n         -1.8252e-01,  3.3348e-03, -3.5597e-02,  7.0852e-02, -9.5739e-02,\r\n         -1.9637e-02, -3.8111e-02, -3.3517e-02, -1.2258e-02, -1.9562e-02,\r\n         -1.8821e-02,  7.0906e-02, -2.3828e-02, -4.3826e-02,  4.1405e-03,\r\n          2.3494e-02,  7.0897e-02,  4.7444e-02,  1.1003e-01, -1.4624e-02,\r\n          8.3857e-02, -2.4992e-02,  2.4340e-02,  2.5843e-02,  3.4866e-03,\r\n          7.7577e-02,  1.3685e-02, -1.1242e-03, -4.0977e-02,  9.4304e-03,\r\n          8.8913e-02,  1.7867e-02, -1.2560e-02,  2.0347e-02,  2.6828e-02,\r\n         -1.1238e-01, -4.3561e-03, -3.5928e-02,  3.5934e-03,  3.4327e-02,\r\n         -5.9771e-02, -1.5273e-02,  1.9603e-02, -1.8184e-02,  2.4307e-02,\r\n          3.6187e-02,  1.4060e-02,  7.6398e-02, -2.2979e-02, -3.0206e-02,\r\n         -5.1809e-02,  8.7023e-03,  1.0374e-02,  2.1267e-02,  1.4750e-02,\r\n          1.9905e-02, -3.2679e-02, -5.5886e-02,  1.3337e-02, -2.5530e-02,\r\n          2.4946e-02, -2.1107e-02, -9.4090e-03,  6.4730e-02,  8.3395e-02,\r\n         -6.2127e-02, -1.8043e-02, -1.3113e-02,  5.5396e-03,  8.6744e-03,\r\n         -4.6163e-02,  2.9396e-02,  1.2284e-02,  2.9066e-02, -2.4620e-02,\r\n         -3.5201e-02,  4.1181e-02, -5.1175e-02, -7.2992e-02, -4.1524e-02,\r\n         -2.8216e-02,  2.1841e-02, -2.0928e-02, -7.1991e-02, -6.3534e-02,\r\n          2.9739e-02,  8.8681e-02, -1.2057e-01,  6.4130e-03, -1.4459e-02,\r\n          2.0246e-03,  2.1488e-02,  4.1197e-02, -9.9740e-02, -3.5869e-03,\r\n         -3.1988e-02, -8.8821e-02,  1.0366e-02,  1.4272e-32, -6.8385e-02,\r\n          9.5183e-02, -6.6033e-02, -1.3887e-03,  2.5154e-02, -1.4938e-02,\r\n          2.0573e-02,  9.6135e-03, -5.1258e-02,  2.0013e-02, -6.8329e-02,\r\n          7.2115e-02,  1.0044e-03,  5.3354e-02, -6.6384e-02, -4.9683e-02,\r\n          6.0900e-03,  5.8270e-02, -1.7934e-02,  1.6042e-02,  2.4676e-03,\r\n          1.0990e-01, -6.0473e-02,  3.4910e-02,  8.8677e-03,  5.3822e-02,\r\n          3.7571e-02, -4.1250e-02, -9.2934e-02, -2.5795e-02, -2.7331e-02,\r\n         -3.4021e-03, -5.4225e-02,  8.9704e-02, -3.5220e-02,  2.8063e-02,\r\n          1.0967e-01, -8.7929e-02, -2.8321e-02, -1.2708e-02, -7.5368e-02,\r\n         -6.2294e-02, -1.0085e-01,  1.6844e-01, -6.5539e-02, -2.0168e-02,\r\n          2.0491e-02, -5.0510e-03,  3.5321e-02,  1.8797e-02, -8.6906e-02,\r\n         -4.4078e-02,  3.2455e-02,  3.7314e-03, -4.6977e-02, -6.9930e-03,\r\n         -1.1259e-02, -3.0085e-02,  2.6413e-02, -2.5476e-02, -9.4452e-02,\r\n          4.4760e-02,  2.5994e-02,  3.3665e-02,  1.0736e-01,  2.3867e-02,\r\n         -5.2156e-02, -2.5788e-02, -8.8480e-03, -4.3215e-02, -5.7881e-02,\r\n         -5.8848e-03, -4.2223e-02,  1.2517e-02,  1.2976e-02,  1.6190e-02,\r\n         -2.0928e-02, -8.6367e-02, -5.2927e-02, -9.7199e-04,  5.2095e-02,\r\n         -1.6528e-02,  6.2264e-02, -4.5418e-03,  2.8056e-02,  1.7149e-02,\r\n         -4.0357e-02,  1.9064e-02, -1.7533e-02,  4.1397e-02,  3.0693e-02,\r\n         -6.7856e-02,  9.4663e-02,  6.1527e-02, -2.6196e-02,  1.3921e-32,\r\n          1.4822e-02, -1.5217e-01,  2.2513e-02,  2.2708e-02,  9.2292e-02,\r\n         -2.1754e-04,  6.1387e-02, -7.1298e-02, -3.9596e-02, -9.7091e-03,\r\n         -6.7819e-02,  3.6662e-03, -2.5306e-02,  9.2944e-02,  1.6062e-02,\r\n          1.1275e-01,  7.1876e-03, -2.6524e-04, -9.7104e-02,  2.0065e-03,\r\n          5.1454e-02,  1.5657e-03, -8.6278e-02, -7.9788e-03,  2.0431e-02,\r\n          8.4077e-03, -7.0003e-02,  2.1912e-02, -1.6641e-02,  2.1762e-02,\r\n          2.4746e-02,  8.9329e-02,  3.6120e-02, -5.7498e-02,  9.1585e-03,\r\n          1.2513e-02,  6.6342e-02, -5.7440e-02,  2.8195e-02, -6.7379e-02,\r\n         -2.0347e-02,  4.7499e-02,  9.1575e-03,  8.0042e-02,  5.6499e-02,\r\n          6.3730e-02, -1.9476e-02,  5.6836e-03,  2.9342e-02, -3.6142e-02,\r\n          4.4897e-02, -4.1797e-02,  5.8553e-02, -1.5352e-03,  3.3426e-02,\r\n         -3.7150e-02,  9.1379e-02,  4.6740e-03, -1.4017e-02,  2.1975e-02,\r\n          2.3848e-02,  6.2093e-02,  4.9103e-02, -2.9023e-04],\r\n        [ 6.4757e-02,  4.8520e-02, -1.7860e-02, -4.7978e-02, -5.9088e-02,\r\n         -5.2142e-02,  3.9443e-02, -6.2844e-02,  6.6121e-02,  7.6580e-02,\r\n         -2.1254e-04,  1.5320e-02,  3.9968e-02, -7.0601e-02,  2.4244e-02,\r\n         -4.1588e-02, -1.4465e-03, -7.7605e-03, -5.6043e-02, -8.8963e-02,\r\n          7.0695e-02,  2.1028e-02,  2.8623e-02, -7.8709e-03, -1.6565e-02,\r\n          7.3264e-02, -9.4989e-02,  1.3173e-02, -7.2403e-03, -5.3078e-02,\r\n          1.8276e-02,  8.4790e-02,  2.0148e-02, -5.9290e-03,  2.0633e-02,\r\n         -2.2634e-02, -5.8569e-02, -2.3669e-02,  4.6745e-03, -2.8571e-02,\r\n          4.1322e-02,  3.8646e-02,  3.7961e-02, -7.8518e-04,  4.3212e-02,\r\n         -6.8687e-03, -7.1445e-02, -1.3836e-02,  6.3514e-02, -3.9610e-02,\r\n         -9.4036e-02, -2.8578e-02, -5.9751e-02,  4.5022e-02, -6.7160e-03,\r\n         -6.9539e-02, -1.7032e-02,  1.4767e-01,  8.3853e-03, -6.9842e-02,\r\n         -9.5375e-02,  6.2728e-02,  5.6312e-03,  9.3424e-04,  4.2998e-02,\r\n         -2.3814e-02,  1.7499e-02, -4.1666e-02, -9.1068e-02,  4.0324e-02,\r\n         -5.2188e-02, -1.3495e-02, -8.4515e-02,  1.5438e-02, -5.9344e-03,\r\n         -5.4702e-02,  5.3660e-02, -3.3120e-02,  3.2658e-02,  3.9698e-03,\r\n          3.1456e-02, -7.8030e-02, -2.3606e-02, -4.9058e-02,  1.3479e-02,\r\n         -1.4947e-02,  1.0118e-03,  1.3985e-02, -3.9593e-02,  5.1760e-03,\r\n         -4.1498e-02, -7.5046e-02,  5.3408e-02,  2.3429e-02, -9.2020e-05,\r\n          5.9118e-02,  6.0022e-03, -1.8379e-02,  1.0178e-01,  1.6152e-01,\r\n         -3.0536e-02,  3.3435e-02,  4.7782e-02, -7.9538e-02, -8.6922e-02,\r\n         -6.1917e-02,  3.8695e-02,  1.1651e-02,  8.7407e-03, -1.3770e-02,\r\n         -1.7932e-03,  1.6942e-02,  4.2991e-02,  2.1575e-02, -8.6345e-03,\r\n         -3.0009e-02, -1.5688e-02, -2.4927e-02, -1.0175e-01,  1.1502e-01,\r\n          5.3017e-02,  6.1178e-02, -2.1013e-02,  1.5198e-02,  1.5468e-02,\r\n         -1.3327e-01,  4.2989e-02, -1.0496e-02,  4.3588e-02,  1.4730e-02,\r\n          1.6897e-02,  1.8899e-02, -8.4391e-02, -4.1344e-02, -8.0098e-03,\r\n         -2.5796e-02, -1.5376e-02,  4.5267e-02, -2.4526e-02, -5.1237e-02,\r\n          4.2822e-02,  7.4222e-02, -9.3769e-02,  6.7627e-02, -2.8599e-02,\r\n          8.1742e-02, -6.8643e-02, -3.6141e-02,  2.3759e-02,  7.5191e-02,\r\n          2.6128e-03,  1.0520e-02, -6.7882e-02,  6.1901e-04,  3.1989e-02,\r\n          1.6200e-02, -1.3205e-02, -9.0472e-02,  1.8151e-02, -2.3106e-02,\r\n         -2.0236e-02,  9.2012e-02,  3.0936e-02, -1.7037e-02,  1.4810e-01,\r\n          1.8567e-02, -1.4637e-02,  1.4305e-02, -1.0724e-01, -1.8698e-02,\r\n          8.3791e-02, -3.9420e-02,  2.4687e-02,  6.7460e-02,  5.2701e-02,\r\n          3.0487e-03,  5.5075e-02, -2.9316e-02,  9.9098e-03, -7.4482e-02,\r\n          4.8238e-03, -3.1326e-03,  6.5845e-02,  2.5837e-02,  2.5481e-02,\r\n         -8.7161e-03, -1.3477e-03,  1.9123e-02,  2.8082e-02,  3.6589e-02,\r\n         -2.4493e-02, -8.0808e-02,  2.4913e-02, -5.3329e-03, -1.7102e-02,\r\n          3.3867e-02,  6.3400e-02, -3.3916e-03, -6.7354e-02, -5.5938e-03,\r\n          2.1498e-02,  6.5722e-02, -4.7381e-02, -7.9362e-02,  4.1011e-02,\r\n         -4.6011e-02, -6.3487e-03, -1.1641e-01, -1.7334e-02,  1.8094e-02,\r\n          3.6837e-02,  4.4314e-02, -3.6483e-02,  8.4557e-02, -9.2859e-03,\r\n          1.4072e-02,  3.9823e-02, -1.7269e-02,  4.2461e-02, -8.4236e-02,\r\n         -9.0057e-02, -1.0825e-01,  5.1165e-02, -6.6264e-34,  1.0048e-02,\r\n          1.4766e-01, -1.2518e-01,  1.3070e-02, -7.7228e-02, -4.0407e-02,\r\n         -2.2845e-04,  3.9996e-02,  2.8852e-02, -7.1699e-02,  5.1952e-02,\r\n         -1.1209e-02, -4.2056e-02,  1.6541e-02, -4.6489e-03, -6.9047e-02,\r\n          8.3360e-02,  1.3289e-01,  1.7192e-02, -3.9012e-02,  5.0301e-04,\r\n          5.8492e-02, -1.9177e-02,  4.0329e-02, -1.1858e-01, -2.2612e-02,\r\n          4.3220e-02,  3.7332e-04, -2.6073e-02,  7.5085e-03,  2.6288e-02,\r\n         -9.5066e-03, -3.0889e-02,  8.5365e-02, -7.8631e-02,  5.0377e-03,\r\n          1.0590e-02, -5.0390e-02, -3.7519e-02,  1.0257e-01, -1.0085e-02,\r\n         -1.9220e-02, -9.5136e-02,  4.9900e-02, -4.5786e-02, -2.0724e-02,\r\n          6.8227e-03, -1.0297e-02,  2.7976e-02, -9.2418e-02,  5.9145e-02,\r\n         -6.7858e-02, -1.6362e-02, -5.3730e-02,  2.5811e-02, -3.9608e-02,\r\n         -1.3228e-02, -8.0786e-02,  3.2411e-02, -1.1777e-02, -5.6467e-02,\r\n          2.8093e-02,  1.3829e-02, -6.2382e-03,  3.3643e-02,  6.1135e-02,\r\n          1.8746e-02,  8.0135e-02,  4.9136e-02, -1.7234e-02,  9.3471e-03,\r\n         -1.3336e-02, -1.3108e-02,  4.1614e-03, -5.4686e-03, -9.3124e-02,\r\n         -4.0893e-02, -2.4925e-02, -5.9401e-02, -3.1374e-02,  5.2622e-02,\r\n         -5.0378e-02,  2.7204e-02,  2.3029e-02,  2.6585e-02, -2.2152e-02,\r\n          8.5036e-02,  6.2772e-02, -2.5475e-02,  4.6020e-02, -1.1727e-02,\r\n          4.5752e-02,  7.5289e-02,  2.2162e-02, -9.4698e-03,  2.6075e-32,\r\n         -4.3285e-02, -6.5349e-02, -1.4460e-01,  2.5365e-02,  8.4028e-02,\r\n         -7.9135e-03,  3.1146e-02, -1.2550e-01, -2.0571e-02, -2.6311e-02,\r\n          2.4025e-02,  3.1844e-02, -5.1213e-02,  5.7909e-02,  9.6493e-03,\r\n          6.7943e-02,  1.1691e-03,  1.9395e-02, -1.3452e-02,  3.5442e-02,\r\n         -3.8499e-02, -1.4651e-02, -2.8915e-02, -3.0350e-02, -2.8647e-02,\r\n          2.8942e-02, -1.1235e-02,  4.1891e-03,  5.2143e-02,  7.4081e-04,\r\n          3.0334e-02,  5.1220e-02, -2.3024e-02, -5.6751e-02, -2.7655e-02,\r\n         -5.0641e-02,  7.3886e-02,  3.7308e-02,  9.6625e-02, -1.1150e-02,\r\n          1.3744e-02, -1.0921e-02, -6.5582e-03,  6.8877e-03, -6.5519e-02,\r\n          6.8186e-04,  1.5204e-02,  1.5714e-02,  2.2339e-02, -4.5055e-02,\r\n          3.9938e-02, -5.9020e-02,  5.9023e-02, -5.9431e-02,  6.6442e-02,\r\n         -5.4190e-02, -1.8829e-02,  1.1727e-01,  8.4974e-03,  1.0795e-01,\r\n         -7.0664e-04,  3.3757e-02,  8.4337e-03, -6.0036e-02]])\r\n```\r\n\r\n</details>\r\n<details>\r\n<summary>CoreML</summary>\r\n\r\n```\r\n\r\n{'hidden_states': array([[[ 0.2097168 ,  0.2680664 ,  0.10968018, ...,  0.29760742,\r\n          0.10534668,  0.15124512],\r\n        [ 0.2052002 ,  0.20568848,  0.15319824, ...,  0.3100586 ,\r\n          0.26782227,  0.32763672],\r\n        [ 0.06433105,  0.7949219 , -0.60839844, ...,  0.92529297,\r\n          0.6699219 ,  0.07324219],\r\n        ...,\r\n        [ 0.14465332,  0.20788574, -0.03741455, ...,  0.64208984,\r\n         -0.4267578 ,  0.6279297 ],\r\n        [ 0.15917969,  0.35180664,  0.06246948, ...,  0.32788086,\r\n          0.07049561, -0.10174561],\r\n        [ 0.20947266,  0.26831055,  0.10949707, ...,  0.29711914,\r\n          0.10522461,  0.15112305]],\r\n\r\n       [[-0.09692383,  0.10076904,  0.24938965, ...,  0.11358643,\r\n         -0.21691895,  0.0758667 ],\r\n        [-0.2956543 ,  0.35961914,  0.22680664, ..., -0.17004395,\r\n         -0.29541016,  0.17907715],\r\n        [-0.09503174,  0.10229492,  0.24987793, ...,  0.11395264,\r\n         -0.21850586,  0.07421875],\r\n        ...,\r\n        [-0.12402344,  0.11688232,  0.25048828, ...,  0.09094238,\r\n         -0.20263672,  0.06237793],\r\n        [-0.09674072,  0.10083008,  0.24914551, ...,  0.11376953,\r\n         -0.21691895,  0.07574463],\r\n        [-0.09686279,  0.10113525,  0.24890137, ...,  0.11346436,\r\n         -0.2166748 ,  0.07574463]]], dtype=float32), 'var_1036': array([[ 5.83496094e-02,  1.51443481e-02,  1.26266479e-02,\r\n         2.21252441e-02, -1.52664185e-02, -9.35058594e-02,\r\n         6.59790039e-02,  5.13916016e-02, -6.48117065e-03,\r\n         2.10876465e-02, -4.99343872e-03,  2.78930664e-02,\r\n        -9.78851318e-03,  2.00805664e-02, -3.10668945e-02,\r\n        -3.38363647e-03,  6.82830811e-03,  4.57153320e-02,\r\n        -2.05688477e-02,  5.47485352e-02, -2.63671875e-02,\r\n        -1.59358978e-03,  6.40258789e-02, -4.73937988e-02,\r\n         2.58331299e-02,  3.41491699e-02, -7.64846802e-03,\r\n        -9.07897949e-03, -1.79595947e-02,  7.09838867e-02,\r\n         6.00585938e-02,  2.92358398e-02, -2.65197754e-02,\r\n         2.65045166e-02,  4.66918945e-02,  3.04412842e-02,\r\n        -3.73229980e-02,  4.38842773e-02, -2.45056152e-02,\r\n         2.18963623e-02,  5.84106445e-02,  1.63116455e-02,\r\n        -9.44824219e-02,  4.60205078e-02,  2.60620117e-02,\r\n         1.45568848e-02, -9.64355469e-02, -5.16357422e-02,\r\n        -3.31115723e-02,  4.09841537e-04, -2.83813477e-02,\r\n         3.41491699e-02, -1.15661621e-02, -3.41186523e-02,\r\n        -4.32739258e-02, -3.69567871e-02,  5.00488281e-02,\r\n         4.69055176e-02,  6.02416992e-02, -5.53894043e-03,\r\n         3.12042236e-02,  1.65710449e-02,  1.76086426e-02,\r\n        -2.82287598e-03, -1.00326538e-02, -1.67846680e-02,\r\n        -3.68347168e-02, -1.09313965e-01, -7.77053833e-03,\r\n        -2.57720947e-02, -1.70135498e-02, -5.07812500e-02,\r\n         2.39715576e-02,  3.77197266e-02, -1.61285400e-02,\r\n         3.39965820e-02, -6.03866577e-03,  8.61816406e-02,\r\n         1.54037476e-02,  9.74731445e-02,  1.26098633e-01,\r\n         4.53491211e-02,  7.60498047e-02, -6.41479492e-02,\r\n        -7.65380859e-02, -4.13208008e-02, -2.58026123e-02,\r\n         8.63037109e-02, -4.17785645e-02,  3.95507812e-02,\r\n         8.25805664e-02,  4.62036133e-02, -5.31921387e-02,\r\n         1.02005005e-02,  6.75048828e-02, -1.33895874e-02,\r\n         8.42285156e-03,  4.17327881e-03, -6.07299805e-02,\r\n        -3.97949219e-02,  3.77197266e-02,  1.00173950e-02,\r\n        -2.30407715e-02, -1.72882080e-02,  5.42297363e-02,\r\n        -1.98211670e-02, -5.38940430e-02,  2.42004395e-02,\r\n        -1.36260986e-02,  2.03704834e-02,  1.59358978e-03,\r\n         8.31604004e-03,  3.81774902e-02,  3.53698730e-02,\r\n        -7.37762451e-03,  2.77557373e-02, -5.10559082e-02,\r\n         2.03323364e-03, -1.52465820e-01,  5.00793457e-02,\r\n         2.56652832e-02, -7.89184570e-02,  2.51617432e-02,\r\n         4.07714844e-02, -1.79748535e-02,  2.49328613e-02,\r\n         5.79223633e-02, -6.22253418e-02, -1.24145508e-01,\r\n        -2.81524658e-02,  1.07238770e-01, -2.82287598e-02,\r\n         2.78167725e-02, -8.21533203e-02, -6.49414062e-02,\r\n         2.80303955e-02, -8.08715820e-03,  9.07897949e-03,\r\n        -9.14916992e-02,  8.12988281e-02,  1.14440918e-02,\r\n        -1.19567871e-01,  2.84881592e-02, -1.46636963e-02,\r\n         3.31420898e-02, -9.49859619e-03, -8.71582031e-02,\r\n        -6.84204102e-02, -4.26025391e-02, -4.41894531e-02,\r\n         5.59387207e-02, -1.94396973e-02,  1.15356445e-02,\r\n         5.62438965e-02,  3.35502625e-03,  6.19812012e-02,\r\n         2.49176025e-02,  1.34277344e-02, -1.81121826e-02,\r\n        -8.26416016e-02, -6.73217773e-02, -3.66516113e-02,\r\n         1.82800293e-02,  6.40487671e-03, -3.09906006e-02,\r\n        -1.35040283e-03,  4.53186035e-02, -4.14428711e-02,\r\n        -9.25445557e-03, -5.00488281e-02, -3.90625000e-02,\r\n         2.33154297e-02,  5.38635254e-03, -5.31616211e-02,\r\n         7.66372681e-03,  8.25805664e-02,  1.18713379e-02,\r\n        -5.48400879e-02, -2.23236084e-02,  2.17742920e-02,\r\n        -1.06215477e-04, -5.32836914e-02, -3.66516113e-02,\r\n        -6.78100586e-02,  3.92150879e-02,  3.19824219e-02,\r\n         5.02624512e-02, -1.90429688e-02, -1.69372559e-02,\r\n         3.14140320e-03, -4.79125977e-02, -1.59301758e-02,\r\n        -2.57873535e-02,  7.55004883e-02, -5.21545410e-02,\r\n        -5.16662598e-02, -2.13470459e-02,  6.00814819e-03,\r\n         6.79321289e-02, -4.54101562e-02,  1.61132812e-02,\r\n         5.92041016e-02,  1.52206421e-02,  3.60412598e-02,\r\n        -3.95965576e-03, -7.85827637e-03,  5.69152832e-03,\r\n        -8.53271484e-02,  3.20129395e-02,  3.35502625e-03,\r\n         6.25000000e-02,  4.85229492e-02, -8.49723816e-04,\r\n        -4.08325195e-02, -5.10253906e-02, -2.36053467e-02,\r\n         4.37011719e-02,  1.00219727e-01,  8.66699219e-02,\r\n        -1.16577148e-02, -2.12097168e-02,  5.05371094e-02,\r\n         1.04446411e-02, -9.53369141e-02, -5.63049316e-02,\r\n        -6.73217773e-02,  5.31921387e-02, -1.13464355e-01,\r\n         8.63647461e-03,  2.63061523e-02,  1.98745728e-03,\r\n         1.73797607e-02,  5.42297363e-02,  6.82983398e-02,\r\n        -2.27737427e-03, -4.29992676e-02, -1.01089478e-02,\r\n         1.75018311e-02,  4.47082520e-02,  1.76239014e-02,\r\n        -8.98437500e-02,  8.24584961e-02,  1.19323730e-02,\r\n        -3.71704102e-02, -2.36358643e-02, -3.14025879e-02,\r\n         5.83190918e-02,  3.93371582e-02, -1.27506256e-03,\r\n        -3.97949219e-02,  7.31811523e-02,  2.93426514e-02,\r\n         9.91058350e-03,  6.02416992e-02, -4.92553711e-02,\r\n         1.67694092e-02,  1.89819336e-02, -5.50231934e-02,\r\n         2.10418701e-02,  7.64846802e-03,  4.76455688e-03,\r\n        -3.01933289e-03, -4.83398438e-02,  4.81262207e-02,\r\n        -4.39758301e-02,  5.77392578e-02,  4.67834473e-02,\r\n        -6.63375854e-03,  1.39617920e-03,  1.45721436e-03,\r\n         1.01089478e-02,  8.65478516e-02, -5.92346191e-02,\r\n        -2.61383057e-02,  7.75146484e-02, -1.68151855e-02,\r\n         1.73950195e-02, -1.35498047e-02,  3.27873230e-03,\r\n         9.66644287e-03, -2.81829834e-02,  5.97839355e-02,\r\n         4.83703613e-02,  2.58941650e-02,  5.67626953e-03,\r\n         2.76641846e-02, -1.87530518e-02, -6.69555664e-02,\r\n         6.31332397e-03,  2.22015381e-02,  3.29284668e-02,\r\n        -3.80554199e-02, -4.32434082e-02,  3.82385254e-02,\r\n         1.13868713e-03,  7.51953125e-02,  3.94287109e-02,\r\n         4.45861816e-02, -4.31060791e-03, -1.01394653e-02,\r\n         3.97644043e-02, -5.89599609e-02,  2.54669189e-02,\r\n         3.83949280e-03, -6.14013672e-02,  2.14004517e-03,\r\n        -2.05688477e-02, -2.85034180e-02, -2.52990723e-02,\r\n        -4.80651855e-02,  9.05151367e-02,  2.00042725e-02,\r\n         3.08036804e-03,  3.45764160e-02,  1.80969238e-02,\r\n        -1.27944946e-02,  1.93176270e-02, -2.88696289e-02,\r\n         1.39312744e-02, -1.08795166e-02, -3.46984863e-02,\r\n        -1.21231079e-02, -4.50439453e-02,  3.27453613e-02,\r\n         6.44531250e-02, -2.27508545e-02,  3.99017334e-03,\r\n         7.51342773e-02, -5.12390137e-02,  3.02581787e-02,\r\n         1.11236572e-02,  4.57153320e-02,  6.25610352e-02,\r\n         8.92333984e-02,  1.19476318e-02, -2.56500244e-02,\r\n        -1.22909546e-02, -1.89208984e-02,  1.62200928e-02,\r\n         2.26593018e-02, -2.90069580e-02, -3.95812988e-02,\r\n         4.98046875e-02, -6.41479492e-02,  1.06506348e-02,\r\n        -4.91333008e-02,  6.08825684e-02, -8.05664062e-03,\r\n         2.64587402e-02, -5.23376465e-02, -5.43518066e-02,\r\n        -5.92041016e-03,  7.56225586e-02, -2.54211426e-02,\r\n         9.28497314e-03, -2.24151611e-02, -4.51049805e-02,\r\n         2.55737305e-02,  8.60595703e-02, -1.54495239e-02,\r\n         6.19506836e-02, -2.86254883e-02,  1.13983154e-02,\r\n        -1.13677979e-02,  2.98156738e-02, -4.86450195e-02,\r\n        -2.42462158e-02, -4.88891602e-02, -1.80625916e-03,\r\n         8.07189941e-03, -2.98309326e-02,  3.48510742e-02,\r\n         9.31396484e-02,  5.66711426e-02, -7.48901367e-02,\r\n        -1.10778809e-02, -2.61993408e-02,  6.50024414e-02,\r\n         3.00903320e-02, -5.36804199e-02,  4.33044434e-02,\r\n        -4.22668457e-02, -5.22460938e-02, -3.12805176e-02],\r\n       [-4.25109863e-02, -1.32522583e-02, -1.40991211e-02,\r\n         8.86535645e-03, -4.35791016e-02, -1.60827637e-02,\r\n         4.33044434e-02,  5.52673340e-02,  1.13868713e-03,\r\n         3.92913818e-03,  2.11486816e-02,  4.41894531e-02,\r\n         3.27873230e-03,  1.09291077e-03, -3.53393555e-02,\r\n         2.44293213e-02,  5.06286621e-02,  1.90277100e-02,\r\n        -3.09562683e-03,  1.75628662e-02,  3.38134766e-02,\r\n         2.14843750e-02,  5.32531738e-03, -2.27203369e-02,\r\n        -3.34472656e-02,  6.11877441e-02, -2.52380371e-02,\r\n        -3.21350098e-02, -3.90930176e-02,  9.27734375e-02,\r\n         4.31823730e-02,  3.68041992e-02, -2.14843750e-02,\r\n        -2.88391113e-03,  7.66372681e-03, -4.26940918e-02,\r\n        -8.44726562e-02,  6.70166016e-02,  3.11088562e-03,\r\n         1.07421875e-02, -8.01086426e-03,  6.39038086e-02,\r\n        -1.89819336e-02,  3.11737061e-02,  8.07189941e-03,\r\n         4.97817993e-03, -8.93554688e-02, -2.03704834e-02,\r\n        -4.05120850e-03,  4.40120697e-04, -6.31103516e-02,\r\n         3.19213867e-02,  3.56445312e-02,  1.56707764e-02,\r\n        -4.93164062e-02,  7.52639771e-03,  1.13525391e-02,\r\n         1.32522583e-02, -1.38092041e-03,  2.37121582e-02,\r\n         1.47247314e-03,  4.47845459e-03,  2.13623047e-02,\r\n         2.09426880e-03, -5.16357422e-02,  1.61285400e-02,\r\n        -4.03747559e-02, -6.03027344e-02,  3.31115723e-02,\r\n        -2.09503174e-02, -2.74963379e-02, -1.69677734e-02,\r\n        -2.39410400e-02,  1.49459839e-02, -5.53894043e-03,\r\n         2.44445801e-02, -5.85937500e-02,  4.32128906e-02,\r\n        -1.15356445e-02,  5.20019531e-02,  4.23889160e-02,\r\n         2.29187012e-02,  7.40814209e-03, -1.07360840e-01,\r\n        -3.66210938e-02, -4.31213379e-02, -9.15527344e-03,\r\n         5.42907715e-02, -1.31607056e-02,  4.67529297e-02,\r\n         5.66101074e-02, -4.27551270e-02, -5.90820312e-02,\r\n         1.51290894e-02,  7.36694336e-02, -2.54974365e-02,\r\n         2.30598450e-03,  6.35910034e-03, -3.48510742e-02,\r\n        -2.68096924e-02,  9.33074951e-03, -4.04052734e-02,\r\n        -5.12084961e-02, -1.82037354e-02,  6.67572021e-04,\r\n        -2.20489502e-02, -1.72271729e-02,  9.81903076e-03,\r\n        -1.01699829e-02, -5.82885742e-03,  3.12042236e-02,\r\n        -1.18103027e-02,  4.15649414e-02, -1.65405273e-02,\r\n        -2.87322998e-02,  2.94189453e-02, -4.88662720e-03,\r\n         2.00271606e-03, -1.00097656e-01,  5.27648926e-02,\r\n         7.77587891e-02, -3.65600586e-02,  2.40325928e-02,\r\n        -5.70678711e-03, -1.71470642e-03,  7.43865967e-04,\r\n        -2.27737427e-03, -1.47247314e-03, -3.66821289e-02,\r\n        -7.22503662e-03,  6.89086914e-02, -1.87988281e-02,\r\n         1.94549561e-02, -7.64160156e-02, -4.86450195e-02,\r\n         5.53894043e-03, -1.56402588e-02,  1.66893005e-04,\r\n        -6.35375977e-02,  6.24694824e-02,  3.41491699e-02,\r\n        -3.86047363e-02,  1.01394653e-02, -5.73425293e-02,\r\n         5.08422852e-02,  1.34735107e-02, -7.34863281e-02,\r\n        -3.42712402e-02, -7.87353516e-03, -2.80303955e-02,\r\n         5.45043945e-02, -2.71301270e-02, -8.86230469e-02,\r\n         1.19171143e-02, -2.28271484e-02,  2.84729004e-02,\r\n        -2.07901001e-03,  9.66644287e-03, -1.19781494e-02,\r\n        -4.84313965e-02, -2.65655518e-02, -3.20129395e-02,\r\n         9.97161865e-03,  2.71301270e-02, -3.79333496e-02,\r\n         4.40216064e-03,  2.90374756e-02, -6.98089600e-04,\r\n        -3.78112793e-02, -6.10046387e-02, -2.54974365e-02,\r\n         2.26440430e-02, -2.35176086e-03,  1.07879639e-02,\r\n        -3.75061035e-02,  5.17272949e-02,  4.78515625e-02,\r\n        -8.49609375e-02,  1.91345215e-02, -7.02667236e-03,\r\n         1.22909546e-02,  2.03247070e-02, -2.68707275e-02,\r\n        -5.46264648e-03, -7.49588013e-03, -8.27026367e-03,\r\n         1.73797607e-02,  9.68170166e-03,  9.59014893e-03,\r\n        -5.94787598e-02, -1.12762451e-02,  2.92968750e-03,\r\n         2.81524658e-02,  4.08020020e-02, -2.55012512e-03,\r\n        -5.17272949e-02, -1.53884888e-02,  1.75170898e-02,\r\n         4.01916504e-02,  1.56173706e-02, -1.65100098e-02,\r\n         1.88293457e-02, -2.02789307e-02,  1.06353760e-02,\r\n        -1.31607056e-02, -9.57489014e-03, -4.78820801e-02,\r\n        -8.25805664e-02,  1.55868530e-02, -1.20086670e-02,\r\n         4.11682129e-02,  2.39105225e-02, -4.18090820e-02,\r\n        -5.67016602e-02, -5.32226562e-02, -3.82423401e-03,\r\n         4.38537598e-02,  7.14721680e-02,  4.01000977e-02,\r\n        -1.25350952e-02, -1.83105469e-02, -2.27966309e-02,\r\n         4.17175293e-02, -5.86853027e-02, -5.57556152e-02,\r\n        -6.35910034e-03,  7.04193115e-03, -3.60412598e-02,\r\n         3.81469727e-02, -9.86099243e-04,  3.12614441e-03,\r\n         1.52816772e-02,  4.19006348e-02,  4.62951660e-02,\r\n        -3.25012207e-02,  1.27029419e-02,  1.44500732e-02,\r\n         4.29534912e-03,  1.77574158e-03,  2.61840820e-02,\r\n        -7.50732422e-02,  4.23278809e-02, -1.53274536e-02,\r\n        -2.32849121e-02, -2.48870850e-02,  4.92248535e-02,\r\n         4.10461426e-02, -1.40075684e-02, -7.61795044e-03,\r\n        -1.07727051e-02,  3.50952148e-02, -1.21536255e-02,\r\n        -3.18765640e-04, -4.21905518e-03, -1.73339844e-02,\r\n        -2.83813477e-03,  2.88848877e-02, -4.79507446e-03,\r\n         2.65960693e-02,  5.45654297e-02, -7.40814209e-03,\r\n         4.85534668e-02, -1.52206421e-02,  3.69567871e-02,\r\n        -2.12249756e-02,  1.52053833e-02,  7.53784180e-02,\r\n        -6.96563721e-03,  2.92510986e-02, -5.78002930e-02,\r\n         8.80432129e-03,  6.03942871e-02, -5.42602539e-02,\r\n        -4.01306152e-02,  6.08215332e-02, -1.55410767e-02,\r\n         2.44903564e-02, -4.42199707e-02,  2.41088867e-02,\r\n         4.81872559e-02,  1.80206299e-02,  1.48162842e-02,\r\n         3.13720703e-02, -2.64587402e-02,  3.57971191e-02,\r\n        -2.29339600e-02,  6.72149658e-03, -6.09970093e-03,\r\n         5.98144531e-02,  4.01000977e-02,  3.18765640e-04,\r\n        -3.73268127e-03, -1.55868530e-02, -7.69424438e-03,\r\n        -9.06982422e-02,  3.96423340e-02,  9.15527344e-03,\r\n         4.89501953e-02,  2.61116028e-03,  1.48773193e-03,\r\n        -7.75527954e-03, -4.06646729e-03,  4.49218750e-02,\r\n        -4.53948975e-03, -1.31607056e-02,  5.00679016e-04,\r\n        -2.91137695e-02,  5.95092773e-02,  1.31454468e-02,\r\n        -3.97491455e-03,  3.97033691e-02,  5.92041016e-03,\r\n        -5.62438965e-02,  4.60815430e-02, -1.52969360e-02,\r\n        -4.38690186e-03,  2.45971680e-02, -8.38012695e-02,\r\n         1.58996582e-02, -2.72064209e-02,  1.63936615e-03,\r\n        -2.51960754e-03, -1.07421875e-02,  5.48400879e-02,\r\n         4.16259766e-02, -1.06964111e-02,  8.22448730e-03,\r\n         2.06909180e-02, -1.53732300e-02,  4.43115234e-02,\r\n        -4.85610962e-03,  1.07879639e-02, -2.31018066e-02,\r\n         4.69970703e-02,  1.00479126e-02,  6.06918335e-03,\r\n         4.28466797e-02,  6.40487671e-03, -2.04849243e-03,\r\n         1.33285522e-02, -5.61714172e-04, -1.33285522e-02,\r\n         3.70788574e-02, -4.67834473e-02,  4.06799316e-02,\r\n        -6.34155273e-02,  4.44641113e-02,  4.06646729e-03,\r\n         3.62243652e-02,  1.21402740e-03, -5.85937500e-03,\r\n        -4.84924316e-02,  5.64270020e-02, -3.71742249e-03,\r\n         3.33786011e-04, -2.66876221e-02,  2.10418701e-02,\r\n         3.08380127e-02,  6.67724609e-02,  3.65295410e-02,\r\n        -2.70385742e-02, -2.99835205e-02, -1.68457031e-02,\r\n        -1.05819702e-02, -3.62777710e-03, -2.71301270e-02,\r\n         3.58581543e-02, -8.17871094e-03,  2.38189697e-02,\r\n        -2.65197754e-02, -7.95288086e-02,  9.06372070e-03,\r\n         5.80444336e-02,  8.34655762e-03, -3.85742188e-02,\r\n        -6.71005249e-03, -4.11682129e-02,  6.48803711e-02,\r\n        -1.01699829e-02, -5.03234863e-02,  3.58276367e-02,\r\n        -1.07879639e-02, -5.70983887e-02,  1.44348145e-02]], dtype=float32)}\r\ntensor([[[ 0.2097,  0.2681,  0.1097,  ...,  0.2976,  0.1053,  0.1512],\r\n         [ 0.2052,  0.2057,  0.1532,  ...,  0.3101,  0.2678,  0.3276],\r\n         [ 0.0643,  0.7949, -0.6084,  ...,  0.9253,  0.6699,  0.0732],\r\n         ...,\r\n         [ 0.1447,  0.2079, -0.0374,  ...,  0.6421, -0.4268,  0.6279],\r\n         [ 0.1592,  0.3518,  0.0625,  ...,  0.3279,  0.0705, -0.1017],\r\n         [ 0.2095,  0.2683,  0.1095,  ...,  0.2971,  0.1052,  0.1511]],\r\n\r\n        [[-0.0969,  0.1008,  0.2494,  ...,  0.1136, -0.2169,  0.0759],\r\n         [-0.2957,  0.3596,  0.2268,  ..., -0.1700, -0.2954,  0.1791],\r\n         [-0.0950,  0.1023,  0.2499,  ...,  0.1140, -0.2185,  0.0742],\r\n         ...,\r\n         [-0.1240,  0.1169,  0.2505,  ...,  0.0909, -0.2026,  0.0624],\r\n         [-0.0967,  0.1008,  0.2491,  ...,  0.1138, -0.2169,  0.0757],\r\n         [-0.0969,  0.1011,  0.2489,  ...,  0.1135, -0.2167,  0.0757]]])\r\ntensor([[ 3.2327e-02,  8.3131e-02, -1.0593e-02, -4.0145e-02,  1.9945e-02,\r\n          5.3147e-02, -5.2659e-03, -3.1746e-02,  3.8926e-02, -1.7285e-02,\r\n          3.6926e-02,  1.9271e-02,  1.4350e-02, -1.5292e-02, -3.3118e-02,\r\n          2.2810e-02,  4.2211e-02,  6.8572e-02, -9.4533e-03, -1.6053e-02,\r\n          1.5746e-01, -3.4301e-02,  2.6658e-03, -1.3327e-02,  1.7198e-02,\r\n         -7.7754e-03,  3.8566e-02,  4.6832e-02,  6.3718e-02, -7.2187e-02,\r\n          1.8223e-02,  2.1267e-02,  8.7743e-02, -1.1265e-02, -5.8031e-02,\r\n          1.4776e-02,  1.1254e-02,  6.6791e-02,  2.3841e-02,  7.9253e-02,\r\n         -1.0950e-02,  3.7214e-02, -1.3341e-02, -1.8479e-02, -4.2703e-02,\r\n         -7.6097e-02,  4.4098e-03, -3.5683e-02,  2.5075e-02, -1.5535e-01,\r\n         -7.9835e-02, -4.4962e-03, -2.8258e-02, -8.5299e-02, -4.9490e-03,\r\n         -7.3591e-02, -3.7821e-02,  1.0465e-01, -2.6410e-02, -4.9054e-02,\r\n         -2.4904e-02, -2.8037e-03, -3.6279e-02,  2.8337e-03,  3.2855e-02,\r\n          6.2386e-03, -7.9780e-03,  1.2107e-01,  5.1239e-02, -1.0398e-02,\r\n         -8.8308e-02, -1.8226e-02, -4.5235e-02,  4.0422e-02, -1.8892e-02,\r\n          5.5540e-02,  1.6261e-02, -9.7051e-03, -1.4784e-02,  2.5380e-03,\r\n         -5.3539e-02, -1.2310e-01,  6.2157e-03,  2.2167e-02,  3.3079e-02,\r\n          2.2544e-02,  6.0063e-02, -1.0373e-01, -2.2350e-02, -2.0144e-02,\r\n         -9.1071e-03, -5.1346e-02, -1.6522e-02, -4.4529e-02,  1.4973e-02,\r\n         -1.5151e-02, -6.1669e-03, -7.5425e-03,  6.9232e-02,  4.0291e-01,\r\n          2.3059e-02, -4.7481e-02,  5.7398e-02,  1.0108e-01,  4.7046e-02,\r\n         -9.5341e-02,  4.2334e-02, -5.7833e-02,  5.2077e-02, -7.8394e-02,\r\n          2.3070e-02,  7.0775e-02,  1.1399e-02, -1.6938e-02,  1.4494e-02,\r\n         -1.3073e-01,  3.7866e-03,  8.2797e-03, -2.5542e-02,  3.2838e-02,\r\n          6.8545e-02,  1.0543e-02, -3.6074e-02,  2.4928e-03, -1.1923e-02,\r\n         -2.1534e-01, -6.9041e-02, -2.2962e-02, -1.3593e-02, -6.4784e-02,\r\n          5.8281e-03, -4.7423e-02, -3.6039e-02, -5.2617e-02, -2.8952e-02,\r\n         -7.9892e-03,  2.3419e-02,  1.4601e-03, -7.3451e-03,  3.6527e-02,\r\n          4.0935e-02,  2.8157e-02, -1.8890e-02,  6.9351e-02, -1.9202e-03,\r\n          6.6480e-02, -4.1425e-02, -4.9237e-02,  8.3433e-05, -2.7283e-02,\r\n          6.4618e-02,  2.5250e-02, -4.0007e-03, -6.0554e-02,  5.8785e-02,\r\n          9.8100e-02,  9.0518e-02, -2.2124e-02,  4.5178e-02, -1.8817e-02,\r\n         -2.6796e-02,  3.1651e-02, -5.9117e-02, -2.2116e-02,  4.5565e-02,\r\n          1.1510e-02,  3.0323e-02,  1.5596e-02,  7.4672e-03, -1.2089e-04,\r\n          7.3805e-02,  3.4392e-02,  4.6397e-04,  1.2049e-02, -4.8189e-02,\r\n          2.5030e-03,  2.7123e-02, -1.9280e-02, -5.5725e-02, -8.2250e-03,\r\n          4.2485e-02, -1.4953e-02,  1.0116e-02,  2.3847e-02, -1.1424e-02,\r\n         -3.5479e-03, -6.0535e-02, -2.3195e-02,  2.0243e-03,  3.3643e-02,\r\n          1.7707e-02,  1.0970e-02, -3.1064e-02,  4.1466e-02, -2.2675e-02,\r\n         -1.5979e-02,  5.2780e-02, -2.0486e-02,  3.3934e-02,  4.1621e-02,\r\n         -4.4047e-02,  2.9008e-02, -1.3849e-02, -4.1765e-02,  2.2527e-02,\r\n         -4.5493e-02,  4.3580e-02,  6.4011e-02, -1.7553e-02,  3.9463e-03,\r\n         -1.5549e-03,  4.2408e-03, -1.2635e-01, -1.6931e-02, -3.7056e-03,\r\n         -2.3941e-03,  5.2155e-02,  4.1908e-02, -4.2375e-02, -1.6858e-02,\r\n         -5.1384e-02, -2.8782e-02,  2.7375e-02,  9.5388e-08, -3.8162e-02,\r\n          1.1289e-01, -3.1985e-02, -3.4816e-02,  8.0213e-02, -2.9161e-02,\r\n          6.9571e-02,  6.2454e-02, -4.3234e-02,  4.0011e-02, -4.3883e-02,\r\n         -1.4663e-02,  5.4903e-03,  3.8822e-02, -1.0982e-01, -9.5195e-02,\r\n          7.6815e-02,  2.4169e-02, -1.6843e-02,  1.1335e-02,  8.4727e-03,\r\n          9.1198e-02, -6.0132e-02, -2.3709e-02, -2.2974e-02,  4.3959e-02,\r\n         -5.3336e-03,  3.7134e-02, -6.8361e-03, -5.7890e-02, -2.3826e-02,\r\n          6.2635e-02, -5.4227e-02,  6.8468e-02, -5.0383e-02,  1.0887e-02,\r\n          4.0489e-02, -5.4701e-02,  2.7493e-02, -5.7909e-02, -5.7084e-02,\r\n         -5.1598e-02,  4.6005e-02,  1.0845e-01,  4.2717e-02,  2.7085e-03,\r\n          1.9566e-03,  1.2462e-02,  8.2924e-03, -2.1555e-02, -4.7734e-02,\r\n         -3.8821e-02, -4.6041e-03,  1.0303e-02, -2.2923e-02, -4.0011e-02,\r\n         -1.5810e-02, -1.8640e-03,  1.4333e-02,  4.1873e-02, -6.1094e-02,\r\n          5.7072e-02,  1.3211e-02,  5.8700e-02,  2.3605e-02, -2.7062e-02,\r\n         -7.7337e-03, -4.3824e-02, -3.4132e-02, -7.8549e-02,  3.2285e-02,\r\n          5.0631e-02, -2.3110e-02, -5.8510e-02,  3.3113e-02,  3.5996e-02,\r\n         -3.9201e-02, -7.2877e-02, -4.3320e-02, -2.0623e-02, -3.9051e-03,\r\n          1.9367e-02,  7.7421e-02,  2.8805e-02, -2.7948e-02, -2.7723e-02,\r\n         -3.6558e-02,  6.8911e-02, -4.3786e-02,  4.5241e-02,  5.1799e-02,\r\n         -4.6828e-02,  9.3697e-02,  1.6989e-02, -1.0431e-02, -1.7885e-08,\r\n         -2.5823e-02, -2.2785e-02,  4.1516e-02, -7.0010e-02,  3.5063e-02,\r\n          6.0242e-02,  4.2265e-02, -4.9943e-02,  3.6181e-02,  7.7328e-05,\r\n         -4.3606e-02,  3.8613e-02, -1.3227e-03,  4.9549e-02, -7.7995e-02,\r\n          1.6043e-02, -1.0664e-02,  2.1512e-02, -2.1977e-03,  2.6393e-03,\r\n          4.3277e-02,  5.4011e-02, -7.4438e-02,  1.1040e-02,  4.4073e-02,\r\n          3.8918e-02,  4.0941e-02, -1.8331e-02,  8.4666e-04,  3.3967e-02,\r\n         -2.0842e-02,  5.2339e-03,  6.2440e-02, -2.2467e-02,  1.4000e-02,\r\n          7.4560e-02,  1.1129e-02, -9.5366e-03, -2.6937e-02, -2.4882e-02,\r\n         -4.3511e-02, -1.2146e-02,  1.6830e-02,  3.8705e-03,  7.4292e-02,\r\n          2.8880e-02, -3.4788e-02,  2.8113e-03, -4.6807e-02, -2.1437e-02,\r\n          6.1744e-02, -9.8202e-02,  1.0083e-02, -2.1067e-02,  3.8608e-02,\r\n          1.3387e-02,  2.4527e-02, -2.9460e-02, -9.5996e-03,  5.7463e-02,\r\n          4.5562e-02,  1.0904e-01,  3.1373e-02,  5.2955e-02],\r\n        [-3.1828e-02,  3.4884e-02,  5.8280e-02, -4.5137e-02,  2.6307e-02,\r\n         -6.1481e-02,  7.6663e-02, -1.3373e-02,  5.7417e-02, -4.6737e-02,\r\n         -8.8073e-03, -1.6392e-02, -6.7884e-03, -1.5931e-02, -4.2798e-02,\r\n          2.9208e-02,  1.3283e-02,  9.0592e-03,  8.3119e-03,  1.0389e-02,\r\n         -6.0814e-03,  3.4912e-03, -3.0073e-04, -3.3792e-02, -2.8121e-02,\r\n         -3.9631e-02, -1.9315e-02,  2.5825e-02, -1.6780e-02, -7.4807e-02,\r\n         -2.4163e-02, -8.4854e-03,  7.3852e-02, -3.7596e-02, -2.4664e-03,\r\n         -4.4394e-02, -2.8094e-02,  5.1375e-02,  4.7533e-02,  4.6347e-02,\r\n          5.1799e-04, -4.4498e-02, -1.4358e-02,  2.6739e-02, -9.3655e-03,\r\n          3.1615e-02,  2.8303e-02, -3.3199e-02, -1.7407e-02,  2.5623e-02,\r\n          2.7228e-02, -9.1556e-02, -4.4917e-02, -1.9201e-02,  2.1840e-02,\r\n         -3.0511e-02, -8.3572e-02,  8.6793e-02,  4.5778e-02, -5.4480e-04,\r\n          2.1180e-02,  1.1026e-03, -5.7860e-02,  5.6288e-02, -8.2154e-03,\r\n         -1.9054e-02,  3.7037e-02, -6.5401e-03, -3.3973e-02,  2.5693e-02,\r\n          2.3969e-02, -1.1708e-02, -3.1589e-02,  1.7496e-02,  3.7346e-02,\r\n          3.9694e-02,  4.0488e-02, -4.1581e-02, -2.7135e-03,  2.4106e-05,\r\n         -2.4806e-02, -4.1892e-02,  4.0180e-02, -5.3106e-02,  5.4172e-02,\r\n          1.7320e-02,  6.3289e-02,  4.1203e-02, -5.5208e-02,  2.6721e-02,\r\n         -4.1557e-02,  1.4431e-02,  1.7935e-02, -5.9205e-02,  1.8079e-02,\r\n         -1.3713e-02,  1.4590e-02, -3.5133e-02,  3.8001e-03,  6.9712e-01,\r\n          1.7436e-02, -2.8542e-02,  7.9093e-03,  8.2188e-03,  2.9043e-02,\r\n         -3.2806e-02, -9.4624e-03, -9.6968e-04,  1.0610e-02,  2.4210e-02,\r\n         -5.2383e-02,  2.7259e-02,  5.3217e-02, -2.7852e-02, -2.6104e-02,\r\n         -9.2195e-03, -3.6854e-02,  6.5401e-03,  1.3823e-02,  2.7578e-02,\r\n          3.3662e-02,  1.8374e-02, -2.8470e-03, -1.6307e-02,  1.3143e-02,\r\n         -1.2331e-01,  5.3188e-02,  4.2848e-02, -9.1887e-03,  9.4316e-04,\r\n          1.2866e-02,  4.4124e-02,  4.3170e-02,  4.0740e-02, -3.2818e-02,\r\n         -5.1727e-02, -8.6337e-03,  8.3179e-03,  5.5252e-02,  3.4772e-02,\r\n         -4.6226e-02,  1.0445e-01,  4.3739e-02, -1.2769e-02,  1.0685e-02,\r\n         -1.3633e-02, -4.0195e-02, -3.5272e-02, -2.2817e-02,  8.3287e-02,\r\n          5.9470e-02,  3.2110e-03, -6.6775e-04,  1.0797e-02, -4.6492e-02,\r\n         -1.5018e-03,  3.1502e-02, -7.5077e-02,  2.7491e-02, -1.9294e-02,\r\n          4.3980e-02,  6.4393e-02,  1.0591e-02, -2.3881e-02,  6.5798e-03,\r\n         -7.5299e-02,  5.1660e-02,  3.9756e-02,  6.7739e-03, -5.4702e-02,\r\n          8.2251e-02, -6.4890e-02, -1.4532e-02,  3.6432e-02,  5.5029e-03,\r\n          6.2966e-03, -9.1206e-03, -6.2568e-03,  4.1371e-02, -2.9658e-02,\r\n         -2.6423e-02, -7.0354e-03, -8.7241e-03,  1.3040e-02,  1.7258e-02,\r\n          1.2891e-02, -8.7043e-02, -1.4408e-02, -2.1081e-03, -1.4571e-02,\r\n          1.9150e-02, -3.3354e-02, -2.1431e-02,  7.0362e-02,  1.3430e-02,\r\n         -1.3260e-02, -2.4358e-02, -4.6736e-03, -1.3753e-03,  2.1599e-03,\r\n         -1.3203e-02, -2.0611e-02,  3.4481e-03, -1.7971e-02,  4.4688e-02,\r\n         -2.9111e-02,  5.6997e-02,  2.6893e-02, -8.4538e-03,  3.8154e-03,\r\n         -4.3322e-03,  2.7620e-02,  3.3250e-02, -2.4453e-03, -2.5779e-02,\r\n         -2.5415e-02, -1.1836e-03, -4.7068e-03, -3.3681e-02, -2.8872e-02,\r\n          3.7777e-02, -5.2470e-02,  4.0966e-02,  1.5302e-07, -8.2866e-03,\r\n          1.5779e-02, -9.0953e-03, -7.3765e-04,  6.1901e-03,  4.6863e-02,\r\n          8.3148e-02,  3.2867e-02, -3.6274e-03,  4.6696e-02,  2.0946e-02,\r\n         -4.1063e-02,  2.4544e-02,  1.5497e-02, -2.3471e-02, -1.3203e-02,\r\n          5.7445e-02,  7.3312e-02, -3.0284e-03,  7.7731e-03,  9.0507e-03,\r\n          1.0612e-02, -5.2639e-02,  1.4566e-01, -3.9722e-02,  3.9158e-02,\r\n          4.1972e-02, -1.8062e-02,  2.8904e-03, -4.5932e-02,  2.7398e-03,\r\n         -1.8858e-02,  1.3673e-02,  5.2383e-02,  1.3027e-02,  5.0643e-02,\r\n          6.6308e-03, -3.7608e-02, -8.9411e-03, -5.8072e-02,  7.0791e-03,\r\n         -3.7992e-02, -7.2849e-02,  6.3761e-02, -2.5611e-02, -3.7621e-04,\r\n         -4.2692e-03,  6.4740e-02, -4.1907e-02, -6.9384e-03, -7.4591e-03,\r\n          4.3025e-03, -3.8141e-02, -1.7363e-02, -1.1722e-03, -4.2142e-03,\r\n         -1.5565e-02, -1.4410e-02,  3.5690e-03,  3.5677e-02, -2.3099e-02,\r\n          3.7698e-02, -3.1729e-02,  3.6121e-02,  3.5494e-02, -2.3504e-03,\r\n          1.6527e-02, -4.2620e-02, -3.0875e-02, -5.5792e-02, -1.7571e-02,\r\n          2.9120e-02, -9.3335e-02, -3.8329e-03, -2.6606e-02, -2.3260e-02,\r\n         -1.5702e-02, -9.9653e-03, -1.9955e-02, -4.5498e-02,  2.6739e-02,\r\n         -2.1852e-02,  6.7582e-03, -3.4804e-03,  2.1921e-02, -5.9663e-03,\r\n          2.2353e-02,  5.4760e-02,  3.1958e-02,  1.3772e-02,  5.2947e-02,\r\n          6.6481e-02, -1.8851e-02, -4.0262e-02, -1.9478e-02, -7.5332e-08,\r\n          4.3934e-03, -7.5911e-03, -7.2367e-02,  4.3946e-03,  9.0678e-02,\r\n          8.2694e-03, -2.7103e-02, -2.0347e-02,  4.5498e-02, -1.8159e-02,\r\n          1.1696e-01,  2.4856e-02, -7.1138e-03,  1.9983e-03,  7.0767e-02,\r\n          9.7332e-02, -6.3300e-03, -3.1941e-04,  4.7422e-02, -1.9222e-02,\r\n          2.7322e-02,  5.0757e-02,  1.0966e-02, -3.9493e-02,  5.6129e-02,\r\n          3.9650e-02,  1.9002e-02, -3.2329e-02, -1.0233e-03,  1.0374e-02,\r\n          3.6164e-02, -4.5132e-02, -2.7778e-02, -5.1033e-02,  3.2303e-03,\r\n         -1.3686e-02,  2.5406e-02, -1.6248e-02, -5.7482e-03, -2.1276e-02,\r\n          1.6730e-03, -3.6442e-02,  5.5261e-02,  1.0301e-02,  1.4009e-02,\r\n         -8.4312e-04, -4.0774e-02, -2.8691e-02, -5.7277e-03, -1.9615e-02,\r\n         -2.3636e-02, -1.8017e-02,  4.2499e-02, -1.5893e-02,  2.9600e-02,\r\n         -9.1020e-03, -1.2841e-02,  7.3806e-03,  6.8687e-03,  1.3533e-02,\r\n          3.8353e-02,  1.4765e-02, -5.3969e-02,  2.1416e-02]])\r\n```\r\n\r\n</details>\r\n\r\nThis was put together following [the models card example](https://huggingface.co/sentence-transformers/all-MiniLM-L12-v2) and coremltoolss [Convert a Natural Language Processing Model](https://coremltools.readme.io/docs/convert-nlp-model). ",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1428/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1428/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1425",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1425/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1425/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1425/events",
      "html_url": "https://github.com/apple/coremltools/issues/1425",
      "id": 1168344326,
      "node_id": "I_kwDOBba_B85Fo4UG",
      "number": 1425,
      "title": "How's the speed comparison between tvm (tuned) vs coreML?",
      "user": {
        "login": "jinfagang",
        "id": 21303438,
        "node_id": "MDQ6VXNlcjIxMzAzNDM4",
        "avatar_url": "https://avatars.githubusercontent.com/u/21303438?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jinfagang",
        "html_url": "https://github.com/jinfagang",
        "followers_url": "https://api.github.com/users/jinfagang/followers",
        "following_url": "https://api.github.com/users/jinfagang/following{/other_user}",
        "gists_url": "https://api.github.com/users/jinfagang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jinfagang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jinfagang/subscriptions",
        "organizations_url": "https://api.github.com/users/jinfagang/orgs",
        "repos_url": "https://api.github.com/users/jinfagang/repos",
        "events_url": "https://api.github.com/users/jinfagang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jinfagang/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2022-03-14T13:01:47Z",
      "updated_at": "2022-03-16T02:03:05Z",
      "closed_at": "2022-03-15T20:49:59Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nHi, How's the speed comparison between tvm (tuned) vs coreML?\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1425/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1425/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1421",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1421/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1421/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1421/events",
      "html_url": "https://github.com/apple/coremltools/issues/1421",
      "id": 1164741302,
      "node_id": "I_kwDOBba_B85FbIq2",
      "number": 1421,
      "title": "Question - Can We Retrive The Interim `nms_mask` from the NMS Model?",
      "user": {
        "login": "rsomani95",
        "id": 17111474,
        "node_id": "MDQ6VXNlcjE3MTExNDc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/17111474?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsomani95",
        "html_url": "https://github.com/rsomani95",
        "followers_url": "https://api.github.com/users/rsomani95/followers",
        "following_url": "https://api.github.com/users/rsomani95/following{/other_user}",
        "gists_url": "https://api.github.com/users/rsomani95/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rsomani95/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rsomani95/subscriptions",
        "organizations_url": "https://api.github.com/users/rsomani95/orgs",
        "repos_url": "https://api.github.com/users/rsomani95/repos",
        "events_url": "https://api.github.com/users/rsomani95/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rsomani95/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2022-03-10T04:33:55Z",
      "updated_at": "2022-03-13T18:32:31Z",
      "closed_at": "2022-03-11T21:33:43Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "CoreML's NMS model returns the retained boxes and the corresponding class scores, but *not* a boolean mask that can be used to do this filtering directly.\r\n\r\nImagine we have a model that outputs 10,000 *keypoints* and *bounding boxes*. We'd filter the *boxes* with NMS, and to retrieve the accompanying *keypoints*, we **require** the `nms_mask`. With CoreML's NMS model, there is no scope to do so.\r\n\r\nFor additional context, here's the NMS procedure in pseudocode:\r\n\r\n```python\r\nraw_bbox_class_scores\r\nraw_bbox_coordinates\r\nconfidence_threshold = 0.5\r\nnms_iou_threshold = 0.5\r\n\r\n# Step 1. Filter out low confidence boxes\r\nconf_mask = raw_bbox_class_scores > confidence_threshold\r\nnms_bbox_scores = raw_bbox_class_scores[conf_mask]\r\nnms_bbox_coords = raw_bbox_coordinates[conf_mask]\r\n\r\n# Step 2. Do NMS and get resulting mask\r\nnms_mask = do_nms(nms_bbox_coords, nms_bbox_scores, nms_iou_threshold)\r\n\r\n# Step 3. Filter boxes with NMS mask\r\nfinal_bbox_coords = nms_bbox_coords[nms_mask]\r\nfinal_bbox_conf   = nms_bbox_scores[nms_mask]\r\n\r\nreturn (final_bbox_coords, final_bbox_conf)\r\n\r\n```\r\n\r\nCoreML's NMS model returns the outputs of *Step 3* described above. We'd like to be able to get the outputs of *Step 2* to be able to filter the accompanying keypoint predictions.\r\n\r\nBased on the [NonMaximumSuppression.proto](https://github.com/apple/coremltools/blob/main/mlmodel/format/NonMaximumSuppression.proto), the only retrievable outputs are `confidenceOutputFeatureName` and `coordinatesOutputFeatureName`. **Is it possible to retrieve the interim `nms_mask`?**\r\n\r\n---\r\n\r\nHere's how we do it in PyTorch (`torchvision.ops.batched_nms` provides us with the NMS mask):\r\n\r\n```python\r\ndef postprocess_torch(\r\n    boxes_xyxy,\r\n    class_scores,\r\n    landmarks_xy,\r\n    conf_thresh=0.5,\r\n    nms_iou_thresh=0.5,\r\n    nms_per_class=True,\r\n):\r\n    \"\"\"\r\n    Takes outputs of a _single sample_ from a batch and:\r\n    1. Filters predictions below `conf_thresh`\r\n    2. Applies NMS to remove overlapping boxes above `nms_iou_thresh`\r\n    3. Filters landmarks and boxes based on the NMS filter mask\r\n    \"\"\"\r\n    from torchvision.ops import nms, batched_nms\r\n\r\n    assert boxes_xyxy.ndim == class_scores.ndim, f\"{boxes_xyxy.ndim, class_scores.ndim}\"\r\n    ndim = boxes_xyxy.ndim\r\n\r\n    class_confidence, class_idxs = torch.max(class_scores, dim=ndim - 1, keepdim=False)\r\n    conf_mask = class_confidence >= conf_thresh\r\n\r\n    boxes_xyxy = boxes_xyxy[conf_mask]\r\n    class_confidence = class_confidence[conf_mask]\r\n    class_idxs = class_idxs[conf_mask]\r\n    landmarks_xy = landmarks_xy[conf_mask]\r\n\r\n    nms_mask = batched_nms(boxes_xyxy, class_confidence, class_idxs, nms_iou_thresh)\r\n\r\n    return (\r\n        boxes_xyxy[nms_mask],\r\n        class_confidence[nms_mask],\r\n        class_idxs[nms_mask],\r\n        landmarks_xy[nms_mask],\r\n    )\r\n\r\n```\r\n\r\n---\r\n\r\nFor reference, this is how we're creating the CoreML NMS model:\r\n\r\n```python\r\ndef build_bbox_nms_model(\r\n    model_that_outputs_raw_bboxes: ct.models.MLModel,\r\n    output_confidence_name=\"bbox_class_scores\",\r\n    output_coords_name=\"bbox_coordinates_cxcywh\",\r\n    input_confidence_name=\"raw_bbox_class_scores\",\r\n    input_coords_name=\"raw_bbox_coords_normalised_cxcywh\",\r\n    iou_thresh=0.5,\r\n    iou_thresh_name=\"IoUThreshold\",\r\n    confidence_thresh=0.5,\r\n    confidence_thresh_name=\"BBoxConfidenceThreshold\",\r\n    pick_top_per_class=True,\r\n    num_classes: int = 80,\r\n    labels: List[str] = None,\r\n) -> ct.models.MLModel:\r\n    assert labels is not None, f\"`labels` argument required!!\"\r\n    assert num_classes == len(labels), f\"Num classes != len(labels) !!\"\r\n\r\n    spec = model_that_outputs_raw_bboxes.get_spec()\r\n    nms_spec = ct.proto.Model_pb2.Model()\r\n    nms_spec.specificationVersion = 3\r\n\r\n    # Do this loop twice because we _require_ (?) the first input\r\n    # to be the class confidence, and the second to be the coords\r\n    # This way we can ensure any mlmod can be passed in securely\r\n\r\n    _found_input_conf = False\r\n    _found_input_coords = False\r\n\r\n    for output in spec.description.output:\r\n        if output.name == input_confidence_name:\r\n            nms_spec.description.input.add()\r\n            nms_spec.description.output.add()\r\n            nms_spec.description.input[0].ParseFromString(output.SerializeToString())\r\n            nms_spec.description.output[0].ParseFromString(output.SerializeToString())\r\n            _found_input_conf = True\r\n\r\n    for output in spec.description.output:\r\n        if output.name == input_coords_name:\r\n            nms_spec.description.input.add()\r\n            nms_spec.description.output.add()\r\n            nms_spec.description.input[1].ParseFromString(output.SerializeToString())\r\n            nms_spec.description.output[1].ParseFromString(output.SerializeToString())\r\n            _found_input_coords = True\r\n\r\n    if not _found_input_conf:\r\n        logger.warning(f\"Failed to find `input_confidence_name`=='{input_confidence_name}'\")\r\n\r\n    if not _found_input_coords:\r\n        logger.warning(f\"Failed to find `input_coords_name`=='{input_coords_name}'\")\r\n\r\n    nms_spec.description.output[0].name = output_confidence_name\r\n    nms_spec.description.output[1].name = output_coords_name\r\n\r\n    output_sizes = [num_classes, 4]\r\n    for i in range(2):\r\n        # ma_type -> multiArrayType\r\n        ma_type = nms_spec.description.output[i].type.multiArrayType\r\n        ma_type.shapeRange.sizeRanges.add()\r\n        ma_type.shapeRange.sizeRanges[0].lowerBound = 0\r\n        ma_type.shapeRange.sizeRanges[0].upperBound = -1\r\n        ma_type.shapeRange.sizeRanges.add()\r\n        ma_type.shapeRange.sizeRanges[1].lowerBound = output_sizes[i]\r\n        ma_type.shapeRange.sizeRanges[1].upperBound = output_sizes[i]\r\n        del ma_type.shape[:]\r\n\r\n    nms = nms_spec.nonMaximumSuppression\r\n    nms.confidenceInputFeatureName = input_confidence_name\r\n    nms.coordinatesInputFeatureName = input_coords_name\r\n    nms.confidenceOutputFeatureName = output_confidence_name\r\n    nms.coordinatesOutputFeatureName = output_coords_name\r\n    nms.iouThresholdInputFeatureName = iou_thresh_name\r\n    nms.confidenceThresholdInputFeatureName = confidence_thresh_name\r\n\r\n    default_iou_threshold = iou_thresh\r\n    default_confidence_threshold = confidence_thresh\r\n\r\n    nms.iouThreshold = default_iou_threshold\r\n    nms.confidenceThreshold = default_confidence_threshold\r\n    nms.pickTop.perClass = pick_top_per_class\r\n    nms.stringClassLabels.vector.extend(labels)\r\n\r\n    nms_model = ct.models.MLModel(nms_spec)\r\n    return nms_model\r\n\r\n```",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1421/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1421/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1413",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1413/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1413/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1413/events",
      "html_url": "https://github.com/apple/coremltools/issues/1413",
      "id": 1148283169,
      "node_id": "I_kwDOBba_B85EcWkh",
      "number": 1413,
      "title": "More Activation Functions Available for Backprop",
      "user": {
        "login": "congriUQ",
        "id": 48324047,
        "node_id": "MDQ6VXNlcjQ4MzI0MDQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/48324047?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/congriUQ",
        "html_url": "https://github.com/congriUQ",
        "followers_url": "https://api.github.com/users/congriUQ/followers",
        "following_url": "https://api.github.com/users/congriUQ/following{/other_user}",
        "gists_url": "https://api.github.com/users/congriUQ/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/congriUQ/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/congriUQ/subscriptions",
        "organizations_url": "https://api.github.com/users/congriUQ/orgs",
        "repos_url": "https://api.github.com/users/congriUQ/repos",
        "events_url": "https://api.github.com/users/congriUQ/events{/privacy}",
        "received_events_url": "https://api.github.com/users/congriUQ/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1433382939,
          "node_id": "MDU6TGFiZWwxNDMzMzgyOTM5",
          "url": "https://api.github.com/repos/apple/coremltools/labels/feature%20request",
          "name": "feature request",
          "color": "c10f47",
          "default": false,
          "description": "Functionality does not currently exist, would need to be created as a new feature (type)"
        },
        {
          "id": 1722445778,
          "node_id": "MDU6TGFiZWwxNzIyNDQ1Nzc4",
          "url": "https://api.github.com/repos/apple/coremltools/labels/CoreML.Framework",
          "name": "CoreML.Framework",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2022-02-23T16:04:45Z",
      "updated_at": "2022-02-25T00:30:07Z",
      "closed_at": "2022-02-25T00:29:54Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\nProblem: Only three activation functions are available for backpropagation: ReLU, sigmoid, and tanh. Moreover, basic MIL operations (like `mb.mul`) are not backpropagable either. In particular, I would like to have the leaky ReLU to be available for backprop.\r\n- Core ML / iOS version: Core ML 5.2\r\n- Interested in contributing: yes\r\n\r\n## Use cases\r\n- A larger modeling variety. In our case, we are observing best prediction accuracy using leaky relu in a 3-layer MLP, but need to use relu to enable on-device training.\r\n\r\n## Describe alternatives you've considered\r\nUsing the activations/layers available for backprop only.\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1413/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1413/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1412",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1412/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1412/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1412/events",
      "html_url": "https://github.com/apple/coremltools/issues/1412",
      "id": 1148081043,
      "node_id": "I_kwDOBba_B85EblOT",
      "number": 1412,
      "title": "How to correctly compare and validate the outputs of a CoreML model?",
      "user": {
        "login": "NatanBagrov",
        "id": 20153650,
        "node_id": "MDQ6VXNlcjIwMTUzNjUw",
        "avatar_url": "https://avatars.githubusercontent.com/u/20153650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/NatanBagrov",
        "html_url": "https://github.com/NatanBagrov",
        "followers_url": "https://api.github.com/users/NatanBagrov/followers",
        "following_url": "https://api.github.com/users/NatanBagrov/following{/other_user}",
        "gists_url": "https://api.github.com/users/NatanBagrov/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/NatanBagrov/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/NatanBagrov/subscriptions",
        "organizations_url": "https://api.github.com/users/NatanBagrov/orgs",
        "repos_url": "https://api.github.com/users/NatanBagrov/repos",
        "events_url": "https://api.github.com/users/NatanBagrov/events{/privacy}",
        "received_events_url": "https://api.github.com/users/NatanBagrov/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2022-02-23T13:15:23Z",
      "updated_at": "2022-03-01T06:06:02Z",
      "closed_at": "2022-03-01T06:06:01Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nI'm trying to assert that the conversion is correct, however, even for `nn.Identity()` there seem to be discrepancies.\r\nI suspect it has something to do with quantization, maybe...\r\n```python\r\ndef test():\r\n    channels_in = 4\r\n    input_size = 512\r\n    dummy_input = torch.rand((1, channels_in, input_size, input_size))\r\n    model = nn.Identity()\r\n    model.eval()\r\n    with torch.no_grad():\r\n        torch_outputs = model(dummy_input)\r\n\r\n    np.testing.assert_allclose(_to_numpy(dummy_input), _to_numpy(torch_outputs))  # PASSES\r\n\r\n    input_tensor_name = \"input_1\"\r\n    traced_model = torch.jit.trace(model, dummy_input)\r\n\r\n    model_coreml = ct.convert(traced_model, inputs=[\r\n        ct.TensorType(name=input_tensor_name, shape=(1, channels_in, input_size, input_size)),\r\n    ], minimum_deployment_target=ct.target.iOS13)\r\n\r\n    coreml_outputs = model_coreml.predict({input_tensor_name: _to_numpy(dummy_input)})\r\n    coreml_outputs = coreml_outputs[list(coreml_outputs.keys())[0]]\r\n    np.testing.assert_allclose(_to_numpy(torch_outputs), coreml_outputs)  # FAILS\r\n\r\n\r\ndef _to_numpy(tensor: torch.Tensor):\r\n    return tensor.detach().cpu().numpy() if tensor.requires_grad else tensor.cpu().numpy()\r\n```\r\n\r\nWith an error:\r\n```\r\nMismatched elements: 1834618 / 1835008 (100%)\r\nMax absolute difference: 0.00048822\r\nMax relative difference: 0.04680521\r\n x: array([[[[0.435283, 0.750752, 0.190701, ..., 0.562583, 0.174633,\r\n          0.155076],\r\n         [0.346514, 0.161586, 0.773911, ..., 0.141963, 0.203195,...\r\n y: array([[[[0.435059, 0.750488, 0.190674, ..., 0.5625  , 0.174561,\r\n          0.155029],\r\n         [0.346436, 0.161499, 0.773438, ..., 0.141846, 0.203125,...\r\n```\r\n\r\n*NOTE:* This has something to do with CoreML rather than Torch compatibility, since this fails as well:\r\n```python\r\nnp.testing.assert_allclose(_to_numpy(dummy_input), coreml_outputs)\r\n```\r\n\r\n### Things I've noticed/tried:\r\n- The `.mlmodel` file has FP16 compute and FP32 I/O. Even when I set `dtype=ct.converters.mil.types.fp16` or `dtype=np.float16` I get the same specs (FP32) for I/O. **Is this another bug?**\r\n- When I cast `dummy_input` to FP16, I can't feed it to `predict` (maybe it is related to the bullet above):\r\n    ```\r\n    Error: value type not convertible... ... coremltools/models/model.py\", line 438, in predict\r\n    ```\r\n- Adding `compute_units=ct.ComputeUnit.CPU_ONLY` seems to solve this issue; (1) why? (2) **however this implies that all the computation is done on the cpu, thus worse latency on iOS, is that correct?**\r\n\r\n## System Information\r\n- PyTorch 1.9.1, CoreML 5.1.0, macOS Monterey 12.1, MBP 13 Late 2020.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1412/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1412/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1406",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1406/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1406/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1406/events",
      "html_url": "https://github.com/apple/coremltools/issues/1406",
      "id": 1136233963,
      "node_id": "I_kwDOBba_B85DuY3r",
      "number": 1406,
      "title": "PyTorch Core ML Model - Can State/Previous Output be Saved?",
      "user": {
        "login": "larryoshinty",
        "id": 56127376,
        "node_id": "MDQ6VXNlcjU2MTI3Mzc2",
        "avatar_url": "https://avatars.githubusercontent.com/u/56127376?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/larryoshinty",
        "html_url": "https://github.com/larryoshinty",
        "followers_url": "https://api.github.com/users/larryoshinty/followers",
        "following_url": "https://api.github.com/users/larryoshinty/following{/other_user}",
        "gists_url": "https://api.github.com/users/larryoshinty/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/larryoshinty/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/larryoshinty/subscriptions",
        "organizations_url": "https://api.github.com/users/larryoshinty/orgs",
        "repos_url": "https://api.github.com/users/larryoshinty/repos",
        "events_url": "https://api.github.com/users/larryoshinty/events{/privacy}",
        "received_events_url": "https://api.github.com/users/larryoshinty/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2022-02-13T18:13:06Z",
      "updated_at": "2022-03-17T23:35:14Z",
      "closed_at": "2022-03-17T23:35:14Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Saving data between calls to Core ML model - PyTorch \r\nI am trying to save the output from previous calls to a model in a state list. This works without issue in PyTorch, but when I convert the model, it seems that the state, defined in the model class, cannot be saved. The issue can be recreated using the following code:\r\n\r\n```\r\nimport torch\r\nimport torch.nn as nn\r\nimport coremltools as ct\r\n\r\n\r\nclass TestConvNet(nn.Module):\r\n    def __init__(self):\r\n        super(TestConvNet, self).__init__()\r\n\r\n        self.conv1 = nn.Conv2d(1,1,1)\r\n        self.state = None\r\n\r\n    def forward(self, x):\r\n        x = self.conv1(x)\r\n        if (self.state == None):\r\n            self.state = [torch.zeros_like(x), torch.zeros_like(x)]\r\n        else: \r\n            self.state = self.state[1:]\r\n            self.state.append(x)\r\n        return self.state[0]\r\n\r\n\r\ndef test_coreml_network():\r\n\r\n    #pytorch_model = model\r\n    pytorch_model = TestConvNet()\r\n    pytorch_model.eval()\r\n\r\n    # Trace the model with random data.\r\n    example_input = torch.randn(1,1,128,1, dtype=torch.float32)\r\n\r\n    # Trace PyTorch model\r\n    traced_model = torch.jit.trace(pytorch_model, example_input, check_trace=False)\r\n\r\n    # Convert to Core ML using the Unified Conversion API.\r\n    coreml_model = ct.convert(\r\n        traced_model,\r\n        inputs=[ct.TensorType(shape=example_input.shape)],\r\n        convert_to=\"mlprogram\", \r\n        compute_precision=ct.precision.FLOAT32,\r\n        compute_units=ct.ComputeUnit.CPU_ONLY,\r\n        useCPUOnly=True,\r\n        debug=True,\r\n    )\r\n\r\n    # Extract Core ML input and output dictionary labels\r\n    coreml_input_label = str(coreml_model.input_description._fd_spec).split(\"\\\"\")[1]\r\n    coreml_output_label = str(coreml_model.output_description._fd_spec).split(\"\\\"\")[1]\r\n  \r\n\r\n    for i in range(100):\r\n\r\n        # Create random test vector \r\n        example_input = torch.randn(1,1,128,1, dtype=torch.float32)\r\n\r\n        # Call Core ML model using coremltools API coremltools.predict() function\r\n        coreml_model_op = coreml_model.predict({coreml_input_label: example_input.cpu().detach().numpy()})\r\n\r\n        # Convert output to Tensor type\r\n        coreml_model_op = torch.tensor(coreml_model_op[coreml_output_label])\r\n\r\n        # Call PyTorch model\r\n        pytorch_model_op = pytorch_model(example_input)\r\n\r\n        print(coreml_model_op)\r\n        print(pytorch_model_op)\r\n\r\n\r\ndef main():\r\n       test_coreml_network()\r\n    \r\nif __name__ == '__main__':\r\n    main()\r\n```\r\n\r\nIt seems that each time a call to the Core ML model is made, self.state is set to None and the state array always gets initialised to zeros.\r\n\r\nWould be very grateful if anybody can shed some light on this.\r\n\r\nThanks,\r\nBrian\r\n\r\n## System Information\r\n- If applicable\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1406/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1406/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1404",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1404/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1404/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1404/events",
      "html_url": "https://github.com/apple/coremltools/issues/1404",
      "id": 1128329838,
      "node_id": "I_kwDOBba_B85DQPJu",
      "number": 1404,
      "title": "CoreML quantization",
      "user": {
        "login": "zhiwei-dong",
        "id": 40209280,
        "node_id": "MDQ6VXNlcjQwMjA5Mjgw",
        "avatar_url": "https://avatars.githubusercontent.com/u/40209280?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zhiwei-dong",
        "html_url": "https://github.com/zhiwei-dong",
        "followers_url": "https://api.github.com/users/zhiwei-dong/followers",
        "following_url": "https://api.github.com/users/zhiwei-dong/following{/other_user}",
        "gists_url": "https://api.github.com/users/zhiwei-dong/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/zhiwei-dong/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zhiwei-dong/subscriptions",
        "organizations_url": "https://api.github.com/users/zhiwei-dong/orgs",
        "repos_url": "https://api.github.com/users/zhiwei-dong/repos",
        "events_url": "https://api.github.com/users/zhiwei-dong/events{/privacy}",
        "received_events_url": "https://api.github.com/users/zhiwei-dong/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-02-09T10:14:30Z",
      "updated_at": "2022-03-17T23:34:31Z",
      "closed_at": "2022-03-17T23:34:31Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI want to deploy my low-precision PyTorch model to CoreML format, but I quantize it using another tool, then export onnx format with quantization nodes. \r\n1. How can I transfer it to low-precision CoreML not to FP32 CoreML and using CoreML quantization tool to low-precision model\r\n2. Is there CoreML  a Telegram group for discuss or anything else\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1404/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1404/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1403",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1403/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1403/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1403/events",
      "html_url": "https://github.com/apple/coremltools/issues/1403",
      "id": 1125731682,
      "node_id": "I_kwDOBba_B85DGU1i",
      "number": 1403,
      "title": "How to convert a .ckpt file?",
      "user": {
        "login": "siam009",
        "id": 33008567,
        "node_id": "MDQ6VXNlcjMzMDA4NTY3",
        "avatar_url": "https://avatars.githubusercontent.com/u/33008567?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/siam009",
        "html_url": "https://github.com/siam009",
        "followers_url": "https://api.github.com/users/siam009/followers",
        "following_url": "https://api.github.com/users/siam009/following{/other_user}",
        "gists_url": "https://api.github.com/users/siam009/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/siam009/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/siam009/subscriptions",
        "organizations_url": "https://api.github.com/users/siam009/orgs",
        "repos_url": "https://api.github.com/users/siam009/repos",
        "events_url": "https://api.github.com/users/siam009/events{/privacy}",
        "received_events_url": "https://api.github.com/users/siam009/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 6,
      "created_at": "2022-02-07T09:30:52Z",
      "updated_at": "2022-02-09T18:28:11Z",
      "closed_at": "2022-02-09T18:28:11Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## How can I convert a .ckpt file using coremltools?\r\nI am trying to use this https://github.com/saic-mdal/lama model in my ios Project. Currently I am trying with this code.\r\n\r\nimport torch\r\nmodel = torch.load('best.ckpt')\r\nmodel1 = ct.convert(model, inputs=[ct.ImageType(), ct.ImageType()], source=\"pytorch\")\r\n\r\nBut I am getting this error \"model must either be a PyTorch .pt or .pth file or a TorchScript object, received: <class 'dict'>\".\r\n\r\nWhat am I doing wrong? Can anyone help me to use .ckpt file in iOS project?\r\n\r\n## System Information\r\n- google colab\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1403/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1403/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1399",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1399/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1399/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1399/events",
      "html_url": "https://github.com/apple/coremltools/issues/1399",
      "id": 1117468645,
      "node_id": "I_kwDOBba_B85Cmzfl",
      "number": 1399,
      "title": "Where is the CoreML program shown in wwdc2021?",
      "user": {
        "login": "AnFunctionArray",
        "id": 16734426,
        "node_id": "MDQ6VXNlcjE2NzM0NDI2",
        "avatar_url": "https://avatars.githubusercontent.com/u/16734426?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/AnFunctionArray",
        "html_url": "https://github.com/AnFunctionArray",
        "followers_url": "https://api.github.com/users/AnFunctionArray/followers",
        "following_url": "https://api.github.com/users/AnFunctionArray/following{/other_user}",
        "gists_url": "https://api.github.com/users/AnFunctionArray/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/AnFunctionArray/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/AnFunctionArray/subscriptions",
        "organizations_url": "https://api.github.com/users/AnFunctionArray/orgs",
        "repos_url": "https://api.github.com/users/AnFunctionArray/repos",
        "events_url": "https://api.github.com/users/AnFunctionArray/events{/privacy}",
        "received_events_url": "https://api.github.com/users/AnFunctionArray/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-01-28T14:27:55Z",
      "updated_at": "2022-02-02T02:40:49Z",
      "closed_at": "2022-02-02T02:40:48Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "[So basically my question ](https://stackoverflow.com/questions/70890320/how-to-create-coreml-program-in-swift-from-scratch/70891264#70891264) is when will you release the example and tools to write Swift CoreML programs as shown in wwdc2021 [video here](https://developer.apple.com/videos/play/wwdc2021/10038/):\r\n\r\n![image](https://user-images.githubusercontent.com/16734426/151563298-0a80e1e8-8973-440a-b3af-49a0a39ef75f.png)\r\n\r\nI looked but couldn't find a way. [The documentation](https://apple.github.io/coremltools/mlmodel/Format/MIL.html#program) is in protobuf and this looks like some sort of swift intermediate implementation (which is higher level than https://github.com/apple/swift-protobuf).\r\n\r\nPlease release this implementation - people are interested in utilizing the full capabilities of this technology in swift - not only converting pre-made models .",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1399/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1399/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1398",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1398/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1398/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1398/events",
      "html_url": "https://github.com/apple/coremltools/issues/1398",
      "id": 1117001572,
      "node_id": "I_kwDOBba_B85ClBdk",
      "number": 1398,
      "title": "Accessing/editing MLProgram Layers",
      "user": {
        "login": "anklebreaker",
        "id": 44176313,
        "node_id": "MDQ6VXNlcjQ0MTc2MzEz",
        "avatar_url": "https://avatars.githubusercontent.com/u/44176313?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/anklebreaker",
        "html_url": "https://github.com/anklebreaker",
        "followers_url": "https://api.github.com/users/anklebreaker/followers",
        "following_url": "https://api.github.com/users/anklebreaker/following{/other_user}",
        "gists_url": "https://api.github.com/users/anklebreaker/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/anklebreaker/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/anklebreaker/subscriptions",
        "organizations_url": "https://api.github.com/users/anklebreaker/orgs",
        "repos_url": "https://api.github.com/users/anklebreaker/repos",
        "events_url": "https://api.github.com/users/anklebreaker/events{/privacy}",
        "received_events_url": "https://api.github.com/users/anklebreaker/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-01-28T04:56:02Z",
      "updated_at": "2022-03-25T20:38:42Z",
      "closed_at": "2022-03-25T20:38:42Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Is there a way to access a model's layers with MLProgram like in MLModel with model._spec.neuralNetwork.layers? The conversion process can sometimes introduce artifacts or unnecessary layers which I could remove in MLModels by directly editing or modifying the graph. I wondered if a similar approach is possible or alternatively if it's possible to convert directly from MLModel to MLProgram.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1398/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1398/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1391",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1391/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1391/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1391/events",
      "html_url": "https://github.com/apple/coremltools/issues/1391",
      "id": 1108950292,
      "node_id": "I_kwDOBba_B85CGT0U",
      "number": 1391,
      "title": "Process input tensor by `builder.add_transpose` in custom layer makes the function always run on CPU",
      "user": {
        "login": "Tengxu-Sun",
        "id": 52795221,
        "node_id": "MDQ6VXNlcjUyNzk1MjIx",
        "avatar_url": "https://avatars.githubusercontent.com/u/52795221?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Tengxu-Sun",
        "html_url": "https://github.com/Tengxu-Sun",
        "followers_url": "https://api.github.com/users/Tengxu-Sun/followers",
        "following_url": "https://api.github.com/users/Tengxu-Sun/following{/other_user}",
        "gists_url": "https://api.github.com/users/Tengxu-Sun/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Tengxu-Sun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Tengxu-Sun/subscriptions",
        "organizations_url": "https://api.github.com/users/Tengxu-Sun/orgs",
        "repos_url": "https://api.github.com/users/Tengxu-Sun/repos",
        "events_url": "https://api.github.com/users/Tengxu-Sun/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Tengxu-Sun/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2022-01-20T07:23:10Z",
      "updated_at": "2022-01-27T01:59:43Z",
      "closed_at": "2022-01-27T01:59:43Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nHi @TobyRoseman\r\nI'm trying to implement a 5-D input tensor version of custom `grid_sample` based on [this work](https://github.com/dneprDroid/pytroch-coreml-custom-layer-example). For encoding one of the input  tensor, `grid` to a `MTLTexture` as described in [officical guide](https://developer.apple.com/documentation/coreml/mlcustomlayer/2936859-encodetocommandbuffer?language=objc), i need to transpose `grid` from (ND_gridW_gridH_grid3) to (N3D_gridW_grid H_grid) by [`builder.add_transpose`](https://github.com/apple/coremltools/blob/f19052c7f113740069bfac7b0291c5c6c9571ca6/coremltools/models/neural_network/builder.py#L4718) similar like shown [here](https://github.com/dneprDroid/pytroch-coreml-custom-layer-example/blob/a5ce9e46c1c0eefc9f2a5f942ce417ea1b54a9c9/Convert/convert.py#L49). But in my implementation, i find that adding this transpose op will make the custom layer always run on CPU. Without this layer,  the data can get in GPU. I doubt will `builder.add_transpose` have an effect on this?\r\n\r\n\r\n## System Information\r\n- xcode: 13.2\r\n- coremltools: 4.1/5.1.0\r\n- test device: iphone 11",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1391/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1391/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1388",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1388/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1388/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1388/events",
      "html_url": "https://github.com/apple/coremltools/issues/1388",
      "id": 1103456052,
      "node_id": "I_kwDOBba_B85BxWc0",
      "number": 1388,
      "title": "CoreML custom layer implemented by `object-C` doesn't work in `swift`  testing project.",
      "user": {
        "login": "Tengxu-Sun",
        "id": 52795221,
        "node_id": "MDQ6VXNlcjUyNzk1MjIx",
        "avatar_url": "https://avatars.githubusercontent.com/u/52795221?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Tengxu-Sun",
        "html_url": "https://github.com/Tengxu-Sun",
        "followers_url": "https://api.github.com/users/Tengxu-Sun/followers",
        "following_url": "https://api.github.com/users/Tengxu-Sun/following{/other_user}",
        "gists_url": "https://api.github.com/users/Tengxu-Sun/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Tengxu-Sun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Tengxu-Sun/subscriptions",
        "organizations_url": "https://api.github.com/users/Tengxu-Sun/orgs",
        "repos_url": "https://api.github.com/users/Tengxu-Sun/repos",
        "events_url": "https://api.github.com/users/Tengxu-Sun/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Tengxu-Sun/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-01-14T10:49:12Z",
      "updated_at": "2022-01-14T20:18:32Z",
      "closed_at": "2022-01-14T20:18:32Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question \r\nI convert a pytorch model to `mlmodel` with a custom layer, and create a test app in `swift` to test my model. When i implement the custom layer by `swift`, it works well. However when i implement the custom layer by `object-C`, the code return\r\n```\r\n2022-01-14 17:58:49.964377+0800 CustomLayers[2547:968723] [coreml] Error in adding network -1.\r\n2022-01-14 17:58:49.965023+0800 CustomLayers[2547:968723] [coreml] MLModelAsset: load failed with error Error Domain=com.apple.CoreML Code=0 \"Error in declaring network.\" UserInfo={NSLocalizedDescription=Error in declaring network.}\r\n2022-01-14 17:58:49.965085+0800 CustomLayers[2547:968723] [coreml] MLModelAsset: modelWithError: load failed with error Error Domain=com.apple.CoreML Code=0 \"Error in declaring network.\" UserInfo={NSLocalizedDescription=Error in declaring network.}\r\nFatal error: 'try!' expression unexpectedly raised an error: Error Domain=com.apple.CoreML Code=0 \"Error in declaring network.\" UserInfo={NSLocalizedDescription=Error in declaring network.}: file CustomLayers/model_2.swift, line 114\r\n2022-01-14 17:58:49.966267+0800 CustomLayers[2547:968723] Fatal error: 'try!' expression unexpectedly raised an error: Error Domain=com.apple.CoreML Code=0 \"Error in declaring network.\" UserInfo={NSLocalizedDescription=Error in declaring network.}: file CustomLayers/model_2.swift, line 114\r\n(lldb) \r\n```\r\nIt seems the model load failed with `object-C` custom layer. So i wonder does `object-C` custom layer implementation can't work with `swift` project? Although i try to set the `CustomLayers-Bridging-Header.h`. It still doesn't work.\r\n\r\n## System Information\r\n- mac OS: 11.6.1 Big Sur\r\n- xcode: 12.5.1\r\n- coremltools: 5.1.0\r\n-  test device: iphone 11\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1388/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1388/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1387",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1387/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1387/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1387/events",
      "html_url": "https://github.com/apple/coremltools/issues/1387",
      "id": 1100005022,
      "node_id": "I_kwDOBba_B85BkL6e",
      "number": 1387,
      "title": "Why i enabled Metal API in `encode` function but my Coreml custom layer still run on CPU",
      "user": {
        "login": "Tengxu-Sun",
        "id": 52795221,
        "node_id": "MDQ6VXNlcjUyNzk1MjIx",
        "avatar_url": "https://avatars.githubusercontent.com/u/52795221?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Tengxu-Sun",
        "html_url": "https://github.com/Tengxu-Sun",
        "followers_url": "https://api.github.com/users/Tengxu-Sun/followers",
        "following_url": "https://api.github.com/users/Tengxu-Sun/following{/other_user}",
        "gists_url": "https://api.github.com/users/Tengxu-Sun/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Tengxu-Sun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Tengxu-Sun/subscriptions",
        "organizations_url": "https://api.github.com/users/Tengxu-Sun/orgs",
        "repos_url": "https://api.github.com/users/Tengxu-Sun/repos",
        "events_url": "https://api.github.com/users/Tengxu-Sun/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Tengxu-Sun/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2022-01-12T08:06:59Z",
      "updated_at": "2022-01-13T02:57:51Z",
      "closed_at": "2022-01-13T01:13:40Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Why i enabled Metal API in `encode` function but my Coreml custom layer still run on CPU\r\n\r\nI implement a custom pytorch layer on both CPU and GPU following [Hollemans amazing blog](https://machinethink.net/blog/coreml-custom-layers/). The cpu version works good, but when i implemented this op on GPU it cannot activate \"encode\" function. Always run on CPU.  I have checked the `coremltools.convert()` options with `compute_units=coremltools.ComputeUnit.CPU_AND_GPU`, but it still not work.  This problem also mentioned in https://stackoverflow.com/questions/51019600/why-i-enabled-metal-api-but-my-coreml-custom-layer-still-run-on-cpu and https://developer.apple.com/forums/thread/695640.   Any idea on help this would be grateful.\r\n\r\n## System Information\r\n- mac OS: 11.6.1 Big Sur\r\n- xcode: 12.5.1\r\n- coremltools: 5.1.0\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1387/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1387/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1386",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1386/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1386/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1386/events",
      "html_url": "https://github.com/apple/coremltools/issues/1386",
      "id": 1099572214,
      "node_id": "I_kwDOBba_B85BiiP2",
      "number": 1386,
      "title": "Found a possible security concern",
      "user": {
        "login": "JamieSlome",
        "id": 55323451,
        "node_id": "MDQ6VXNlcjU1MzIzNDUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/55323451?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JamieSlome",
        "html_url": "https://github.com/JamieSlome",
        "followers_url": "https://api.github.com/users/JamieSlome/followers",
        "following_url": "https://api.github.com/users/JamieSlome/following{/other_user}",
        "gists_url": "https://api.github.com/users/JamieSlome/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/JamieSlome/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/JamieSlome/subscriptions",
        "organizations_url": "https://api.github.com/users/JamieSlome/orgs",
        "repos_url": "https://api.github.com/users/JamieSlome/repos",
        "events_url": "https://api.github.com/users/JamieSlome/events{/privacy}",
        "received_events_url": "https://api.github.com/users/JamieSlome/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2022-01-11T20:07:29Z",
      "updated_at": "2022-01-12T10:29:55Z",
      "closed_at": "2022-01-11T22:13:36Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Hey there!\n\nI belong to an open source security research community, and a member (@srikanthprathi) has found an issue, but doesnt know the best way to disclose it.\n\nIf not a hassle, might you kindly add a `SECURITY.md` file with an email, or another contact method? GitHub [recommends](https://docs.github.com/en/code-security/getting-started/adding-a-security-policy-to-your-repository) this best practice to ensure security issues are responsibly disclosed, and it would serve as a simple instruction for security researchers in the future.\n\nThank you for your consideration, and I look forward to hearing from you!\n\n(cc @huntr-helper)",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1386/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1386/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1385",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1385/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1385/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1385/events",
      "html_url": "https://github.com/apple/coremltools/issues/1385",
      "id": 1098430319,
      "node_id": "I_kwDOBba_B85BeLdv",
      "number": 1385,
      "title": "I want add new layer to mlpackage(MLProgram) like neuralnetwork builder do \"add_argmax\".",
      "user": {
        "login": "john-rocky",
        "id": 23278992,
        "node_id": "MDQ6VXNlcjIzMjc4OTky",
        "avatar_url": "https://avatars.githubusercontent.com/u/23278992?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-rocky",
        "html_url": "https://github.com/john-rocky",
        "followers_url": "https://api.github.com/users/john-rocky/followers",
        "following_url": "https://api.github.com/users/john-rocky/following{/other_user}",
        "gists_url": "https://api.github.com/users/john-rocky/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/john-rocky/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/john-rocky/subscriptions",
        "organizations_url": "https://api.github.com/users/john-rocky/orgs",
        "repos_url": "https://api.github.com/users/john-rocky/repos",
        "events_url": "https://api.github.com/users/john-rocky/events{/privacy}",
        "received_events_url": "https://api.github.com/users/john-rocky/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        },
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-01-10T22:00:15Z",
      "updated_at": "2022-01-13T01:31:06Z",
      "closed_at": "2022-01-13T01:31:06Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I want add new layer to mlpackage like neuralnetwork builder do \"add_argmax\".\r\nHow can I do this?\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1385/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1385/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1384",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1384/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1384/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1384/events",
      "html_url": "https://github.com/apple/coremltools/issues/1384",
      "id": 1097577497,
      "node_id": "I_kwDOBba_B85Ba7QZ",
      "number": 1384,
      "title": "Is MacOS python inference using neural engine acceleration?",
      "user": {
        "login": "ChenchaoZhao",
        "id": 35147961,
        "node_id": "MDQ6VXNlcjM1MTQ3OTYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/35147961?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ChenchaoZhao",
        "html_url": "https://github.com/ChenchaoZhao",
        "followers_url": "https://api.github.com/users/ChenchaoZhao/followers",
        "following_url": "https://api.github.com/users/ChenchaoZhao/following{/other_user}",
        "gists_url": "https://api.github.com/users/ChenchaoZhao/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ChenchaoZhao/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ChenchaoZhao/subscriptions",
        "organizations_url": "https://api.github.com/users/ChenchaoZhao/orgs",
        "repos_url": "https://api.github.com/users/ChenchaoZhao/repos",
        "events_url": "https://api.github.com/users/ChenchaoZhao/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ChenchaoZhao/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-01-10T08:17:31Z",
      "updated_at": "2022-01-10T21:39:15Z",
      "closed_at": "2022-01-10T21:39:09Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "When making predictions using python CoreML tools on a Mac with M1 chip, is the inference done using GPU/Neural engine acceleration or it's running on CPU?",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1384/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1384/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1383",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1383/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1383/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1383/events",
      "html_url": "https://github.com/apple/coremltools/issues/1383",
      "id": 1097343555,
      "node_id": "I_kwDOBba_B85BaCJD",
      "number": 1383,
      "title": "How can I add new operation to mlprogram?",
      "user": {
        "login": "john-rocky",
        "id": 23278992,
        "node_id": "MDQ6VXNlcjIzMjc4OTky",
        "avatar_url": "https://avatars.githubusercontent.com/u/23278992?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/john-rocky",
        "html_url": "https://github.com/john-rocky",
        "followers_url": "https://api.github.com/users/john-rocky/followers",
        "following_url": "https://api.github.com/users/john-rocky/following{/other_user}",
        "gists_url": "https://api.github.com/users/john-rocky/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/john-rocky/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/john-rocky/subscriptions",
        "organizations_url": "https://api.github.com/users/john-rocky/orgs",
        "repos_url": "https://api.github.com/users/john-rocky/repos",
        "events_url": "https://api.github.com/users/john-rocky/events{/privacy}",
        "received_events_url": "https://api.github.com/users/john-rocky/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2022-01-10T00:24:09Z",
      "updated_at": "2022-01-11T01:19:57Z",
      "closed_at": "2022-01-10T19:06:41Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I converted swin segmentor to coreML model.\r\nThis model need resampling. So I converted it to mlprogram.\r\nnow, I want to add argmax to this.\r\nHow can I add new operation to mlprogram?",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1383/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1383/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1382",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1382/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1382/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1382/events",
      "html_url": "https://github.com/apple/coremltools/issues/1382",
      "id": 1097084276,
      "node_id": "I_kwDOBba_B85BZC10",
      "number": 1382,
      "title": "How to use `parameters` in `bindings` to specify some configuration parameters in pytorch Core ML Models  conversion.",
      "user": {
        "login": "Tengxu-Sun",
        "id": 52795221,
        "node_id": "MDQ6VXNlcjUyNzk1MjIx",
        "avatar_url": "https://avatars.githubusercontent.com/u/52795221?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Tengxu-Sun",
        "html_url": "https://github.com/Tengxu-Sun",
        "followers_url": "https://api.github.com/users/Tengxu-Sun/followers",
        "following_url": "https://api.github.com/users/Tengxu-Sun/following{/other_user}",
        "gists_url": "https://api.github.com/users/Tengxu-Sun/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Tengxu-Sun/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Tengxu-Sun/subscriptions",
        "organizations_url": "https://api.github.com/users/Tengxu-Sun/orgs",
        "repos_url": "https://api.github.com/users/Tengxu-Sun/repos",
        "events_url": "https://api.github.com/users/Tengxu-Sun/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Tengxu-Sun/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2022-01-09T02:06:50Z",
      "updated_at": "2022-01-13T01:12:12Z",
      "closed_at": "2022-01-13T01:12:12Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## How to use `parameters` in `bindings` to specify some configuration parameters in pytorch Core ML Models  conversion.\r\n\r\n## Key Code example\r\n- Register_op and specify `padding_mode, align_corners` in bindings. Then convert pytorch model to Core ML Model.\r\n```\r\n...\r\n...\r\n@register_op(doc_str=\"\")\r\nclass grid_sample(Operation):\r\n    \r\n    input_spec = InputSpec(\r\n        input=TensorInputType(),\r\n        grid=TensorInputType(),\r\n        mode=IntInputType(const=True),\r\n        padding_mode=IntInputType(const=True),\r\n        align_corners=BoolInputType(const=True),\r\n    )\r\n\r\n    bindings = {\r\n        \"class_name\": \"grid_sample\",\r\n        \"input_order\": [\"input\", \"grid\"],\r\n        \"parameters\": [\"padding_mode\", \"align_corners\"],\r\n        \"description\": \"PyTorch grid_sample\",\r\n    }\r\n\r\n    def __init__(self, **kwargs):\r\n        super(grid_sample, self).__init__(**kwargs)\r\n\r\n    def type_inference(self):\r\n        input_type = self.input.dtype\r\n        ret_shape = self.input.shape\r\n        return types.tensor(input_type, ret_shape)\r\n...\r\n...\r\n```\r\n\r\n- Implementate GridSampleLayer in swift\r\n```\r\n...\r\n...\r\n@objc(GridSampleLayer)\r\nfinal class GridSampleLayer: NSObject, MLCustomLayer {\r\n    let padding_mode: Int\r\n    let align_corners: Bool\r\n    \r\n    required init(parameters: [String : Any]) throws {\r\n        print(#function, parameters)\r\n        if let padding_mode = parameters[\"padding_mode\"] as? Int {\r\n              self.padding_mode = padding_mode\r\n            } else {\r\n              self.padding_mode = 0\r\n            }\r\n        if let align_corners = parameters[\"align_corners\"] as? Bool {\r\n              self.align_corners = align_corners\r\n            } else {\r\n              self.align_corners = false\r\n            }\r\n\r\n    func setWeightData(_ weights: [Data]) throws {\r\n    print(#function, weights)\r\n  }\r\n\r\n  func outputShapes(forInputShapes inputShapes: [[NSNumber]]) throws \r\n       -> [[NSNumber]] {\r\n    print(#function, inputShapes)\r\n    return inputShapes\r\n  }\r\n\r\n  func evaluate(inputs: [MLMultiArray], outputs: [MLMultiArray]) throws {\r\n    print(#function, inputs.count, outputs.count)\r\n    print(self.padding_mode, self.align_corners)\r\n  }\r\n}\r\n...\r\n...\r\n```\r\n\r\nBy codes example showed above, i still can't get `padding_mode` and `align_corners` in evaluate function. I also read the `keras` example implemented  by @hollance in [coreml-custom-layers](https://machinethink.net/blog/coreml-custom-layers/), but it seems not suitable in pytorch implementation. Is there any pytorch example about how to use `parameters` in `bindings` to specify some configuration parameters in pytorch coremlmodels conversion",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1382/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1382/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1379",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1379/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1379/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1379/events",
      "html_url": "https://github.com/apple/coremltools/issues/1379",
      "id": 1096061861,
      "node_id": "I_kwDOBba_B85BVJOl",
      "number": 1379,
      "title": "How to use \"Float32 compute precision\" in MLModel?",
      "user": {
        "login": "RahulBhalley",
        "id": 9640948,
        "node_id": "MDQ6VXNlcjk2NDA5NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9640948?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RahulBhalley",
        "html_url": "https://github.com/RahulBhalley",
        "followers_url": "https://api.github.com/users/RahulBhalley/followers",
        "following_url": "https://api.github.com/users/RahulBhalley/following{/other_user}",
        "gists_url": "https://api.github.com/users/RahulBhalley/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/RahulBhalley/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/RahulBhalley/subscriptions",
        "organizations_url": "https://api.github.com/users/RahulBhalley/orgs",
        "repos_url": "https://api.github.com/users/RahulBhalley/repos",
        "events_url": "https://api.github.com/users/RahulBhalley/events{/privacy}",
        "received_events_url": "https://api.github.com/users/RahulBhalley/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2022-01-07T07:31:53Z",
      "updated_at": "2022-03-17T21:45:05Z",
      "closed_at": "2022-03-17T21:45:05Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI understand that CoreML executes model with Float16 precision, which is great for speed and memory! But my model's generated image loses visual quality when running on Float16 precision when compared to Float32 precision using PyTorch. \r\n\r\nCould you please allow us to use Float32 precision for inference? That'd be really helpful. Looking towards a positive response.\r\n\r\n## System Information\r\nN/A\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1379/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1379/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1375",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1375/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1375/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1375/events",
      "html_url": "https://github.com/apple/coremltools/issues/1375",
      "id": 1087621717,
      "node_id": "I_kwDOBba_B85A08pV",
      "number": 1375,
      "title": "yolov5m run crash",
      "user": {
        "login": "spacegrass",
        "id": 3315048,
        "node_id": "MDQ6VXNlcjMzMTUwNDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3315048?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/spacegrass",
        "html_url": "https://github.com/spacegrass",
        "followers_url": "https://api.github.com/users/spacegrass/followers",
        "following_url": "https://api.github.com/users/spacegrass/following{/other_user}",
        "gists_url": "https://api.github.com/users/spacegrass/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/spacegrass/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/spacegrass/subscriptions",
        "organizations_url": "https://api.github.com/users/spacegrass/orgs",
        "repos_url": "https://api.github.com/users/spacegrass/repos",
        "events_url": "https://api.github.com/users/spacegrass/events{/privacy}",
        "received_events_url": "https://api.github.com/users/spacegrass/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-12-23T11:17:17Z",
      "updated_at": "2022-03-01T00:49:26Z",
      "closed_at": "2022-03-01T00:49:26Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "------------ the next are error message --------------\r\nMetal API Validation Enabled\r\n +[MTLIOAccelDevice registerDevices]: Zero Metal services found\r\n [espresso] [Espresso::handle_ex_plan] exception=ANECF error:\r\n[coreml] Error plan build: -1.\r\n\r\n----------\r\nOS: Mac OS 11\r\nmodel is yolov5m.onnx\r\nit is pretrained by yolov5 v4, the offical model 80-class\r\n\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1375/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1375/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1374",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1374/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1374/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1374/events",
      "html_url": "https://github.com/apple/coremltools/issues/1374",
      "id": 1086957428,
      "node_id": "I_kwDOBba_B85Ayad0",
      "number": 1374,
      "title": "Unable to register MIL op alias of `matmul` (named `my_matmul`) using pure NumPy",
      "user": {
        "login": "RahulBhalley",
        "id": 9640948,
        "node_id": "MDQ6VXNlcjk2NDA5NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9640948?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RahulBhalley",
        "html_url": "https://github.com/RahulBhalley",
        "followers_url": "https://api.github.com/users/RahulBhalley/followers",
        "following_url": "https://api.github.com/users/RahulBhalley/following{/other_user}",
        "gists_url": "https://api.github.com/users/RahulBhalley/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/RahulBhalley/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/RahulBhalley/subscriptions",
        "organizations_url": "https://api.github.com/users/RahulBhalley/orgs",
        "repos_url": "https://api.github.com/users/RahulBhalley/repos",
        "events_url": "https://api.github.com/users/RahulBhalley/events{/privacy}",
        "received_events_url": "https://api.github.com/users/RahulBhalley/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 23,
      "created_at": "2021-12-22T15:48:47Z",
      "updated_at": "2021-12-23T21:38:05Z",
      "closed_at": "2021-12-22T23:24:55Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI have to register `np.linalg.svd` function as MIL op so that I can use it to register it as PyTorch op using `@register_torch_op`. I am taking this approach because SVD is written in FORTAN under-the-hood (I think) in NumPy & I cannot translate it to MIL ops to register PyTorch op.\r\n\r\nSo, I am trying to write my own `mb.my_matmul` (alias of `mb.matmul`). Following this I will implement `mb.svd`. Here's what I do. \r\n\r\nLooking at the [coremltools](https://github.com/apple/coremltools) source code looks like MIL op (`mb.matmul`) is written using `np.matmul` itself.\r\nhttps://github.com/apple/coremltools/blob/534a5079d22e1320bcf5d42c1c0385f3f2330d4f/coremltools/converters/mil/mil/ops/defs/linear.py#L81\r\n\r\nIt's imported in [__init__.py](https://github.com/apple/coremltools/blob/main/coremltools/converters/mil/mil/ops/defs/__init__.py) file.\r\nhttps://github.com/apple/coremltools/blob/534a5079d22e1320bcf5d42c1c0385f3f2330d4f/coremltools/converters/mil/mil/ops/defs/__init__.py#L113\r\n\r\nThen it's exposed to nn builder using `@register_mil_to_nn_mapping`.\r\nhttps://github.com/apple/coremltools/blob/534a5079d22e1320bcf5d42c1c0385f3f2330d4f/coremltools/converters/mil/backend/nn/op_mapping.py#L1493\r\n\r\nSo I simply copy the body of both `class matmul(Operation):` and `def matmul(const_context, builder, op):` for `my_matmul` and I also import it in [__init__.py](https://github.com/apple/coremltools/blob/main/coremltools/converters/mil/mil/ops/defs/__init__.py). \r\n\r\nThen I uninstall coremltools and go the root directory of my own edited coremtools repository. In terminal I write the following code to use my custom `my_matmul` implementation but no luck .\r\n\r\n```python\r\nimport coremltools as ct\r\nfrom coremltools.converters.mil import Builder as mb\r\n\r\n@mb.program(input_specs=[mb.TensorSpec(shape=(1, 3, 32, 32))])\r\n  def model(input_data):\r\n    x = mb.my_matmul(x=input_data, y=input_data)\r\n    return x\r\n\r\ncoreml_model = ct.convert(model, inputs=[ct.TensorType(\"input\", shape=(1, 3, 32, 32))], convert_to=\"mlprogram\")\r\n```\r\n\r\nThe following error is thrown.\r\n\r\n```\r\nRunning MIL Common passes: 100%|| 34/34 [00:00<00:00, 3354.02 passes/s]\r\nRunning MIL FP16ComputePrecision pass: 100%|| 1/1 [00:00<00:00, 476.68 passes/s]\r\nRunning MIL Clean up passes: 100%|| 9/9 [00:00<00:00, 1965.47 passes/s]\r\n/Users/rahulbhalley/Desktop/coremltools/coremltools/models/model.py:121: RuntimeWarning: You will not be able to run predict() on this Core ML model. Underlying exception message was: Error compiling model: \"compiler error:  Encountered an error while compiling a neural network model: in operation of type my_matmul: Unknown operator 'my_matmul'.\".\r\n  _warnings.warn(\r\n```\r\n\r\nIt simply says, `\"compiler error:  Encountered an error while compiling a neural network model: in operation of type my_matmul: Unknown operator 'my_matmul'.\"`.\r\n\r\nI don't understand how to expose my NumPy operation to MIL builder (`mb.custom_function`). **Any help is highly appreciated!!**\r\n\r\n## System Information\r\n- N/A\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1374/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1374/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1371",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1371/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1371/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1371/events",
      "html_url": "https://github.com/apple/coremltools/issues/1371",
      "id": 1084438778,
      "node_id": "I_kwDOBba_B85Aozj6",
      "number": 1371,
      "title": "How to integrate my .coreml",
      "user": {
        "login": "FengMu1995",
        "id": 52693361,
        "node_id": "MDQ6VXNlcjUyNjkzMzYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/52693361?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/FengMu1995",
        "html_url": "https://github.com/FengMu1995",
        "followers_url": "https://api.github.com/users/FengMu1995/followers",
        "following_url": "https://api.github.com/users/FengMu1995/following{/other_user}",
        "gists_url": "https://api.github.com/users/FengMu1995/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/FengMu1995/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/FengMu1995/subscriptions",
        "organizations_url": "https://api.github.com/users/FengMu1995/orgs",
        "repos_url": "https://api.github.com/users/FengMu1995/repos",
        "events_url": "https://api.github.com/users/FengMu1995/events{/privacy}",
        "received_events_url": "https://api.github.com/users/FengMu1995/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-12-20T07:10:30Z",
      "updated_at": "2021-12-20T19:50:22Z",
      "closed_at": "2021-12-20T19:50:22Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\nI have my coreML model and have vadilated it on coreML-pythonAPI, Now, what should I do to integrate the coreML model with app, Any example?\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1371/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1371/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1370",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1370/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1370/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1370/events",
      "html_url": "https://github.com/apple/coremltools/issues/1370",
      "id": 1081822486,
      "node_id": "I_kwDOBba_B85Ae00W",
      "number": 1370,
      "title": "PyTorch convert function for op 'var' not implemented.",
      "user": {
        "login": "chinsyo",
        "id": 3993726,
        "node_id": "MDQ6VXNlcjM5OTM3MjY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3993726?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chinsyo",
        "html_url": "https://github.com/chinsyo",
        "followers_url": "https://api.github.com/users/chinsyo/followers",
        "following_url": "https://api.github.com/users/chinsyo/following{/other_user}",
        "gists_url": "https://api.github.com/users/chinsyo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/chinsyo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/chinsyo/subscriptions",
        "organizations_url": "https://api.github.com/users/chinsyo/orgs",
        "repos_url": "https://api.github.com/users/chinsyo/repos",
        "events_url": "https://api.github.com/users/chinsyo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/chinsyo/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        },
        {
          "id": 2870915972,
          "node_id": "MDU6TGFiZWwyODcwOTE1OTcy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/missing%20layer%20type",
          "name": "missing layer type",
          "color": "0052cc",
          "default": false,
          "description": "Unable to convert a layer type from the relevant framework"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-12-16T06:31:41Z",
      "updated_at": "2022-03-17T21:44:26Z",
      "closed_at": "2022-03-17T21:44:17Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\nPytorch has added `torch.var`, but if you try to convert such models to coreml, you get the error \"PyTorch convert function for op 'var' not implemented.\".\r\n\r\n## Use cases\r\n- convert [UGATIT-pytorch](https://github.com/znxlwm/UGATIT-pytorch)\r\n\r\n## Describe alternatives you've considered\r\ntorch.std() ** 2\r\n\r\n## Additional context\r\n- coremltools 5.1.0\r\n- pytorch 1.10.0",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1370/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1370/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1368",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1368/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1368/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1368/events",
      "html_url": "https://github.com/apple/coremltools/issues/1368",
      "id": 1080701169,
      "node_id": "I_kwDOBba_B85AajDx",
      "number": 1368,
      "title": "Does the conv3d layer support the GPU mode?",
      "user": {
        "login": "XianWu18",
        "id": 12014272,
        "node_id": "MDQ6VXNlcjEyMDE0Mjcy",
        "avatar_url": "https://avatars.githubusercontent.com/u/12014272?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/XianWu18",
        "html_url": "https://github.com/XianWu18",
        "followers_url": "https://api.github.com/users/XianWu18/followers",
        "following_url": "https://api.github.com/users/XianWu18/following{/other_user}",
        "gists_url": "https://api.github.com/users/XianWu18/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/XianWu18/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/XianWu18/subscriptions",
        "organizations_url": "https://api.github.com/users/XianWu18/orgs",
        "repos_url": "https://api.github.com/users/XianWu18/repos",
        "events_url": "https://api.github.com/users/XianWu18/events{/privacy}",
        "received_events_url": "https://api.github.com/users/XianWu18/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-12-15T07:59:27Z",
      "updated_at": "2021-12-16T02:53:21Z",
      "closed_at": "2021-12-15T21:53:21Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "A CoreML model with conv3d layers runs very slow on my mac. If I set usesCPUOnly to True, it will take about the same running time. So it seems that the conv3d layer only supports CPU mode in a CoreML. When I replace conv3d layers with conv2d layers, the model will be many times faster than before. The CoreML model I use is converted from a pytorch model.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1368/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1368/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1366",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1366/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1366/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1366/events",
      "html_url": "https://github.com/apple/coremltools/issues/1366",
      "id": 1079649423,
      "node_id": "I_kwDOBba_B85AWiSP",
      "number": 1366,
      "title": "[PyTorch] Best way to convert DCNv2 to CoreML?",
      "user": {
        "login": "JRGit4UE",
        "id": 7815524,
        "node_id": "MDQ6VXNlcjc4MTU1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7815524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JRGit4UE",
        "html_url": "https://github.com/JRGit4UE",
        "followers_url": "https://api.github.com/users/JRGit4UE/followers",
        "following_url": "https://api.github.com/users/JRGit4UE/following{/other_user}",
        "gists_url": "https://api.github.com/users/JRGit4UE/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/JRGit4UE/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/JRGit4UE/subscriptions",
        "organizations_url": "https://api.github.com/users/JRGit4UE/orgs",
        "repos_url": "https://api.github.com/users/JRGit4UE/repos",
        "events_url": "https://api.github.com/users/JRGit4UE/events{/privacy}",
        "received_events_url": "https://api.github.com/users/JRGit4UE/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 5,
      "created_at": "2021-12-14T11:36:06Z",
      "updated_at": "2022-03-17T21:43:13Z",
      "closed_at": "2022-03-17T21:43:13Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Suggested way to convert DCNv2 to CoreML?\r\nSince **TorchVision**'s implementation of **DCNv2** is different to **https://github.com/CharlesShang/DCNv2**,\r\nwhich I need for a model, the question is how to get CharlesShang/DCNv2 on iOS (macOS)?\r\n## System Information\r\n- Python 3.9\r\n- PyTorch 1.9.1\r\n- CoreMLTools 5.1\r\n\r\nI already have converted a Yolact++ model from PyTorch to TorchScript with exception of the DCNv2 part,\r\nwhich is a wrapper for C++ code. So in order to get CoreMLTools conversion done correctly, do I have to create a custom operator or - for simplicity - can I get away with a composite operator in order to get DCNv2 onto the macOS / iOS side?\r\nAs https://coremltools.readme.io/docs/custom-operators states:\r\n>A custom operator is not easy to implement. Use a custom operator only if you can't get the performance you want, and only as a last resort\r\n\r\nThanks in advance\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1366/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1366/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1363",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1363/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1363/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1363/events",
      "html_url": "https://github.com/apple/coremltools/issues/1363",
      "id": 1072786531,
      "node_id": "I_kwDOBba_B84_8Wxj",
      "number": 1363,
      "title": "\"PyTorch convert function for op '_convolution_mode' not implemented\"",
      "user": {
        "login": "lauriebyrum",
        "id": 4791172,
        "node_id": "MDQ6VXNlcjQ3OTExNzI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4791172?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lauriebyrum",
        "html_url": "https://github.com/lauriebyrum",
        "followers_url": "https://api.github.com/users/lauriebyrum/followers",
        "following_url": "https://api.github.com/users/lauriebyrum/following{/other_user}",
        "gists_url": "https://api.github.com/users/lauriebyrum/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lauriebyrum/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lauriebyrum/subscriptions",
        "organizations_url": "https://api.github.com/users/lauriebyrum/orgs",
        "repos_url": "https://api.github.com/users/lauriebyrum/repos",
        "events_url": "https://api.github.com/users/lauriebyrum/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lauriebyrum/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1564616954,
          "node_id": "MDU6TGFiZWwxNTY0NjE2OTU0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/triaged",
          "name": "triaged",
          "color": "27bbce",
          "default": false,
          "description": "Reviewed and examined, release as been assigned if applicable (status)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        },
        {
          "id": 2870915972,
          "node_id": "MDU6TGFiZWwyODcwOTE1OTcy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/missing%20layer%20type",
          "name": "missing layer type",
          "color": "0052cc",
          "default": false,
          "description": "Unable to convert a layer type from the relevant framework"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": {
        "login": "TobyRoseman",
        "id": 5420744,
        "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TobyRoseman",
        "html_url": "https://github.com/TobyRoseman",
        "followers_url": "https://api.github.com/users/TobyRoseman/followers",
        "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
        "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
        "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
        "repos_url": "https://api.github.com/users/TobyRoseman/repos",
        "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
        "type": "User",
        "site_admin": false
      },
      "assignees": [
        {
          "login": "TobyRoseman",
          "id": 5420744,
          "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TobyRoseman",
          "html_url": "https://github.com/TobyRoseman",
          "followers_url": "https://api.github.com/users/TobyRoseman/followers",
          "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
          "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
          "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
          "repos_url": "https://api.github.com/users/TobyRoseman/repos",
          "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
          "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
          "type": "User",
          "site_admin": false
        }
      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-12-07T00:46:41Z",
      "updated_at": "2021-12-14T22:33:18Z",
      "closed_at": "2021-12-14T22:33:18Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\nPytorch has added 'same' padding for convolutions, but if you try to convert such models to coreml, you get the error \"PyTorch convert function for op '_convolution_mode' not implemented\". \r\n\r\nThere is a workaround discussed in recent comments on https://github.com/pytorch/pytorch/issues/3867, but it would be great if we didn't have to change our model code for this, especially since tf->coreml supports this padding. ",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1363/reactions",
        "total_count": 2,
        "+1": 2,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1363/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1357",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1357/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1357/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1357/events",
      "html_url": "https://github.com/apple/coremltools/issues/1357",
      "id": 1064082985,
      "node_id": "I_kwDOBba_B84_bJ4p",
      "number": 1357,
      "title": "Got different result using AdaptiveInstanceNorm2d ",
      "user": {
        "login": "baaj2109",
        "id": 15242904,
        "node_id": "MDQ6VXNlcjE1MjQyOTA0",
        "avatar_url": "https://avatars.githubusercontent.com/u/15242904?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/baaj2109",
        "html_url": "https://github.com/baaj2109",
        "followers_url": "https://api.github.com/users/baaj2109/followers",
        "following_url": "https://api.github.com/users/baaj2109/following{/other_user}",
        "gists_url": "https://api.github.com/users/baaj2109/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/baaj2109/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/baaj2109/subscriptions",
        "organizations_url": "https://api.github.com/users/baaj2109/orgs",
        "repos_url": "https://api.github.com/users/baaj2109/repos",
        "events_url": "https://api.github.com/users/baaj2109/events{/privacy}",
        "received_events_url": "https://api.github.com/users/baaj2109/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-11-26T04:01:20Z",
      "updated_at": "2022-03-17T21:38:23Z",
      "closed_at": "2022-03-17T21:38:23Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nI want to use AdaptiveInstanceNorm2d layer to build my model, but when I convert my pytorch model to coreml model, AdaptiveInstanceNorm2d layer got different output than pytorch model\r\n\r\nto reproduce:\r\n```\r\nimport torch\r\nfrom torch import nn\r\nimport torch.nn.functional as F\r\nimport coremltools\r\n\r\nclass AdaptiveInstanceNorm2d(nn.Module):\r\n    def __init__(self, num_features, eps=1e-5, momentum=0.1):\r\n        super().__init__()\r\n        self.num_features = num_features\r\n        self.eps = eps\r\n        self.momentum = momentum\r\n        # weight and bias are dynamically assigned\r\n        self.weight = torch.rand(num_features)\r\n        self.bias = torch.rand(num_features)\r\n        # just dummy buffers, not used\r\n        self.register_buffer('running_mean', torch.zeros(num_features))\r\n        self.register_buffer('running_var', torch.ones(num_features))\r\n\r\n    def forward(self, x):\r\n        assert self.weight is not None and self.bias is not None, \"Please assign weight and bias before calling AdaIN!\"\r\n        b, c = x.size(0), x.size(1)\r\n        running_mean = self.running_mean.repeat(b).type_as(x)\r\n        running_var = self.running_var.repeat(b).type_as(x)\r\n\r\n        # Apply instance norm\r\n        x_reshaped = x.contiguous().view(1, b * c, *x.size()[2:])\r\n\r\n        out = F.batch_norm(\r\n            x_reshaped, running_mean, running_var, self.weight, self.bias,\r\n            True, self.momentum, self.eps)\r\n\r\n        return out.view(b, c, *x.size()[2:])\r\n\r\n    def __repr__(self):\r\n        return self.__class__.__name__ + '(' + str(self.num_features) + ')'\r\n\r\nclass TestModule(nn.Module):\r\n    def __init__(self):\r\n        super(TestModule, self).__init__()\r\n        self.norm = AdaptiveInstanceNorm2d(3)\r\n    def forward(self, x):\r\n        return self.norm(x)\r\nx = torch.rand(1,3,100,100)\r\ntest_module = TestModule()\r\npytorch_output = test_module(x).detach().numpy()\r\n\r\n\r\nfrom coremltools.converters.mil.mil import Builder as mb\r\nfrom coremltools.converters.mil.frontend.torch.torch_op_registry import register_torch_op\r\nfrom coremltools.converters.mil.frontend.torch.ops import _get_inputs\r\n@register_torch_op(override=True)\r\ndef type_as(context, node):\r\n    inputs = _get_inputs(context, node)\r\n    context.add(mb.cast(x=inputs[0], dtype='fp32'), node.name)\r\n\r\ntraced_test_module= torch.jit.trace(test_module, x)\r\ntest_module_mlmodel = coremltools.convert(\r\n    traced_test_module,\r\n    inputs = [ coremltools.TensorType(shape = x.shape) ],\r\n)\r\ninput_name = test_module_mlmodel._spec.description.input[0].name\r\noutput_name = test_module_mlmodel._spec.description.output[0].name\r\nmlmodel_output = test_module_mlmodel.predict({input_name: x.detach().numpy()})[output_name]\r\nimport numpy as np\r\nnp.testing.assert_array_almost_equal(mlmodel_output, pytorch_output, decimal= 3)\r\n```\r\n\r\n## System Information\r\n- torch: 1.9.1\r\n- coremltools: 4.1\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1357/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1357/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1354",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1354/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1354/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1354/events",
      "html_url": "https://github.com/apple/coremltools/issues/1354",
      "id": 1059903375,
      "node_id": "I_kwDOBba_B84_LNeP",
      "number": 1354,
      "title": "Is it possible to run CoreML models directly on GPU based MTLTexture objects?",
      "user": {
        "login": "hovnatan",
        "id": 8426582,
        "node_id": "MDQ6VXNlcjg0MjY1ODI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8426582?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hovnatan",
        "html_url": "https://github.com/hovnatan",
        "followers_url": "https://api.github.com/users/hovnatan/followers",
        "following_url": "https://api.github.com/users/hovnatan/following{/other_user}",
        "gists_url": "https://api.github.com/users/hovnatan/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hovnatan/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hovnatan/subscriptions",
        "organizations_url": "https://api.github.com/users/hovnatan/orgs",
        "repos_url": "https://api.github.com/users/hovnatan/repos",
        "events_url": "https://api.github.com/users/hovnatan/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hovnatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1722445778,
          "node_id": "MDU6TGFiZWwxNzIyNDQ1Nzc4",
          "url": "https://api.github.com/repos/apple/coremltools/labels/CoreML.Framework",
          "name": "CoreML.Framework",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-11-22T09:28:47Z",
      "updated_at": "2021-12-03T22:27:59Z",
      "closed_at": "2021-12-03T22:27:59Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "In Objective-C or Swift code is it possible to run CoreML models directly on GPU based `MTLTexture` objects? I know that it is possible to run CoreML models on `CGImage`, is it possible to create `CGImage` objects from `MTLTexture`? \r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1354/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1354/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1352",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1352/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1352/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1352/events",
      "html_url": "https://github.com/apple/coremltools/issues/1352",
      "id": 1058885997,
      "node_id": "I_kwDOBba_B84_HVFt",
      "number": 1352,
      "title": "AnimeGAN v2 performance, ML Program conversion and performance tuning",
      "user": {
        "login": "JacopoMangiavacchi",
        "id": 8699190,
        "node_id": "MDQ6VXNlcjg2OTkxOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8699190?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/JacopoMangiavacchi",
        "html_url": "https://github.com/JacopoMangiavacchi",
        "followers_url": "https://api.github.com/users/JacopoMangiavacchi/followers",
        "following_url": "https://api.github.com/users/JacopoMangiavacchi/following{/other_user}",
        "gists_url": "https://api.github.com/users/JacopoMangiavacchi/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/JacopoMangiavacchi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/JacopoMangiavacchi/subscriptions",
        "organizations_url": "https://api.github.com/users/JacopoMangiavacchi/orgs",
        "repos_url": "https://api.github.com/users/JacopoMangiavacchi/repos",
        "events_url": "https://api.github.com/users/JacopoMangiavacchi/events{/privacy}",
        "received_events_url": "https://api.github.com/users/JacopoMangiavacchi/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 6,
      "created_at": "2021-11-19T20:17:51Z",
      "updated_at": "2022-03-25T20:33:16Z",
      "closed_at": "2022-03-25T20:33:16Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I was able to convert the AnimeGANv2 model to CoreML and targeting NeuralNetwork I'm even having good performance on M1 hosts.\r\n\r\nAs I still have some performance issues using this CoreML model on A* devices for live videos I tried to convert the model to the new ML Program (target.iOS15) testing both with and without FP16ComputePrecision conversion.\r\n\r\nUnfortunately I found out that with ML Program I have even worst performance, also on M1.\r\n\r\nI wonder if you have any suggestions about how to instrument and tune performance of CoreML model in general.  My goal is to try to understand bottlenecks in the model layers/ops and eventually see how to change and optimize the model architecture for better CoreML performance.\r\n\r\nThank you very much for any suggestions.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1352/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1352/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1351",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1351/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1351/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1351/events",
      "html_url": "https://github.com/apple/coremltools/issues/1351",
      "id": 1058537429,
      "node_id": "I_kwDOBba_B84_F__V",
      "number": 1351,
      "title": "How to add parametric threshold value as an input argument to the coreml segmentation model ?",
      "user": {
        "login": "DenizDogan92",
        "id": 37620489,
        "node_id": "MDQ6VXNlcjM3NjIwNDg5",
        "avatar_url": "https://avatars.githubusercontent.com/u/37620489?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DenizDogan92",
        "html_url": "https://github.com/DenizDogan92",
        "followers_url": "https://api.github.com/users/DenizDogan92/followers",
        "following_url": "https://api.github.com/users/DenizDogan92/following{/other_user}",
        "gists_url": "https://api.github.com/users/DenizDogan92/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/DenizDogan92/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/DenizDogan92/subscriptions",
        "organizations_url": "https://api.github.com/users/DenizDogan92/orgs",
        "repos_url": "https://api.github.com/users/DenizDogan92/repos",
        "events_url": "https://api.github.com/users/DenizDogan92/events{/privacy}",
        "received_events_url": "https://api.github.com/users/DenizDogan92/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-11-19T13:36:07Z",
      "updated_at": "2021-11-22T11:57:29Z",
      "closed_at": "2021-11-22T11:57:07Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI would like to learn how I can add take the `confidence threshold` as an input argument for my coreml segmentation model so that I can configure it on real-time. There are some examples like [this](https://github.com/dbsystel/yolov5-coreml-tools/blob/main/src/coreml_export/main.py) which adds a `nonMaximumSuppression` model to the pipeline but it is only for the detection models.\r\n\r\nI can add a `NeuralNetworkBuilder` with `greater_than` layer as follows:\r\n\r\n```\r\nbuilder.add_greater_than(name=\"condition\",\r\n                         input_names=[\"value\"],\r\n                         output_name=\"value_gt\",\r\n                         alpha=0.5)\r\n```\r\n\r\nBut problem here is that threshold value `(alpha)` should be constant but I want it to make it configurable on real time\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1351/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1351/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1349",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1349/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1349/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1349/events",
      "html_url": "https://github.com/apple/coremltools/issues/1349",
      "id": 1056835390,
      "node_id": "I_kwDOBba_B84-_gc-",
      "number": 1349,
      "title": "Is it possible to use m1 GPU and ANE inside docker container on mac OS?",
      "user": {
        "login": "devalexqt",
        "id": 865007,
        "node_id": "MDQ6VXNlcjg2NTAwNw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/865007?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devalexqt",
        "html_url": "https://github.com/devalexqt",
        "followers_url": "https://api.github.com/users/devalexqt/followers",
        "following_url": "https://api.github.com/users/devalexqt/following{/other_user}",
        "gists_url": "https://api.github.com/users/devalexqt/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devalexqt/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devalexqt/subscriptions",
        "organizations_url": "https://api.github.com/users/devalexqt/orgs",
        "repos_url": "https://api.github.com/users/devalexqt/repos",
        "events_url": "https://api.github.com/users/devalexqt/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devalexqt/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-11-18T01:51:49Z",
      "updated_at": "2021-11-19T22:13:39Z",
      "closed_at": "2021-11-19T22:13:39Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Containers everywhere, so will be good to know how to access to the GPU and ANE inside docker for model inference.",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1349/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1349/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1346",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1346/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1346/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1346/events",
      "html_url": "https://github.com/apple/coremltools/issues/1346",
      "id": 1055545968,
      "node_id": "I_kwDOBba_B84-6lpw",
      "number": 1346,
      "title": "ExtractImagePatches with flexible input shapes",
      "user": {
        "login": "jwbates",
        "id": 55328378,
        "node_id": "MDQ6VXNlcjU1MzI4Mzc4",
        "avatar_url": "https://avatars.githubusercontent.com/u/55328378?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jwbates",
        "html_url": "https://github.com/jwbates",
        "followers_url": "https://api.github.com/users/jwbates/followers",
        "following_url": "https://api.github.com/users/jwbates/following{/other_user}",
        "gists_url": "https://api.github.com/users/jwbates/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jwbates/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jwbates/subscriptions",
        "organizations_url": "https://api.github.com/users/jwbates/orgs",
        "repos_url": "https://api.github.com/users/jwbates/repos",
        "events_url": "https://api.github.com/users/jwbates/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jwbates/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 5,
      "created_at": "2021-11-16T23:37:21Z",
      "updated_at": "2022-03-17T21:33:51Z",
      "closed_at": "2022-03-17T21:33:51Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I'm trying to convert a model which uses TensorFlow ExtractImagePatches on an arbitrarily sized image input.\r\n\r\nRunning:\r\n\r\n`of = ct.convert(lm, inputs=[ct.ImageType(shape=(1, ct.RangeDim(), ct.RangeDim(), 3))])`\r\n\r\nor\r\n\r\n`of = ct.convert(lm, inputs=[ct.ImageType(shape=(1, ct.RangeDim(256, 4096), ct.RangeDim(256, 4096), 3))])`\r\n\r\ngives:\r\n\r\n`Converting Frontend ==> MIL Ops:  54%|                                                       | 102/188 [00:00<00:00, 3947.18 ops/s]\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/_converters_entry.py\", line 326, in convert\r\n    mlmodel = mil_convert(\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 182, in mil_convert\r\n    return _mil_convert(model, convert_from, convert_to, ConverterRegistry, MLModel, compute_units, **kwargs)\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 209, in _mil_convert\r\n    proto, mil_program = mil_convert_to_proto(\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 300, in mil_convert_to_proto\r\n    prog = frontend_converter(model, **kwargs)\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 94, in __call__\r\n    return tf2_loader.load()\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/load.py\", line 83, in load\r\n    program = self._program_from_tf_ssa()\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow2/load.py\", line 175, in _program_from_tf_ssa\r\n    return converter.convert()\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/converter.py\", line 403, in convert\r\n    self.convert_main_graph(prog, graph)\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/converter.py\", line 332, in convert_main_graph\r\n    outputs = convert_graph(self.context, graph, self.outputs)\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/convert_utils.py\", line 191, in convert_graph\r\n    _add_op(context, node)\r\n  File \"/Users/jwbates/.virtualenvs/littlepopper/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/ops.py\", line 552, in ExtractImagePatches\r\n    h_index = list(range(0, h - sizes[1] + 1, strides[1]))\r\nTypeError: 'Add' object cannot be interpreted as an integer`\r\n\r\nwhile converting the same model via (e.g.):\r\n\r\n`of = ct.convert(lm, inputs=[ct.ImageType(shape=(1, 256, 256, 3))])`\r\n\r\ncompletes successfully. ",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1346/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1346/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1345",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1345/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1345/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1345/events",
      "html_url": "https://github.com/apple/coremltools/issues/1345",
      "id": 1055448277,
      "node_id": "I_kwDOBba_B84-6NzV",
      "number": 1345,
      "title": "flexible input",
      "user": {
        "login": "usmanqureshi94",
        "id": 82107583,
        "node_id": "MDQ6VXNlcjgyMTA3NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/82107583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/usmanqureshi94",
        "html_url": "https://github.com/usmanqureshi94",
        "followers_url": "https://api.github.com/users/usmanqureshi94/followers",
        "following_url": "https://api.github.com/users/usmanqureshi94/following{/other_user}",
        "gists_url": "https://api.github.com/users/usmanqureshi94/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/usmanqureshi94/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/usmanqureshi94/subscriptions",
        "organizations_url": "https://api.github.com/users/usmanqureshi94/orgs",
        "repos_url": "https://api.github.com/users/usmanqureshi94/repos",
        "events_url": "https://api.github.com/users/usmanqureshi94/events{/privacy}",
        "received_events_url": "https://api.github.com/users/usmanqureshi94/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2021-11-16T22:17:03Z",
      "updated_at": "2022-02-02T03:10:38Z",
      "closed_at": "2022-02-02T03:10:37Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I've using coreml for yolov5. Works fine with rectangular/square input sizes. I've tired a few different methods but none works with flexible image sizes. error I get is following\r\nRuntimeError: {\r\n    NSLocalizedDescription = \"Failed to evaluate model 0 in pipeline\";\r\n    NSUnderlyingError = \"Error Domain=com.apple.CoreML Code=1 \\\"Input image feature image does not match model description\\\" UserInfo={NSLocalizedDescription=Input image feature image does not match model description, NSUnderlyingError=0x7ff20b412f40 {Error Domain=com.apple.CoreML Code=0 \\\"Image size 12 x 12 not in allowed set of image sizes\\\" UserInfo={NSLocalizedDescription=Image size 12 x 12 not in allowed set of image sizes}}}\";\r\n\r\nspecs\r\n[name: \"image\"\r\ntype {\r\n  imageType {\r\n    width: 320\r\n    height: 320\r\n    colorSpace: RGB\r\n    imageSizeRange {\r\n      widthRange {\r\n        lowerBound: 1\r\n        upperBound: -1\r\n      }\r\n      heightRange {\r\n        lowerBound: 1\r\n        upperBound: -1\r\n      }\r\n    }\r\n  }\r\n}\r\n````\r\nfrom coremltools.models.neural_network import flexible_shape_utils\r\nimport coremltools\r\nimport coremltools as ct\r\nfrom coremltools.models.model import  MLModel\r\n\r\nspec = coremltools.utils.load_spec(\"coreml_models/yolov5-iOS.mlmodel\")\r\n\r\n# to update the shapes of the first input\r\ninput_name = spec.description.input[0].name\r\nprint(spec.description.input)\r\n\r\n# Range shapes and multi array inputs\r\n# -1 in upper bound represents \"infinity\"\r\n# image_sizes = [flexible_shape_utils.NeuralNetworkImageSize(192, 192)]\r\n# # image_sizes.append(flexible_shape_utils.NeuralNetworkImageSize(192, 320))\r\n# flexible_shape_utils.add_enumerated_image_sizes(spec, feature_name='image', sizes=image_sizes)\r\nsize_range = flexible_shape_utils.NeuralNetworkImageSizeRange()\r\nsize_range.add_height_range((1, -1))\r\nsize_range.add_width_range((1, -1))\r\nflexible_shape_utils.update_image_size_range(spec, feature_name='image', size_range=size_range)\r\nupdated = ct.models.MLModel(spec)\r\n\r\nprint(spec.description.input)\r\nupdated.save('multimodel.mlmodel')\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1345/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1345/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1343",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1343/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1343/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1343/events",
      "html_url": "https://github.com/apple/coremltools/issues/1343",
      "id": 1054340191,
      "node_id": "I_kwDOBba_B84-1_Rf",
      "number": 1343,
      "title": "How to check ANE utilization on mac OS?",
      "user": {
        "login": "devalexqt",
        "id": 865007,
        "node_id": "MDQ6VXNlcjg2NTAwNw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/865007?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devalexqt",
        "html_url": "https://github.com/devalexqt",
        "followers_url": "https://api.github.com/users/devalexqt/followers",
        "following_url": "https://api.github.com/users/devalexqt/following{/other_user}",
        "gists_url": "https://api.github.com/users/devalexqt/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devalexqt/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devalexqt/subscriptions",
        "organizations_url": "https://api.github.com/users/devalexqt/orgs",
        "repos_url": "https://api.github.com/users/devalexqt/repos",
        "events_url": "https://api.github.com/users/devalexqt/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devalexqt/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-11-16T01:40:31Z",
      "updated_at": "2021-11-17T13:24:34Z",
      "closed_at": "2021-11-17T13:24:34Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "How to monitor ANE usage on mac OS with M1 chip?\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1343/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1343/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1342",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1342/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1342/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1342/events",
      "html_url": "https://github.com/apple/coremltools/issues/1342",
      "id": 1053726806,
      "node_id": "I_kwDOBba_B84-zphW",
      "number": 1342,
      "title": "Support StyleGAN2 conversion by not requiring const weight in conv_transpose MIL op",
      "user": {
        "login": "kuprel",
        "id": 7465979,
        "node_id": "MDQ6VXNlcjc0NjU5Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7465979?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kuprel",
        "html_url": "https://github.com/kuprel",
        "followers_url": "https://api.github.com/users/kuprel/followers",
        "following_url": "https://api.github.com/users/kuprel/following{/other_user}",
        "gists_url": "https://api.github.com/users/kuprel/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/kuprel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kuprel/subscriptions",
        "organizations_url": "https://api.github.com/users/kuprel/orgs",
        "repos_url": "https://api.github.com/users/kuprel/repos",
        "events_url": "https://api.github.com/users/kuprel/events{/privacy}",
        "received_events_url": "https://api.github.com/users/kuprel/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-11-15T14:25:49Z",
      "updated_at": "2022-03-17T21:32:20Z",
      "closed_at": "2022-03-17T21:32:13Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "StyleGAN2 relies on `conv` and `conv_transpose` weights that are computed at runtime.  Currently the MIL op for `conv` does not require a const weight argument but `conv_transpose` does [1].  StyleGAN2 cannot be converted to CoreML until `conv_transpose` is also implemented without the `const` requirement for the `weight`.\r\n\r\n[1] https://apple.github.io/coremltools/source/coremltools.converters.mil.mil.ops.defs.html#module-coremltools.converters.mil.mil.ops.defs.conv",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1342/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1342/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1341",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1341/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1341/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1341/events",
      "html_url": "https://github.com/apple/coremltools/issues/1341",
      "id": 1052935850,
      "node_id": "I_kwDOBba_B84-woaq",
      "number": 1341,
      "title": "How to check if Apple Neural Engine is actually used on Mac OS M1 with python?",
      "user": {
        "login": "devalexqt",
        "id": 865007,
        "node_id": "MDQ6VXNlcjg2NTAwNw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/865007?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/devalexqt",
        "html_url": "https://github.com/devalexqt",
        "followers_url": "https://api.github.com/users/devalexqt/followers",
        "following_url": "https://api.github.com/users/devalexqt/following{/other_user}",
        "gists_url": "https://api.github.com/users/devalexqt/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/devalexqt/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/devalexqt/subscriptions",
        "organizations_url": "https://api.github.com/users/devalexqt/orgs",
        "repos_url": "https://api.github.com/users/devalexqt/repos",
        "events_url": "https://api.github.com/users/devalexqt/events{/privacy}",
        "received_events_url": "https://api.github.com/users/devalexqt/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        },
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-11-14T13:10:03Z",
      "updated_at": "2021-11-19T19:40:27Z",
      "closed_at": "2021-11-19T19:40:27Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "How to check if my model is actually used neural engine? I only see usage of GPU and CPU. And seting `compute_units` to `ct.ComputeUnit.ALL` or `ct.ComputeUnit.CPU_AND_GPU` has no differens in inference time.\r\nAnd looks like build in neural engine not used at all. \r\n\r\n\r\n## System Information\r\nsoftware is installed folowed instraction https://developer.apple.com/metal/tensorflow-plugin/\r\nMac nimi M1, Mac OS 12.0.1\r\nPython 3.9\r\ntensorflow 2.5\r\ntensorflow-metal 0.2.0",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1341/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1341/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1339",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1339/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1339/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1339/events",
      "html_url": "https://github.com/apple/coremltools/issues/1339",
      "id": 1052451442,
      "node_id": "I_kwDOBba_B84-uyJy",
      "number": 1339,
      "title": "How to correctly format BBox predictions to feed into the NMS layer?",
      "user": {
        "login": "rsomani95",
        "id": 17111474,
        "node_id": "MDQ6VXNlcjE3MTExNDc0",
        "avatar_url": "https://avatars.githubusercontent.com/u/17111474?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsomani95",
        "html_url": "https://github.com/rsomani95",
        "followers_url": "https://api.github.com/users/rsomani95/followers",
        "following_url": "https://api.github.com/users/rsomani95/following{/other_user}",
        "gists_url": "https://api.github.com/users/rsomani95/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rsomani95/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rsomani95/subscriptions",
        "organizations_url": "https://api.github.com/users/rsomani95/orgs",
        "repos_url": "https://api.github.com/users/rsomani95/repos",
        "events_url": "https://api.github.com/users/rsomani95/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rsomani95/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-11-12T22:26:52Z",
      "updated_at": "2022-01-09T00:40:37Z",
      "closed_at": "2021-11-19T10:43:48Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## How to correctly pass inputs to the NMS layer?\r\n\r\nHi, I'm having trouble getting correct outputs from the NMS layer in CoreML. I'm converting a [YOLOX](https://github.com/Megvii-BaseDetection/YOLOX/) model, and have been able to match CoreML <-> PyTorch outputs match until just before the NMS layer.\r\n\r\n## System Information\r\n```\r\ntorch        : 1.8.0\r\ntorchvision  : 0.9.0\r\ncoremltools  : 5.1.0\r\nnumpy        : 1.21.4\r\n\r\nmacOS 10.15.7\r\n```\r\n\r\n## Problem\r\n\r\nI have predictions from the bounding box head - a `8400 x 85` array where indices `[:, :4]` are the xyxy coordinates, `[:, 4:5]` is the `objectness` score and the `[:, 5:]` indices are the individual class scores (this is a COCO model, so there's 80 classes). These xyxy coords are absolute coordinates that range between 0-640, as the model takes `(640 x 640)` images as inputs\r\n\r\nI'm able to get correct outputs using `torchvision.ops.nms` but am unable to replicate the same with CoreML's NMS layer. I understand that torchvision's NMS takes boxes in `(x1, y1, x2, y2)` format whereas CoreML takes it in `(x-center, y-center, width, height)`, as per the [NonMaximumSuppression.proto](https://github.com/apple/coremltools/blob/5b68098dc03452741162f399e4337e67b7ede8d8/mlmodel/format/NonMaximumSuppression.proto#L119-L126) file.\r\n\r\nHere's the code that gives me the correct outputs with PyTorch:\r\n\r\n```python\r\n\r\nbbox_detections_raw_decoded  # (8400, 85) np.ndarray\r\n\r\ndef do_torchvision_nms(\r\n    bbox_detections_raw_decoded, thresh=0.7, iou_thresh=0.45\r\n):\r\n    \"\"\"\r\n    Takes boxes of `(N, 4+(num_classes+1)) where the coordinates are in xyxy format\r\n    and returns the postprocessed NMS output\r\n\r\n    Largely borrowed from https://github.com/Megvii-BaseDetection/YOLOX/blob/2c2dd1397ab090b553c6e6ecfca8184fe83800e1/yolox/utils/boxes.py#L32-L76\r\n    and modified to work with ~3D~ 2D tensors\r\n    \"\"\"\r\n    prediction = bbox_detections_raw_decoded\r\n    assert len(prediction.shape) == 2\r\n\r\n    box_corner = torch.zeros_like(prediction)\r\n    box_corner[:, 0] = prediction[:, 0] - prediction[:, 2] / 2\r\n    box_corner[:, 1] = prediction[:, 1] - prediction[:, 3] / 2\r\n    box_corner[:, 2] = prediction[:, 0] + prediction[:, 2] / 2\r\n    box_corner[:, 3] = prediction[:, 1] + prediction[:, 3] / 2\r\n    prediction[:, :4] = box_corner[:, :4]\r\n\r\n    image_pred = prediction\r\n    class_conf, class_pred = torch.max(image_pred[:, 5:], 1, keepdim=True)\r\n    conf_mask = image_pred[:, 4] * class_conf.squeeze() >= thresh#.squeeze()\r\n\r\n    # Detections ordered as (x1, y1, x2, y2, obj_conf, class_conf, class_pred)\r\n    detections = torch.cat((image_pred[:, :5], class_conf, class_pred.float()), 1)\r\n    detections = detections[conf_mask]\r\n\r\n    nms_out_index = torchvision.ops.nms(\r\n        detections[:, :4],\r\n        detections[:, 4] * detections[:, 5],\r\n        iou_thresh,\r\n    )\r\n    \r\n    detections = detections[nms_out_index]\r\n    return detections\r\n\r\n\r\ndo_torchvision_nms(torch.from_numpy(bbox_detections_raw_decoded))\r\n\r\n## => Output\r\n# tensor([[311.9062, 201.3438, 356.0938, 287.9062,   0.9932,   0.9360,   0.0000],\r\n#         [370.2969, 181.3438, 420.2031, 288.1562,   0.9648,   0.9297,   0.0000],\r\n#         [266.0156, 184.9375, 309.4844, 282.0625,   0.9619,   0.9204,   0.0000]])\r\n```\r\n\r\nAnd here's how I'm preparing the CoreML inputs to feed into the NMS layer\r\n\r\n```python\r\ndef conform_bbox_head_outputs_for_nms(\r\n    bbox_detections_raw_decoded,\r\n    input_shape_hw: Tuple[int, int] = (640, 640)\r\n) -> Tuple[Tensor, Tensor]:\r\n    \"\"\"\r\n    Takes decoded outputs from `YOLOXHead` and return `(class_scores, boxes_xywh)`\r\n    \r\n    `class_scores` are two numbers - the first is the confidence and the second\r\n    the class index\r\n\r\n    `boxes_xyxy` are normalised based on the provided `input_shape`\r\n    \"\"\"\r\n    assert len(bbox_detections_raw_decoded.shape) == 2\r\n\r\n    boxes        = bbox_detections_raw_decoded[:, :4]\r\n    objectness   = bbox_detections_raw_decoded[:, 4:5]\r\n    class_scores = objectness * bbox_detections_raw_decoded[:, 5:]\r\n\r\n    # Normalise box coordinates if input shape is given\r\n    h, w = input_shape_hw\r\n    boxes = boxes * torch.tensor([1./w, 1./h, 1./w, 1./h])\r\n\r\n    # Convert (x1,y1,x2,y2) to (cx,cy,w,h) for CoreML NMS\r\n    boxes_xywh = _box_xyxy_to_cxcywh(boxes)\r\n\r\n    return (class_scores, boxes_xywh)\r\n```\r\n\r\nIn the downstream NMS model (using `ct.proto.Model_pb2.Model()`), I'm using the same IoU threshold and confidence threshold as above, but get a much longer list of outputs with coordinates that are far from correct (after converting from `cx,cy,w,h` to `x,y,x,y`).\r\n\r\nDoes this look like the correct process to you guys? If not, I'd appreciate any pointers on what I may be doing wrong. I haven't shared the code for the downstream NMS as it's fairly conventional and I thought that this is where the main issue lies (also to make this issue more concise to begin with). If it's useful, I can provide the code, data and mlmodels I'm using as well.\r\n\r\nThanks for your time and help!",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1339/reactions",
        "total_count": 1,
        "+1": 1,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1339/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1337",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1337/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1337/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1337/events",
      "html_url": "https://github.com/apple/coremltools/issues/1337",
      "id": 1051558794,
      "node_id": "I_kwDOBba_B84-rYOK",
      "number": 1337,
      "title": "Inference precision of ANE on A13 SoC",
      "user": {
        "login": "LitleCarl",
        "id": 8946363,
        "node_id": "MDQ6VXNlcjg5NDYzNjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8946363?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LitleCarl",
        "html_url": "https://github.com/LitleCarl",
        "followers_url": "https://api.github.com/users/LitleCarl/followers",
        "following_url": "https://api.github.com/users/LitleCarl/following{/other_user}",
        "gists_url": "https://api.github.com/users/LitleCarl/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/LitleCarl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/LitleCarl/subscriptions",
        "organizations_url": "https://api.github.com/users/LitleCarl/orgs",
        "repos_url": "https://api.github.com/users/LitleCarl/repos",
        "events_url": "https://api.github.com/users/LitleCarl/events{/privacy}",
        "received_events_url": "https://api.github.com/users/LitleCarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-11-12T03:53:47Z",
      "updated_at": "2021-11-13T13:45:31Z",
      "closed_at": "2021-11-12T20:19:58Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nWe do super-resolution task on CoreML(Particularly on ANE of A12A13A14 ) .\r\nIt's very obvious that the output image is in lower precision on   A13 compared with A12 & A14.\r\n\r\nWe can see the artifact on the second image which is the output of the same model run on A13.\r\nDoes it mean that there is likely a Int8 Quantization runtime inside this A13 ANE but not in FP16 precision?\r\nBTW, when we switch to CPUOnly or CPU&GPU mode, the precision is in normal again, so we can ensure this have to do only with the ANE backend.\r\n\r\nIt's important for developers who want to run vision tasks(where precision is critically important) on CoreML. Is there any advice for developers to improve results on A13 chips (iPhone 11 series)?\r\n\r\n\r\n![A12 A14](https://user-images.githubusercontent.com/8946363/141405971-14870f4e-6236-4a70-8c7c-110e670bf5ce.png)\r\n![A13](https://user-images.githubusercontent.com/8946363/141405979-31ef881a-0ed9-4e96-81fe-bf302b04f50a.png)\r\n\r\n\r\n## System Information\r\n- If applicable\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1337/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1337/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1330",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1330/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1330/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1330/events",
      "html_url": "https://github.com/apple/coremltools/issues/1330",
      "id": 1040414324,
      "node_id": "I_kwDOBba_B84-A3Z0",
      "number": 1330,
      "title": "generic_reshape_kernel: Invalid bottom shape (...) for reshape to (...)",
      "user": {
        "login": "UrskaJ",
        "id": 62608018,
        "node_id": "MDQ6VXNlcjYyNjA4MDE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62608018?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/UrskaJ",
        "html_url": "https://github.com/UrskaJ",
        "followers_url": "https://api.github.com/users/UrskaJ/followers",
        "following_url": "https://api.github.com/users/UrskaJ/following{/other_user}",
        "gists_url": "https://api.github.com/users/UrskaJ/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/UrskaJ/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/UrskaJ/subscriptions",
        "organizations_url": "https://api.github.com/users/UrskaJ/orgs",
        "repos_url": "https://api.github.com/users/UrskaJ/repos",
        "events_url": "https://api.github.com/users/UrskaJ/events{/privacy}",
        "received_events_url": "https://api.github.com/users/UrskaJ/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 15,
      "created_at": "2021-10-31T09:01:07Z",
      "updated_at": "2022-03-31T14:40:21Z",
      "closed_at": "2022-03-25T20:24:59Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I am converting this model:\r\nhttps://github.com/researchmm/STTN\r\nusing coremltools==5.0b3\r\n\r\nthis is the conversion code snippet:\r\n`example_input = (torch.ones(1, 1, 3, 240, 432), torch.ones(1, 1, 1, 240, 432))\r\ntraced_model = torch.jit.trace(model, example_input)\r\n\r\nwith torch.no_grad():\r\n    mlmodel = ct.convert(\r\n       traced_model,\r\n       inputs=[ct.TensorType(name=\"img\", shape=(1, 1, 3, 240, 432)), ct.TensorType(name=\"msk\", shape=(1, 1, 1, 240, 432))],\r\n       minimum_deployment_target=ct.target.iOS14,\r\n       source=\"pytorch\"\r\n    )\r\n`\r\nand it works. However, if i increase the second dimension (essentially having more than 1 frame per video) i get the reshape error. The shapes are fine when i run it in pytorch, so technically it is all fine. When it gets converted though, it reports an error. Is it possible that this is a bug with conversion?",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1330/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1330/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1327",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1327/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1327/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1327/events",
      "html_url": "https://github.com/apple/coremltools/issues/1327",
      "id": 1036740454,
      "node_id": "I_kwDOBba_B849y2dm",
      "number": 1327,
      "title": "RuntimeError: PyTorch convert function for op 'feature_dropout_' not implemented.",
      "user": {
        "login": "duprijil",
        "id": 29858835,
        "node_id": "MDQ6VXNlcjI5ODU4ODM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/29858835?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/duprijil",
        "html_url": "https://github.com/duprijil",
        "followers_url": "https://api.github.com/users/duprijil/followers",
        "following_url": "https://api.github.com/users/duprijil/following{/other_user}",
        "gists_url": "https://api.github.com/users/duprijil/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/duprijil/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/duprijil/subscriptions",
        "organizations_url": "https://api.github.com/users/duprijil/orgs",
        "repos_url": "https://api.github.com/users/duprijil/repos",
        "events_url": "https://api.github.com/users/duprijil/events{/privacy}",
        "received_events_url": "https://api.github.com/users/duprijil/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        },
        {
          "id": 2870915972,
          "node_id": "MDU6TGFiZWwyODcwOTE1OTcy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/missing%20layer%20type",
          "name": "missing layer type",
          "color": "0052cc",
          "default": false,
          "description": "Unable to convert a layer type from the relevant framework"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": {
        "login": "TobyRoseman",
        "id": 5420744,
        "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TobyRoseman",
        "html_url": "https://github.com/TobyRoseman",
        "followers_url": "https://api.github.com/users/TobyRoseman/followers",
        "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
        "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
        "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
        "repos_url": "https://api.github.com/users/TobyRoseman/repos",
        "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
        "type": "User",
        "site_admin": false
      },
      "assignees": [
        {
          "login": "TobyRoseman",
          "id": 5420744,
          "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TobyRoseman",
          "html_url": "https://github.com/TobyRoseman",
          "followers_url": "https://api.github.com/users/TobyRoseman/followers",
          "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
          "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
          "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
          "repos_url": "https://api.github.com/users/TobyRoseman/repos",
          "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
          "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
          "type": "User",
          "site_admin": false
        }
      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-10-26T21:05:49Z",
      "updated_at": "2021-11-10T00:06:54Z",
      "closed_at": "2021-11-10T00:06:53Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nI try to convert the model from pytorch to coreml, but I get the error. \r\n## System Information\r\nmacOS 11.4\r\nPython 3.8.10\r\n\r\npytorch==1.8.0\r\ncoremltools==5.0\r\n\r\n### Code\r\n```python\r\nimport torch\r\nimport coremltools as ct\r\n\r\ntorch_model = torch.load('best_model.pth')\r\ntorch_model.eval()\r\n\r\nexample_input = torch.rand(1, 3, 256, 256) \r\ntraced_model = torch.jit.trace(torch_model, example_input)\r\nout = traced_model(example_input)\r\n\r\nmodel = ct.convert(traced_model,inputs=[ct.TensorType(shape=example_input.shape)])\r\n```\r\n\r\n\r\n### [Model](https://github.com/qubvel/segmentation_models.pytorch)\r\n```\r\n=========================================================================================================\r\nLayer (type:depth-idx)                                  Output Shape              Param #\r\n=========================================================================================================\r\nFPN                                                     --                        --\r\nFPNDecoder: 1                                         --                        --\r\n    ModuleList: 2-1                                  --                        --\r\nMobileNetV3Encoder: 1-1                               [1, 3, 256, 256]          --\r\n    MobileNetV3Features: 2                           --                        --\r\n        Conv2dSame: 3-1                             [1, 16, 128, 128]         432\r\n        BatchNorm2d: 3-2                            [1, 16, 128, 128]         32\r\n        Hardswish: 3-3                              [1, 16, 128, 128]         --\r\nFPNDecoder: 1-2                                       [1, 128, 64, 64]          --\r\n    Conv2d: 2-2                                      [1, 256, 8, 8]            147,712\r\n    FPNBlock: 2-3                                    [1, 256, 16, 16]          --\r\n        Conv2d: 3-4                                 [1, 256, 16, 16]          12,544\r\n    FPNBlock: 2-4                                    [1, 256, 32, 32]          --\r\n        Conv2d: 3-5                                 [1, 256, 32, 32]          6,400\r\n    FPNBlock: 2-5                                    [1, 256, 64, 64]          --\r\n        Conv2d: 3-6                                 [1, 256, 64, 64]          4,352\r\n    ModuleList: 2-1                                  --                        --\r\n        SegmentationBlock: 3-7                      [1, 128, 64, 64]          590,592\r\n        SegmentationBlock: 3-8                      [1, 128, 64, 64]          442,880\r\n        SegmentationBlock: 3-9                      [1, 128, 64, 64]          295,168\r\n        SegmentationBlock: 3-10                     [1, 128, 64, 64]          295,168\r\n    MergeBlock: 2-6                                  [1, 128, 64, 64]          --\r\n    Dropout2d: 2-7                                   [1, 128, 64, 64]          --\r\nSegmentationHead: 1-3                                 [1, 1, 256, 256]          --\r\n    Conv2d: 2-8                                      [1, 1, 64, 64]            129\r\n    UpsamplingBilinear2d: 2-9                        [1, 1, 256, 256]          --\r\n    Activation: 2-10                                 [1, 1, 256, 256]          --\r\n        Sigmoid: 3-11                               [1, 1, 256, 256]          --\r\n=========================================================================================================\r\nTotal params: 2,721,953\r\nTrainable params: 2,721,953\r\nNon-trainable params: 0\r\nTotal mult-adds (G): 2.05\r\n=========================================================================================================\r\nInput size (MB): 0.79\r\nForward/backward pass size (MB): 56.58\r\nParams size (MB): 10.89\r\nEstimated Total Size (MB): 68.25\r\n=========================================================================================================\r\n```\r\n\r\n### Output\r\n```\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/timm/models/layers/padding.py:19: TracerWarning: Converting a tensor to a Python float might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\r\n  return max((math.ceil(x / s) - 1) * s + (k - 1) * d + 1 - x, 0)\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/timm/models/layers/padding.py:19: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\r\n  return max((math.ceil(x / s) - 1) * s + (k - 1) * d + 1 - x, 0)\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/timm/models/layers/padding.py:31: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\r\n  if pad_h > 0 or pad_w > 0:\r\nConverting Frontend ==> MIL Ops:   0%|          | 0/704 [00:00<?, ? ops/s]WARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nConverting Frontend ==> MIL Ops:   8%|         | 53/704 [00:00<00:01, 529.40 ops/s]WARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nWARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nWARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nConverting Frontend ==> MIL Ops:  21%|        | 146/704 [00:00<00:01, 335.62 ops/s]WARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nWARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nConverting Frontend ==> MIL Ops:  31%|       | 215/704 [00:00<00:01, 302.00 ops/s]WARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nWARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nConverting Frontend ==> MIL Ops:  65%|   | 459/704 [00:01<00:00, 347.65 ops/s]WARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nWARNING:root:Saving value type of float64 into a builtin type of fp32, might lose precision!\r\nConverting Frontend ==> MIL Ops:  98%|| 689/704 [00:02<00:00, 245.47 ops/s]\r\n```\r\n\r\n### Traceback\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n/var/folders/4s/57xbj5210h5gyblwlr_ld1h80000gn/T/ipykernel_1333/1171219983.py in <module>\r\n     14 \r\n     15 \r\n---> 16 model = ct.convert(traced_model,inputs=[ct.TensorType(shape=example_input.shape)])\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/_converters_entry.py in convert(model, source, inputs, outputs, classifier_config, minimum_deployment_target, convert_to, compute_precision, skip_model_load, compute_units, **kwargs)\r\n    304         raise ValueError(\"Invalid value of the argument 'compute_precision'\")\r\n    305 \r\n--> 306     mlmodel = mil_convert(\r\n    307         model,\r\n    308         convert_from=exact_source,\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in mil_convert(model, convert_from, convert_to, compute_units, **kwargs)\r\n    173         See `coremltools.converters.convert`\r\n    174     \"\"\"\r\n--> 175     return _mil_convert(model, convert_from, convert_to, ConverterRegistry, MLModel, compute_units, **kwargs)\r\n    176 \r\n    177 \r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in _mil_convert(model, convert_from, convert_to, registry, modelClass, compute_units, **kwargs)\r\n    200         _os.chmod(weights_dir, _stat.S_IRWXU | _stat.S_IRWXG | _stat.S_IRWXO)\r\n    201 \r\n--> 202     proto, mil_program = mil_convert_to_proto(\r\n    203                             model,\r\n    204                             convert_from,\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in mil_convert_to_proto(model, convert_from, convert_to, converter_registry, **kwargs)\r\n    291     frontend_converter = frontend_converter_type()\r\n    292 \r\n--> 293     prog = frontend_converter(model, **kwargs)\r\n    294 \r\n    295     if convert_to.lower() != \"neuralnetwork\":\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in __call__(self, *args, **kwargs)\r\n    101         from .frontend.torch import load\r\n    102 \r\n--> 103         return load(*args, **kwargs)\r\n    104 \r\n    105 \r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/load.py in load(model_spec, debug, **kwargs)\r\n     78             print(\"the following model ops are MISSING:\")\r\n     79             print(\"\\n\".join([\"  \" + str(x) for x in sorted(missing)]))\r\n---> 80         raise e\r\n     81     except Exception as e:\r\n     82         raise e\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/load.py in load(model_spec, debug, **kwargs)\r\n     70 \r\n     71     try:\r\n---> 72         prog = converter.convert()\r\n     73     except RuntimeError as e:\r\n     74         if debug and \"convert function\" in str(e):\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/converter.py in convert(self)\r\n    228 \r\n    229             # Add the rest of the operations\r\n--> 230             convert_nodes(self.context, self.graph)\r\n    231 \r\n    232             graph_outputs = [self.context[name] for name in self.graph.outputs]\r\n\r\n/Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/ops.py in convert_nodes(context, graph)\r\n     64         _logging.info(\"Converting op {} : {}\".format(node.name, node.kind))\r\n     65         if _add_op is None:\r\n---> 66             raise RuntimeError(\r\n     67                 \"PyTorch convert function for op '{}' not implemented.\".format(node.kind)\r\n     68             )\r\n\r\nRuntimeError: PyTorch convert function for op 'feature_dropout_' not implemented.\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1327/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1327/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1323",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1323/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1323/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1323/events",
      "html_url": "https://github.com/apple/coremltools/issues/1323",
      "id": 1031844209,
      "node_id": "I_kwDOBba_B849gLFx",
      "number": 1323,
      "title": "Pytorch to mlpackage conversions fails",
      "user": {
        "login": "yousifa",
        "id": 6870090,
        "node_id": "MDQ6VXNlcjY4NzAwOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6870090?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yousifa",
        "html_url": "https://github.com/yousifa",
        "followers_url": "https://api.github.com/users/yousifa/followers",
        "following_url": "https://api.github.com/users/yousifa/following{/other_user}",
        "gists_url": "https://api.github.com/users/yousifa/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/yousifa/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yousifa/subscriptions",
        "organizations_url": "https://api.github.com/users/yousifa/orgs",
        "repos_url": "https://api.github.com/users/yousifa/repos",
        "events_url": "https://api.github.com/users/yousifa/events{/privacy}",
        "received_events_url": "https://api.github.com/users/yousifa/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 5,
      "created_at": "2021-10-20T21:26:33Z",
      "updated_at": "2021-10-20T22:08:29Z",
      "closed_at": "2021-10-20T22:07:40Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Describe the bug\r\nAny model does not convert from Pytorch to mlpgrogram/mlpackage using coremltools 5.0 with iOS15 target\r\n\r\n## Trace\r\n```\r\npython3.8/site-packages/coremltools/models/model.py:121: RuntimeWarning: You will not be able to run predict() on this Core ML model. Underlying exception message was: Error compiling model: \"Error reading protobuf spec. validator error: Model specification version field missing or corrupt.\".\r\n  _warnings.warn(\r\n```\r\n\r\n## To Reproduce\r\n- If a python script can reproduce the error, please paste the code snippet\r\n```\r\nimport torch\r\nimport numpy as np\r\nimport coremltools as ct\r\n\r\n\r\nclass Simple(torch.nn.Module):\r\n    def __init__(self):\r\n        super(Simple, self).__init__()\r\n\r\n    def forward(self, x):\r\n        x = torch.nn.functional.relu(x)\r\n        return x\r\n\r\ns = Simple()\r\nx = torch.randn(1, 1)\r\nout = s(x)\r\n\r\nargs = (x)\r\ntraced_model = torch.jit.trace(s, args)\r\n\r\nmodel = ct.convert(traced_model, inputs=[ct.TensorType(shape=x.shape)], convert_to=\"mlprogram\", \r\n    minimum_deployment_target=ct.target.iOS15, verbose=True)\r\n\r\nmodel.save(\"simple.mlpackage\")\r\n```\r\n\r\n## System environment (please complete the following information):\r\n - coremltools version  (e.g., 3.0b5): 5.0\r\n - OS (e.g., MacOS, Linux): MacOS\r\n - macOS version (if applicable): 11.2\r\n - XCode version (if applicable): 12.5 & 13.0\r\n - How you install python (anaconda, virtualenv, system): anaconda\r\n - python version (e.g. 3.7): 3.8\r\n - any other relevant information:\r\n     - pytorch 1.8.1\r\n\r\n## Additional context\r\nAdd any other context about the problem here.\r\n\r\nWhen trying to run manually compiled model in xcode 13, I receive the following error:\r\n```\r\n.../coremldata.bin is neither compiled .MLModelC nor encrypted .MLModelc, first word=502: unspecified iostream_category error\r\n```",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1323/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1323/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1322",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1322/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1322/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1322/events",
      "html_url": "https://github.com/apple/coremltools/issues/1322",
      "id": 1031245481,
      "node_id": "I_kwDOBba_B849d46p",
      "number": 1322,
      "title": "Detectron2 to CoreML conversion fails",
      "user": {
        "login": "DenizDogan92",
        "id": 37620489,
        "node_id": "MDQ6VXNlcjM3NjIwNDg5",
        "avatar_url": "https://avatars.githubusercontent.com/u/37620489?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DenizDogan92",
        "html_url": "https://github.com/DenizDogan92",
        "followers_url": "https://api.github.com/users/DenizDogan92/followers",
        "following_url": "https://api.github.com/users/DenizDogan92/following{/other_user}",
        "gists_url": "https://api.github.com/users/DenizDogan92/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/DenizDogan92/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/DenizDogan92/subscriptions",
        "organizations_url": "https://api.github.com/users/DenizDogan92/orgs",
        "repos_url": "https://api.github.com/users/DenizDogan92/repos",
        "events_url": "https://api.github.com/users/DenizDogan92/events{/privacy}",
        "received_events_url": "https://api.github.com/users/DenizDogan92/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-10-20T10:30:50Z",
      "updated_at": "2022-03-17T21:26:05Z",
      "closed_at": "2022-03-17T21:26:05Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Detectron2 to CoreML Conversion Failed\r\n\r\nI trained an image segmentation network with Detectron2 framework using mask_rcnn_R_50_FPN_3x model and saved the output model in .pth format. I now would like to convert it to a CoreML format but I am getting the following error:\r\n\r\n>   File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/_converters_entry.py\", line 306, in convert\r\n    mlmodel = mil_convert(\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 175, in mil_convert\r\n    return _mil_convert(model, convert_from, convert_to, ConverterRegistry, MLModel, compute_units, **kwargs)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 202, in _mil_convert\r\n    proto, mil_program = mil_convert_to_proto(\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 293, in mil_convert_to_proto\r\n    prog = frontend_converter(model, **kwargs)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 103, in __call__\r\n    return load(*args, **kwargs)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/frontend/torch/load.py\", line 82, in load\r\n    raise e\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/frontend/torch/load.py\", line 72, in load\r\n    prog = converter.convert()\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/frontend/torch/converter.py\", line 230, in convert\r\n    convert_nodes(self.context, self.graph)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/frontend/torch/ops.py\", line 70, in convert_nodes\r\n    _add_op(context, node)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/frontend/torch/ops.py\", line 3242, in arange\r\n    res = mb.range_1d(start=start, end=end, step=step, name=node.name)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/mil/ops/registry.py\", line 61, in add_op\r\n    return cls._add_op(op_cls, **kwargs)\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/mil/builder.py\", line 182, in _add_op\r\n    new_op.type_value_inference()\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/mil/operation.py\", line 239, in type_value_inference\r\n    output_types = self.type_inference()\r\n  File \"/opt/miniconda3/envs/ai_env/lib/python3.9/site-packages/coremltools/converters/mil/mil/ops/defs/tensor_operation.py\", line 561, in type_inference\r\n    raise TypeError(\r\nTypeError: All inputs to the range operation must have same input types.\r\n\r\nHere is the sample code snippets to reproduce the error:\r\n\r\n```\r\nfrom detectron2.config import get_cfg\r\nfrom detectron2.export.flatten import TracingAdapter\r\nfrom detectron2.modeling import build_model\r\nimport torch\r\n\r\ndef inference(model, image):\r\n    inputs = [{\"image\": image}]\r\n    output = model.inference(inputs, do_postprocess=False)[0]\r\n    return output\r\n\r\nmodelFile = \"...\" # torch model file, generated by detectron2 framework \r\ninputTensor = torch.rand(inputShape) #I use inputShape as (3,1024,768)\r\n\r\nconfig = get_cfg()\r\nconfig.MODEL.WEIGHTS = modelFile\r\nconfig.MODEL.ROI_HEADS.SCORE_THRESH_TEST = 0.7 \r\nconfig.MODEL.DEVICE = \"cpu\"\r\n\r\nmodel = build_model(config).eval()\r\ntraceableModel = TracingAdapter(model, inputTensor, inference)\r\ntrace = torch.jit.trace(traceableModel, traceableModel.flattened_inputs)\r\n\r\nmlmodel = ct.convert(trace, inputs=[ct.ImageType(shape=inputTensor.shape, scale=2.0/255.0, bias=[-1, -1, -1])]) # Error in this line\r\n```\r\n\r\n## System Information\r\nThe library versions:\r\n- detectron2 - 0.5\r\n- pytorch - 1.9.1\r\n- coremltools - 5.0",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1322/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1322/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1319",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1319/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1319/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1319/events",
      "html_url": "https://github.com/apple/coremltools/issues/1319",
      "id": 1028069689,
      "node_id": "I_kwDOBba_B849Rxk5",
      "number": 1319,
      "title": "Model immediately crashes iOS 15 but not iOS 14",
      "user": {
        "login": "teaglin",
        "id": 5282437,
        "node_id": "MDQ6VXNlcjUyODI0Mzc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5282437?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/teaglin",
        "html_url": "https://github.com/teaglin",
        "followers_url": "https://api.github.com/users/teaglin/followers",
        "following_url": "https://api.github.com/users/teaglin/following{/other_user}",
        "gists_url": "https://api.github.com/users/teaglin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/teaglin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/teaglin/subscriptions",
        "organizations_url": "https://api.github.com/users/teaglin/orgs",
        "repos_url": "https://api.github.com/users/teaglin/repos",
        "events_url": "https://api.github.com/users/teaglin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/teaglin/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1722445778,
          "node_id": "MDU6TGFiZWwxNzIyNDQ1Nzc4",
          "url": "https://api.github.com/repos/apple/coremltools/labels/CoreML.Framework",
          "name": "CoreML.Framework",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 5,
      "created_at": "2021-10-16T15:03:29Z",
      "updated_at": "2021-11-29T12:26:42Z",
      "closed_at": "2021-10-18T18:30:43Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "We have a temporal convolution model that weve been using for 6+ months. Its been working great on iOS 14. \r\n\r\nThe model was built using tensorflow/keras. \r\n\r\nOn iOS 15 the model immediately crashes. Disabling allowLowPrecisionAccumulationOnGPU  seems to alleviate the crashing in 95% of cases. \r\n\r\nBut this seems like a serious issue. That this one options causes such a high frequency of crashing. I included crash log. \r\n\r\nCrashed: com.apple.CoreMLBatchProcessingQueue\r\nEXC_BAD_ACCESS KERN_INVALID_ADDRESS 0x00000001258e8000\r\n\r\n\r\nCrashed: com.apple.CoreMLBatchProcessingQueue\r\n0  libBNNS.dylib                  0x57000c BNNSClearNetwork + 51244\r\n1  libBNNS.dylib                  0x56c808 BNNSClearNetwork + 36904\r\n2  libBNNS.dylib                  0x56c410 BNNSClearNetwork + 35888\r\n3  libBNNS.dylib                  0x15940 BNNSFilterCreateLayerConvolution + 9396\r\n4  libBNNS.dylib                  0x7e40 BNNSFilterApplyBatch + 19700\r\n5  libBNNS.dylib                  0xa98c BNNSFilterApplyBatch + 30784\r\n6  Espresso                       0x20fa0 Espresso::BNNSEngine::inner_product_kernel::__launch_non_quantized(std::__1::shared_ptr<Espresso::abstract_batch> const&, Espresso::layer_data, Espresso::layer_data, unsigned long, unsigned long, unsigned long) + 5744\r\n7  Espresso                       0x1e940 Espresso::BNNSEngine::inner_product_kernel::__launch(std::__1::shared_ptr<Espresso::abstract_batch> const&, Espresso::layer_data&, Espresso::layer_data&) + 2780\r\n8  Espresso                       0x19440 Espresso::layer::__launch(std::__1::shared_ptr<Espresso::abstract_batch> const&) + 88\r\n9  Espresso                       0x7848 Espresso::layer::__launch(std::__1::shared_ptr<Espresso::abstract_batch> const&, unsigned long) + 172\r\n10 Espresso                       0x440ec Espresso::net::__forward(std::__1::shared_ptr<Espresso::abstract_batch> const&, int, int) + 508\r\n11 Espresso                       0x316c EspressoLight::espresso_plan::dispatch_task_on_compute_batch(std::__1::shared_ptr<Espresso::abstract_batch> const&, std::__1::shared_ptr<EspressoLight::plan_task_t> const&) + 704\r\n12 Espresso                       0xabf0 EspressoLight::espresso_plan::execute_sync() + 412\r\n13 Espresso                       0x3350 espresso_plan_execute_sync + 132\r\n14 CoreML                         0xccac -[MLNeuralNetworkEngine executePlan:error:] + 136\r\n15 CoreML                         0xc1d8 -[MLNeuralNetworkEngine evaluateInputs:bufferIndex:options:error:] + 656\r\n16 CoreML                         0x117b8 __54-[MLNeuralNetworkEngine evaluateInputs:options:error:]_block_invoke + 44\r\n17 libdispatch.dylib              0x3950 _dispatch_client_callout + 20\r\n18 libdispatch.dylib              0x12a70 _dispatch_lane_barrier_sync_invoke_and_complete + 56\r\n19 CoreML                         0x11400 -[MLNeuralNetworkEngine evaluateInputs:options:error:] + 376\r\n20 CoreML                         0x1398c __62-[MLNeuralNetworkEngine predictionFromFeatures:options:error:]_block_invoke + 128\r\n21 libdispatch.dylib              0x3950 _dispatch_client_callout + 20\r\n22 libdispatch.dylib              0x12a70 _dispatch_lane_barrier_sync_invoke_and_complete + 56\r\n23 CoreML                         0xd3e0 -[MLNeuralNetworkEngine predictionFromFeatures:options:error:] + 436\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1319/reactions",
        "total_count": 1,
        "+1": 1,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1319/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1310",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1310/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1310/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1310/events",
      "html_url": "https://github.com/apple/coremltools/issues/1310",
      "id": 1021323033,
      "node_id": "I_kwDOBba_B8484CcZ",
      "number": 1310,
      "title": "Compute eigenvalues and eigenvectors using MIL ops?",
      "user": {
        "login": "RahulBhalley",
        "id": 9640948,
        "node_id": "MDQ6VXNlcjk2NDA5NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9640948?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RahulBhalley",
        "html_url": "https://github.com/RahulBhalley",
        "followers_url": "https://api.github.com/users/RahulBhalley/followers",
        "following_url": "https://api.github.com/users/RahulBhalley/following{/other_user}",
        "gists_url": "https://api.github.com/users/RahulBhalley/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/RahulBhalley/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/RahulBhalley/subscriptions",
        "organizations_url": "https://api.github.com/users/RahulBhalley/orgs",
        "repos_url": "https://api.github.com/users/RahulBhalley/repos",
        "events_url": "https://api.github.com/users/RahulBhalley/events{/privacy}",
        "received_events_url": "https://api.github.com/users/RahulBhalley/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-10-08T17:27:38Z",
      "updated_at": "2021-10-10T06:23:05Z",
      "closed_at": "2021-10-10T06:23:05Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nIs it possible to compute eigenvalues and eigenvectors using MIL ops? I was searching this repository and found some [tests in C++](https://github.com/apple/coremltools/blob/82c8d96cb396cc19cafc2da0ed34c1022543b486/deps/pybind11/tests/test_eigen.cpp) regarding eigenvalues and eigenvectors using [*power iteration method* in Python using NumPy](https://github.com/apple/coremltools/blob/c6354af79d7d88caef653970ec20378b34acb385/coremltools/test/neural_network/test_numpy_nn_layers.py#L5892). \r\n\r\nIf I will need to implement power iteration method to find eigenvalues/vectors then can someone please help me with that? \r\n\r\nOne more thing. How to implement `mb.while_loop()`? No examples are given in docs, can someone please give one here?\r\n\r\n## System Information\r\nNot applicable\r\n\r\nRegards\r\nRahul Bhalley\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1310/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1310/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1308",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1308/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1308/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1308/events",
      "html_url": "https://github.com/apple/coremltools/issues/1308",
      "id": 1018768878,
      "node_id": "I_kwDOBba_B848uS3u",
      "number": 1308,
      "title": "Model Preview Type for pipeline model with multiple tasks?",
      "user": {
        "login": "vade",
        "id": 65011,
        "node_id": "MDQ6VXNlcjY1MDEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/65011?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vade",
        "html_url": "https://github.com/vade",
        "followers_url": "https://api.github.com/users/vade/followers",
        "following_url": "https://api.github.com/users/vade/following{/other_user}",
        "gists_url": "https://api.github.com/users/vade/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/vade/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/vade/subscriptions",
        "organizations_url": "https://api.github.com/users/vade/orgs",
        "repos_url": "https://api.github.com/users/vade/repos",
        "events_url": "https://api.github.com/users/vade/events{/privacy}",
        "received_events_url": "https://api.github.com/users/vade/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-10-06T17:01:47Z",
      "updated_at": "2021-11-10T00:10:59Z",
      "closed_at": "2021-11-10T00:10:59Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nHello. We have a multi head ML model that produces multiple classifier predictions, as well as bounding box / object detection predictions. \r\n\r\nThe documentation states that classifier models dont require `model.preview.type` user metadata for the CoreML Model via CoreML tools - however our pipeline model, which shows up in XCode as having class labels - doesnt show us a preview tab.\r\n\r\na) Is there a way to have pipeline models have a preview for available / supported preview types? \r\nb) The documentation doesnt appear to have bounding box (via NMS) as a viable preview type (no detection option). Is this actually doable ? \r\n\r\nThank you.\r\n\r\n## System Information\r\n- Xcode 12.5\r\n- MacOS 11.6.1\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1308/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1308/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1304",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1304/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1304/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1304/events",
      "html_url": "https://github.com/apple/coremltools/issues/1304",
      "id": 1006139546,
      "node_id": "I_kwDOBba_B847-Hia",
      "number": 1304,
      "title": "Channels last mode for ML Program under FLOAT32 precision",
      "user": {
        "login": "imxieyi",
        "id": 20365903,
        "node_id": "MDQ6VXNlcjIwMzY1OTAz",
        "avatar_url": "https://avatars.githubusercontent.com/u/20365903?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/imxieyi",
        "html_url": "https://github.com/imxieyi",
        "followers_url": "https://api.github.com/users/imxieyi/followers",
        "following_url": "https://api.github.com/users/imxieyi/following{/other_user}",
        "gists_url": "https://api.github.com/users/imxieyi/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/imxieyi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/imxieyi/subscriptions",
        "organizations_url": "https://api.github.com/users/imxieyi/orgs",
        "repos_url": "https://api.github.com/users/imxieyi/repos",
        "events_url": "https://api.github.com/users/imxieyi/events{/privacy}",
        "received_events_url": "https://api.github.com/users/imxieyi/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-09-24T06:49:10Z",
      "updated_at": "2021-09-24T20:17:22Z",
      "closed_at": "2021-09-24T20:17:22Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\nIf you force precision of ML Program to `ct.precision.FLOAT32` the model can only be run on the GPU and CPU according to the document. In reality it's true. But the problem is that coremltools enforces NCHW (channels first) mode throughout all layers. However, the GPU only supports NHWC (channels last) mode. What Xcode compiler does is to insert transpose layers before and after **every** layer that runs on the GPU, resulting in 100 more transpose layers for a model with 50 conv layers. Since transpose layers are very expensive, this severely degrades performance. In my test the same model is at least 3x slower than implementation with MPSCNN, which also runs in FP32 mode. If coremltools supports NHWC the additional `transpose` layers will no longer be necessary.\r\n\r\n## Use cases\r\n- Any image model that needs to be run in FLOAT32 should have a significant performance boost if there are no unnecessary `transpose` layers.\r\n\r\n## Describe alternatives you've considered\r\nI'd use MPSCNN instead of Core ML. This is not ideal because every layer must be built by hand. It also loses all benefits Core ML provides.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1304/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1304/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1300",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1300/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1300/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1300/events",
      "html_url": "https://github.com/apple/coremltools/issues/1300",
      "id": 997809268,
      "node_id": "I_kwDOBba_B847eVx0",
      "number": 1300,
      "title": "Question on adding mb operator",
      "user": {
        "login": "shiron8bit",
        "id": 8202190,
        "node_id": "MDQ6VXNlcjgyMDIxOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8202190?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shiron8bit",
        "html_url": "https://github.com/shiron8bit",
        "followers_url": "https://api.github.com/users/shiron8bit/followers",
        "following_url": "https://api.github.com/users/shiron8bit/following{/other_user}",
        "gists_url": "https://api.github.com/users/shiron8bit/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/shiron8bit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shiron8bit/subscriptions",
        "organizations_url": "https://api.github.com/users/shiron8bit/orgs",
        "repos_url": "https://api.github.com/users/shiron8bit/repos",
        "events_url": "https://api.github.com/users/shiron8bit/events{/privacy}",
        "received_events_url": "https://api.github.com/users/shiron8bit/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-09-16T06:04:13Z",
      "updated_at": "2021-09-16T18:36:09Z",
      "closed_at": "2021-09-16T17:15:00Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nHello, is it possible to manually add grid_sampler to coremltools 4.1? (version 5 is questionable for deploy for now due to fresh ios dependency).\r\n\r\nI added corresponding operation description via `register_torch_op` and tried to register mb.resample via `register_op` from SSAOpRegistry, but got \"ValueError: resample is not implemented for nn backend\" \r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1300/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1300/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1298",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1298/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1298/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1298/events",
      "html_url": "https://github.com/apple/coremltools/issues/1298",
      "id": 990376435,
      "node_id": "MDU6SXNzdWU5OTAzNzY0MzU=",
      "number": 1298,
      "title": "Convert MLMultiArray into image",
      "user": {
        "login": "fazal-e-majid",
        "id": 48935340,
        "node_id": "MDQ6VXNlcjQ4OTM1MzQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/48935340?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fazal-e-majid",
        "html_url": "https://github.com/fazal-e-majid",
        "followers_url": "https://api.github.com/users/fazal-e-majid/followers",
        "following_url": "https://api.github.com/users/fazal-e-majid/following{/other_user}",
        "gists_url": "https://api.github.com/users/fazal-e-majid/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/fazal-e-majid/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fazal-e-majid/subscriptions",
        "organizations_url": "https://api.github.com/users/fazal-e-majid/orgs",
        "repos_url": "https://api.github.com/users/fazal-e-majid/repos",
        "events_url": "https://api.github.com/users/fazal-e-majid/events{/privacy}",
        "received_events_url": "https://api.github.com/users/fazal-e-majid/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-09-07T21:39:03Z",
      "updated_at": "2022-03-25T18:55:24Z",
      "closed_at": "2022-03-25T18:55:23Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I'm getting an output as MLMultiArray with [1, 1, 512, 512] shape. And I want to convert it into image (UIImage). I tried my best to do so, but I'm only getting black screen.\r\nI printed out the MLMultiArray, it contains 0 to 1.0 values. but getting a black screen doesn't make sense. here is what I'm doing :\r\n\r\nlet outArray = prediction!.output\r\nprint(outArray.shape) // prints [1, 1, 512, 512]\r\nlet outImg = outArray.image(min: 0, max: 1, channel: 0, axes: (1,2,3))\r\nimageView.image = outImg?.resizeTo(size: image.size) \r\n\r\nthank you",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1298/reactions",
        "total_count": 1,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 1,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1298/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1295",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1295/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1295/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1295/events",
      "html_url": "https://github.com/apple/coremltools/issues/1295",
      "id": 985452245,
      "node_id": "MDU6SXNzdWU5ODU0NTIyNDU=",
      "number": 1295,
      "title": "Convert TF model with no metadata to CoreML",
      "user": {
        "login": "arrudi",
        "id": 67423492,
        "node_id": "MDQ6VXNlcjY3NDIzNDky",
        "avatar_url": "https://avatars.githubusercontent.com/u/67423492?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/arrudi",
        "html_url": "https://github.com/arrudi",
        "followers_url": "https://api.github.com/users/arrudi/followers",
        "following_url": "https://api.github.com/users/arrudi/following{/other_user}",
        "gists_url": "https://api.github.com/users/arrudi/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/arrudi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/arrudi/subscriptions",
        "organizations_url": "https://api.github.com/users/arrudi/orgs",
        "repos_url": "https://api.github.com/users/arrudi/repos",
        "events_url": "https://api.github.com/users/arrudi/events{/privacy}",
        "received_events_url": "https://api.github.com/users/arrudi/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-09-01T18:14:18Z",
      "updated_at": "2021-10-23T00:22:32Z",
      "closed_at": "2021-10-23T00:22:32Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I'm trying to convert MoveNet (evolution of PoseNet https://tfhub.dev/google/movenet/singlepose/thunder/4) into CoreML but I can't. It seems the .pb file provided doesnt contain metadata.\n\nI've been following this (https://coremltools.readme.io/docs/tensorflow-2#convert-a-pre-trained-model) but no success.\n\nI've been suggested to use tflite models and extract the temporary mlmodel file created by tensorflow but I have no idea how to do it.\n\nAny guidance or suggestion please?\n\nThank you!",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1295/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1295/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1294",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1294/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1294/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1294/events",
      "html_url": "https://github.com/apple/coremltools/issues/1294",
      "id": 984769967,
      "node_id": "MDU6SXNzdWU5ODQ3Njk5Njc=",
      "number": 1294,
      "title": "My lstm model's speed is same in fp32 fp16 and INT8 ?",
      "user": {
        "login": "xunbing",
        "id": 16739817,
        "node_id": "MDQ6VXNlcjE2NzM5ODE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/16739817?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xunbing",
        "html_url": "https://github.com/xunbing",
        "followers_url": "https://api.github.com/users/xunbing/followers",
        "following_url": "https://api.github.com/users/xunbing/following{/other_user}",
        "gists_url": "https://api.github.com/users/xunbing/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xunbing/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xunbing/subscriptions",
        "organizations_url": "https://api.github.com/users/xunbing/orgs",
        "repos_url": "https://api.github.com/users/xunbing/repos",
        "events_url": "https://api.github.com/users/xunbing/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xunbing/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1476891360,
          "node_id": "MDU6TGFiZWwxNDc2ODkxMzYw",
          "url": "https://api.github.com/repos/apple/coremltools/labels/multi-backend%20keras",
          "name": "multi-backend keras",
          "color": "ff8000",
          "default": false,
          "description": "Issue could be related to keras framework (component)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-09-01T06:57:32Z",
      "updated_at": "2022-02-26T21:43:14Z",
      "closed_at": "2022-02-26T21:43:14Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## System Information\r\nMy environment is iPhone 12. And I didn't set the useCpuOnly. Here is my model. It's consist of one lstm + dense. By coremltools, my model size is smaller as wish. But the time cost per inference is getting slower with lower quantization. My 8bit model cost 135us, fp16 model cost 112us, fp32 model cost 106us. I invoke inference 30 times to get these numbers.\r\n\r\nHere is my model. May you give me some advices?\r\n\r\n> from keras.models import Sequential\r\nfrom keras.layers import LSTM\r\nfrom keras.layers import Dense\r\nlength = 5\r\nn_features = 10\r\nout_index = 2\r\nmodel = Sequential()\r\nmodel.add(LSTM(25, input_shape=(length, n_features)))\r\nmodel.add(Dense(n_features, activation='softmax'))\r\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1294/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1294/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1291",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1291/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1291/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1291/events",
      "html_url": "https://github.com/apple/coremltools/issues/1291",
      "id": 977057587,
      "node_id": "MDU6SXNzdWU5NzcwNTc1ODc=",
      "number": 1291,
      "title": "Provide code examples on how to convert custom PyTorch and TensorFlow models",
      "user": {
        "login": "arielelkin",
        "id": 1756909,
        "node_id": "MDQ6VXNlcjE3NTY5MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1756909?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/arielelkin",
        "html_url": "https://github.com/arielelkin",
        "followers_url": "https://api.github.com/users/arielelkin/followers",
        "following_url": "https://api.github.com/users/arielelkin/following{/other_user}",
        "gists_url": "https://api.github.com/users/arielelkin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/arielelkin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/arielelkin/subscriptions",
        "organizations_url": "https://api.github.com/users/arielelkin/orgs",
        "repos_url": "https://api.github.com/users/arielelkin/repos",
        "events_url": "https://api.github.com/users/arielelkin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/arielelkin/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1433418622,
          "node_id": "MDU6TGFiZWwxNDMzNDE4NjIy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/docs",
          "name": "docs",
          "color": "c10f47",
          "default": false,
          "description": "Contains documentation or clarification regarding docs (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-08-23T13:48:39Z",
      "updated_at": "2021-10-23T00:12:38Z",
      "closed_at": "2021-10-23T00:12:38Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "The documentation for the [Unified Conversion API](https://coremltools.readme.io/docs/unified-conversion-api) provides code examples on how to convert models already built into TensorFlow and PyTorch. \r\n\r\nAlthough some users may be interested in converting the venerable MobileNet, ResNet, or Inception, many users are interested in converting their own custom-made models from PyTorch or TensorFlow. That's not a trivial process so we'd expect the coremltools documentation to provide code samples on how to load one's custom model from a `h5`, `pth`, `tflite`, etc. file.",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1291/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1291/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1287",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1287/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1287/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1287/events",
      "html_url": "https://github.com/apple/coremltools/issues/1287",
      "id": 973244901,
      "node_id": "MDU6SXNzdWU5NzMyNDQ5MDE=",
      "number": 1287,
      "title": "torch.linspace function",
      "user": {
        "login": "dawei03896",
        "id": 84013536,
        "node_id": "MDQ6VXNlcjg0MDEzNTM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/84013536?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dawei03896",
        "html_url": "https://github.com/dawei03896",
        "followers_url": "https://api.github.com/users/dawei03896/followers",
        "following_url": "https://api.github.com/users/dawei03896/following{/other_user}",
        "gists_url": "https://api.github.com/users/dawei03896/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dawei03896/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dawei03896/subscriptions",
        "organizations_url": "https://api.github.com/users/dawei03896/orgs",
        "repos_url": "https://api.github.com/users/dawei03896/repos",
        "events_url": "https://api.github.com/users/dawei03896/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dawei03896/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        },
        {
          "id": 2870915972,
          "node_id": "MDU6TGFiZWwyODcwOTE1OTcy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/missing%20layer%20type",
          "name": "missing layer type",
          "color": "0052cc",
          "default": false,
          "description": "Unable to convert a layer type from the relevant framework"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-08-18T03:47:28Z",
      "updated_at": "2022-02-26T21:38:38Z",
      "closed_at": "2022-02-26T21:38:38Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Hi, I was wondering is there any plan to support torch.linspace in the future? linspace  is very important in the current Video Frame Interpolation task and I am curious is there any plan to support it in the future. thanks.",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1287/reactions",
        "total_count": 3,
        "+1": 3,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1287/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1286",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1286/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1286/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1286/events",
      "html_url": "https://github.com/apple/coremltools/issues/1286",
      "id": 968273018,
      "node_id": "MDU6SXNzdWU5NjgyNzMwMTg=",
      "number": 1286,
      "title": "PyTorch to CoreML",
      "user": {
        "login": "jinsu35",
        "id": 3479333,
        "node_id": "MDQ6VXNlcjM0NzkzMzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3479333?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jinsu35",
        "html_url": "https://github.com/jinsu35",
        "followers_url": "https://api.github.com/users/jinsu35/followers",
        "following_url": "https://api.github.com/users/jinsu35/following{/other_user}",
        "gists_url": "https://api.github.com/users/jinsu35/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jinsu35/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jinsu35/subscriptions",
        "organizations_url": "https://api.github.com/users/jinsu35/orgs",
        "repos_url": "https://api.github.com/users/jinsu35/repos",
        "events_url": "https://api.github.com/users/jinsu35/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jinsu35/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-08-12T07:43:49Z",
      "updated_at": "2022-03-17T23:51:26Z",
      "closed_at": "2022-03-17T23:51:26Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "This is how a module SpectralMultiScale is defined.\r\nhttps://github.com/shangeth/SpeakerProfiling/blob/7e5f3b013101fdc95732851e374f4170d2f97150/Model/models.py#L107\r\n\r\nAnd my code to convert is\r\n`\r\nsample = torch.rand(1, 40, 241)\r\n`\r\n`\r\nmodel = torch.jit.trace(model, sample)\r\n`\r\n`\r\ncore_model = ct.convert(\r\n    model,\r\n    inputs=[ct.TensorType(shape=sample.shape)]\r\n)\r\n`\r\n\r\nThe errors are following:\r\n\r\nTraceback (most recent call last):\r\n  File \"converter.py\", line 49, in <module>\r\n    core_model = ct.convert(\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/_converters_entry.py\", line 291, in convert\r\n    mlmodel = mil_convert(\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 166, in mil_convert\r\n    return _mil_convert(model, convert_from, convert_to, ConverterRegistry, MLModel, **kwargs)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 193, in _mil_convert\r\n    proto, mil_program = mil_convert_to_proto(\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 285, in mil_convert_to_proto\r\n    prog = frontend_converter(model, **kwargs)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 103, in __call__\r\n    return load(*args, **kwargs)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/load.py\", line 82, in load\r\n    raise e\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/load.py\", line 72, in load\r\n    prog = converter.convert()\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/converter.py\", line 229, in convert\r\n    convert_nodes(self.context, self.graph)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/ops.py\", line 69, in convert_nodes\r\n    _add_op(context, node)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/ops.py\", line 643, in _convolution\r\n    conv = mb.conv(**kwargs)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/mil/ops/registry.py\", line 61, in add_op\r\n    return cls._add_op(op_cls, **kwargs)\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/mil/builder.py\", line 182, in _add_op\r\n    new_op.type_value_inference()\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/mil/operation.py\", line 239, in type_value_inference\r\n    output_types = self.type_inference()\r\n  File \"/Users/jinsukim/Workspace/SpeakerAge/env/lib/python3.8/site-packages/coremltools/converters/mil/mil/ops/defs/conv.py\", line 174, in type_inference\r\n    raise ValueError(msg.format(C_in, groups, self.weight.shape[1]))\r\nValueError: C_in / groups = 241/1 != weight[1] (40)\r\n\r\nI need help!",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1286/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1286/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1281",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1281/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1281/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1281/events",
      "html_url": "https://github.com/apple/coremltools/issues/1281",
      "id": 959070950,
      "node_id": "MDU6SXNzdWU5NTkwNzA5NTA=",
      "number": 1281,
      "title": "coremltools compatibility with windows operating system",
      "user": {
        "login": "adjhawar",
        "id": 15729111,
        "node_id": "MDQ6VXNlcjE1NzI5MTEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/15729111?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adjhawar",
        "html_url": "https://github.com/adjhawar",
        "followers_url": "https://api.github.com/users/adjhawar/followers",
        "following_url": "https://api.github.com/users/adjhawar/following{/other_user}",
        "gists_url": "https://api.github.com/users/adjhawar/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/adjhawar/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/adjhawar/subscriptions",
        "organizations_url": "https://api.github.com/users/adjhawar/orgs",
        "repos_url": "https://api.github.com/users/adjhawar/repos",
        "events_url": "https://api.github.com/users/adjhawar/events{/privacy}",
        "received_events_url": "https://api.github.com/users/adjhawar/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        },
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-08-03T12:34:13Z",
      "updated_at": "2021-08-03T22:16:23Z",
      "closed_at": "2021-08-03T22:16:23Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Is the coremltools python package supported on windows? If yes, then what versions are supported?\r\nI was trying to install coremltools version 3.1 on my PC using pip but it was not showing me any coremltools module with version 3.1.\r\n\r\n## System Information\r\n- OS - Windows 10\r\n- Python version - 3.7\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1281/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1281/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1277",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1277/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1277/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1277/events",
      "html_url": "https://github.com/apple/coremltools/issues/1277",
      "id": 953476983,
      "node_id": "MDU6SXNzdWU5NTM0NzY5ODM=",
      "number": 1277,
      "title": "coremlc: warning: compile command This model is not supported on specified deployment target of macos 10.10.  It requires 10.13.2 or greater",
      "user": {
        "login": "baaj2109",
        "id": 15242904,
        "node_id": "MDQ6VXNlcjE1MjQyOTA0",
        "avatar_url": "https://avatars.githubusercontent.com/u/15242904?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/baaj2109",
        "html_url": "https://github.com/baaj2109",
        "followers_url": "https://api.github.com/users/baaj2109/followers",
        "following_url": "https://api.github.com/users/baaj2109/following{/other_user}",
        "gists_url": "https://api.github.com/users/baaj2109/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/baaj2109/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/baaj2109/subscriptions",
        "organizations_url": "https://api.github.com/users/baaj2109/orgs",
        "repos_url": "https://api.github.com/users/baaj2109/repos",
        "events_url": "https://api.github.com/users/baaj2109/events{/privacy}",
        "received_events_url": "https://api.github.com/users/baaj2109/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-07-27T03:59:44Z",
      "updated_at": "2021-07-29T23:21:24Z",
      "closed_at": "2021-07-29T23:21:24Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI convert a test mlmodel from Tensorflow, and this model have minimum target version 10.13.2,\r\nbut my project's deployment target is 10.10, when I build it, always have warning message like \r\n\r\n> CoreMLModelCompile /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/ /Users/kehwaweng/Documents/ObjectDetection/DetectKit/detectionkit/DetectionKit-Shared/models/test.mlmodel (in target 'DetectionKit' from project 'DetectionKit')\r\n>     cd /Users/kehwaweng/Documents/ObjectDetection/DetectKit/detectionkit\r\n>     /Applications/Xcode.app/Contents/Developer/usr/bin/coremlc compile /Users/kehwaweng/Documents/ObjectDetection/DetectKit/detectionkit/DetectionKit-Shared/models/test.mlmodel /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/ --deployment-target 10.10 --platform macos --output-partial-info-plist /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Intermediates.noindex/DetectionKit.build/Debug/DetectionKit.build/test-CoreMLPartialInfo.plist\r\n> \r\n> coremlc: warning: compile command This model is not supported on specified deployment target of macos 10.10. It requires 10.13.2 or greater\r\n> /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/test.mlmodelc/coremldata.bin\r\n> /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/test.mlmodelc/model.espresso.weights\r\n> /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/test.mlmodelc/model.espresso.shape\r\n> /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/test.mlmodelc/model.espresso.net\r\n> /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/test.mlmodelc/model/coremldata.bin\r\n> /Users/kehwaweng/Library/Developer/Xcode/DerivedData/DetectionKit-hctgwknufakmlldullfasrnhcxqk/Build/Products/Debug/DetectionKit.framework/Versions/A/Resources/test.mlmodelc/neural_network_optionals/coremldata.bin\r\n\r\nIs there any solution to remove this warning and keep deployment target 10.10\r\n\r\n[model](https://drive.google.com/file/d/1QjxNQVQJcMbyj6JWsmCDt7dD04JC35A0/view?usp=sharing)",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1277/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1277/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1273",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1273/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1273/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1273/events",
      "html_url": "https://github.com/apple/coremltools/issues/1273",
      "id": 950483095,
      "node_id": "MDU6SXNzdWU5NTA0ODMwOTU=",
      "number": 1273,
      "title": "_convolution  if weight.val.ndim in (3, 4):   AttributeError: 'NoneType' object has no attribute 'ndim'",
      "user": {
        "login": "YaqiLYU",
        "id": 14176371,
        "node_id": "MDQ6VXNlcjE0MTc2Mzcx",
        "avatar_url": "https://avatars.githubusercontent.com/u/14176371?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/YaqiLYU",
        "html_url": "https://github.com/YaqiLYU",
        "followers_url": "https://api.github.com/users/YaqiLYU/followers",
        "following_url": "https://api.github.com/users/YaqiLYU/following{/other_user}",
        "gists_url": "https://api.github.com/users/YaqiLYU/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/YaqiLYU/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/YaqiLYU/subscriptions",
        "organizations_url": "https://api.github.com/users/YaqiLYU/orgs",
        "repos_url": "https://api.github.com/users/YaqiLYU/repos",
        "events_url": "https://api.github.com/users/YaqiLYU/events{/privacy}",
        "received_events_url": "https://api.github.com/users/YaqiLYU/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616954,
          "node_id": "MDU6TGFiZWwxNTY0NjE2OTU0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/triaged",
          "name": "triaged",
          "color": "27bbce",
          "default": false,
          "description": "Reviewed and examined, release as been assigned if applicable (status)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 8,
      "created_at": "2021-07-22T09:48:31Z",
      "updated_at": "2021-08-27T05:42:30Z",
      "closed_at": "2021-08-27T05:41:00Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I use latest coremltools\r\n`pip install coremltools==5.0b1\r\n`\r\n\r\nhttps://apple.github.io/coremltools/source/coremltools.models.neural_network.html?highlight=_convolution#coremltools.models.neural_network.builder.NeuralNetworkBuilder.add_convolution\r\n\r\n> If W is of type bytes(), i.e. quantized, other quantization related arguments must be provided as well (see below). For Core ML specification version >=4, W can be None. In this case, the convolution layer takes 2 inputs, where the 1st input represents the input feature map, the 2nd input represents the weight blob.\r\n\r\n```\r\nimport torch\r\nfrom torch import nn\r\nimport torch.nn.functional as F\r\nimport coremltools as ct\r\n\r\n\r\nclass my_model(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n\r\n    def forward(self, x, w):\r\n        w= w.view(96, 1, 7, 7)\r\n        out = F.conv2d(x, w, groups=96, padding=3)\r\n        return out\r\n\r\n\r\nmodel= my_model()\r\nmodel.eval()\r\n\r\ninput1 = torch.rand(1, 96, 16, 16, device='cpu')\r\ninput2 = torch.rand(1, 96, 7, 7, device='cpu')\r\ntraced_model = torch.jit.trace(model, (input1, input2 ))\r\n\r\ncoremlmodel = ct.convert(\r\n    traced_model,\r\n    inputs=[ct.TensorType(name=\"data\", shape=input1.shape),\r\n            ct.TensorType(name=\"feature\", shape=input2.shape)],\r\n    source='pytorch',\r\n    minimum_deployment_target=ct.target.iOS13)\r\n```\r\n\r\nWARNING:root:scikit-learn version 0.24.1 is not supported. Minimum required version: 0.17. Maximum required version: 0.19.2. Disabling scikit-learn conversion API.\r\n Converting Frontend ==> MIL Ops:  96%|    | 25/26 [00:00<00:00, 7350.69 ops/s]\r\nTraceback (most recent call last):\r\nFile \"convert_test.py\", line 24, in <module>\r\ncoremlmodel = ct.convert(                                                                                                                                                         \r\nFile \"/home/xxx/coremltools/converters/_converters_entry.py\", line 291, in convert\r\nmlmodel = mil_convert(                                                                                                                                                            \r\nFile \"/home/xxx/coremltools/converters/mil/converter.py\", line 166, in mil_convert\r\nreturn _mil_convert(model, convert_from, convert_to, ConverterRegistry, MLModel, **kwargs)                                                                                        \r\nFile \"/home/xxx/coremltools/converters/mil/converter.py\", line 192, in _mil_convert\r\nproto, mil_program = mil_convert_to_proto(                                                                                                                                        \r\nFile \"/home/xxx/coremltools/converters/mil/converter.py\", line 284, in mil_convert_to_proto\r\nprog = frontend_converter(model, **kwargs)                                                                                                                                        \r\nFile \"/home/xxx/coremltools/converters/mil/converter.py\", line 103, in __call__\r\nreturn load(*args, **kwargs)                                                                                                                                                      \r\nFile \"/home/xxx/coremltools/converters/mil/frontend/torch/load.py\", line 82, in load\r\nraise e                                                                                                                                                                           \r\nFile \"/home/xxx/coremltools/converters/mil/frontend/torch/load.py\", line 72, in load\r\nprog = converter.convert()                                                                                                                                                        \r\nFile \"/home/xxx/coremltools/converters/mil/frontend/torch/converter.py\", line 229, in convert\r\n   convert_nodes(self.context, self.graph)                                                                                                                                           \r\nFile \"/home/xxx/coremltools/converters/mil/frontend/torch/ops.py\", line 69, in convert_nodes\r\n_add_op(context, node)                                                                                                                                                            \r\nFile \"/home/xxx/coremltools/converters/mil/frontend/torch/ops.py\", line 539, in _convolution\r\nif weight.val.ndim in (3, 4):                                                                                                                                                   AttributeError: 'NoneType' object has no attribute 'ndim' ",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1273/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1273/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1272",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1272/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1272/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1272/events",
      "html_url": "https://github.com/apple/coremltools/issues/1272",
      "id": 950412696,
      "node_id": "MDU6SXNzdWU5NTA0MTI2OTY=",
      "number": 1272,
      "title": "Support TF op 'NonMaxSuppressionV5'",
      "user": {
        "login": "vonchenplus",
        "id": 3349963,
        "node_id": "MDQ6VXNlcjMzNDk5NjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3349963?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vonchenplus",
        "html_url": "https://github.com/vonchenplus",
        "followers_url": "https://api.github.com/users/vonchenplus/followers",
        "following_url": "https://api.github.com/users/vonchenplus/following{/other_user}",
        "gists_url": "https://api.github.com/users/vonchenplus/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/vonchenplus/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/vonchenplus/subscriptions",
        "organizations_url": "https://api.github.com/users/vonchenplus/orgs",
        "repos_url": "https://api.github.com/users/vonchenplus/repos",
        "events_url": "https://api.github.com/users/vonchenplus/events{/privacy}",
        "received_events_url": "https://api.github.com/users/vonchenplus/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-07-22T08:17:17Z",
      "updated_at": "2021-07-22T17:31:46Z",
      "closed_at": "2021-07-22T17:31:40Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\nI have a object-detection model trained from tensorflow, and now I need to convert it to coreml, but found that the NonMaxSuppressionV5 operation is currently not supported.\r\n\r\ncoremltools version: 4.1\r\nOS: Ubuntu\r\npython version: 3.7\r\nTensorflow version: 1.15\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1272/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1272/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1264",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1264/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1264/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1264/events",
      "html_url": "https://github.com/apple/coremltools/issues/1264",
      "id": 946858861,
      "node_id": "MDU6SXNzdWU5NDY4NTg4NjE=",
      "number": 1264,
      "title": "AttributeError: 'numpy.ndarray' object has no attribute 'val'",
      "user": {
        "login": "Leonkh",
        "id": 62510482,
        "node_id": "MDQ6VXNlcjYyNTEwNDgy",
        "avatar_url": "https://avatars.githubusercontent.com/u/62510482?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Leonkh",
        "html_url": "https://github.com/Leonkh",
        "followers_url": "https://api.github.com/users/Leonkh/followers",
        "following_url": "https://api.github.com/users/Leonkh/following{/other_user}",
        "gists_url": "https://api.github.com/users/Leonkh/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Leonkh/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Leonkh/subscriptions",
        "organizations_url": "https://api.github.com/users/Leonkh/orgs",
        "repos_url": "https://api.github.com/users/Leonkh/repos",
        "events_url": "https://api.github.com/users/Leonkh/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Leonkh/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-07-17T16:48:15Z",
      "updated_at": "2021-07-17T17:02:24Z",
      "closed_at": "2021-07-17T17:02:24Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Tried to convert savedModel https://tfhub.dev/tensorflow/retinanet/resnet101_v1_fpn_1024x1024/1 to mlmodel and have this error log:\r\n\r\nWARNING:root:TensorFlow version 2.5.0 detected. Last version known to be fully compatible is 2.3.1 .\r\nRunning TensorFlow Graph Passes:   0%|                                                          | 0/5 [00:00<?, ? passes/s]ERROR:root:Constant Propagation pass failed: list index out of range\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow/tf_graph_pass/constant_propagation.py\", line 152, in _constant_propagation\r\n    v.datatype = inp.datatype.T[idx]\r\nIndexError: list index out of range\r\nRunning TensorFlow Graph Passes: 100%|| 5/5 [00:14<00:00,  2.85s/ passes]\r\nConverting Frontend ==> MIL Ops:  54%|                     | 2854/5275 [00:04<00:04, 587.86 ops/s]\r\nTraceback (most recent call last):\r\n  File \"/Users/leonidhabibullin/Downloads/kerasAPP.py\", line 7, in <module>\r\n    mlmodel = ct.convert('/Users/leonidhabibullin/Downloads/retinanet_resnet101_v1_fpn_1024x1024_1', source='tensorflow')\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/_converters_entry.py\", line 291, in convert\r\n    mlmodel = mil_convert(\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 166, in mil_convert\r\n    return _mil_convert(model, convert_from, convert_to, ConverterRegistry, MLModel, **kwargs)\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 192, in _mil_convert\r\n    proto, mil_program = mil_convert_to_proto(\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 284, in mil_convert_to_proto\r\n    prog = frontend_converter(model, **kwargs)\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/converter.py\", line 93, in __call__\r\n    return tf2_loader.load()\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow/load.py\", line 76, in load\r\n    program = self._program_from_tf_ssa()\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow2/load.py\", line 175, in _program_from_tf_ssa\r\n    return converter.convert()\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow/converter.py\", line 406, in convert\r\n    self.convert_main_graph(prog, graph)\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow/converter.py\", line 335, in convert_main_graph\r\n    outputs = convert_graph(self.context, graph, self.outputs)\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow/convert_utils.py\", line 186, in convert_graph\r\n    _add_op(context, node)\r\n  File \"/usr/local/lib/python3.9/site-packages/coremltools/converters/mil/frontend/tensorflow/ops.py\", line 430, in Const\r\n    x = mb.const(val=node.value.val, name=node.name)\r\nAttributeError: 'numpy.ndarray' object has no attribute 'val'\r\n\r\nAs I see in log I have problem in this line:\r\n\r\nhttps://github.com/apple/coremltools/blob/10f1459e87925aad4b52e77b2733fd1b11627c4d/coremltools/converters/mil/frontend/tensorflow/ops.py#L430",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1264/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1264/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1261",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1261/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1261/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1261/events",
      "html_url": "https://github.com/apple/coremltools/issues/1261",
      "id": 945573843,
      "node_id": "MDU6SXNzdWU5NDU1NzM4NDM=",
      "number": 1261,
      "title": "How is image orientation correction meant to work with coremltools?",
      "user": {
        "login": "slmille4",
        "id": 6100072,
        "node_id": "MDQ6VXNlcjYxMDAwNzI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6100072?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/slmille4",
        "html_url": "https://github.com/slmille4",
        "followers_url": "https://api.github.com/users/slmille4/followers",
        "following_url": "https://api.github.com/users/slmille4/following{/other_user}",
        "gists_url": "https://api.github.com/users/slmille4/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/slmille4/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/slmille4/subscriptions",
        "organizations_url": "https://api.github.com/users/slmille4/orgs",
        "repos_url": "https://api.github.com/users/slmille4/repos",
        "events_url": "https://api.github.com/users/slmille4/events{/privacy}",
        "received_events_url": "https://api.github.com/users/slmille4/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-07-15T16:44:30Z",
      "updated_at": "2021-07-16T17:56:31Z",
      "closed_at": "2021-07-16T17:56:31Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nAt https://developer.apple.com/documentation/vision/classifying_images_with_vision_and_core_ml it says \r\n\r\n> Most models are trained on images that are already oriented correctly for display. To ensure proper handling of input images with arbitrary orientations, pass the images orientation to the image request handler.\r\n\r\nHow is this process supposed to work with coremltools? Is the orientation supposed to be changed automatically based on the VNImageRequestHandler parameter before it reaches the coreml model, or is the model supposed to read the orientation and rotate the image accordingly? If it's the second, how is the orientation parameter passed to the Python code? Also is the Python side responsible for converting the resulting coordinates back to the original frame of reference?\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1261/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1261/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1258",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1258/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1258/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1258/events",
      "html_url": "https://github.com/apple/coremltools/issues/1258",
      "id": 942672644,
      "node_id": "MDU6SXNzdWU5NDI2NzI2NDQ=",
      "number": 1258,
      "title": "can coremltools fuse pad + conv(pad='valid') layer to conv(pad='same') ?",
      "user": {
        "login": "huangteng",
        "id": 4410358,
        "node_id": "MDQ6VXNlcjQ0MTAzNTg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4410358?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/huangteng",
        "html_url": "https://github.com/huangteng",
        "followers_url": "https://api.github.com/users/huangteng/followers",
        "following_url": "https://api.github.com/users/huangteng/following{/other_user}",
        "gists_url": "https://api.github.com/users/huangteng/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/huangteng/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/huangteng/subscriptions",
        "organizations_url": "https://api.github.com/users/huangteng/orgs",
        "repos_url": "https://api.github.com/users/huangteng/repos",
        "events_url": "https://api.github.com/users/huangteng/events{/privacy}",
        "received_events_url": "https://api.github.com/users/huangteng/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-07-13T03:40:58Z",
      "updated_at": "2022-02-02T02:58:10Z",
      "closed_at": "2022-02-02T02:58:10Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## Background\r\nI have a tflite model, and I use tflite->onnx->pb->mlprogram path to convert it to mlprogram, as following\r\ntflite ----/tf-onnx/------  onnx ----/onnx-tf/------ pb ------/coremltools/---- mlprogram                                                          \r\n\r\nHowever when to pb, it converts conv(pad='same') to 2 seperate layer (pad + conv (pad='valid')), so coreml tools converted it in the same way. I guess this will affect the performace compared to one layer conv(pad='same'), so is there a way the mlprogram does it automatically ?",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1258/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1258/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1253",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1253/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1253/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1253/events",
      "html_url": "https://github.com/apple/coremltools/issues/1253",
      "id": 941859817,
      "node_id": "MDU6SXNzdWU5NDE4NTk4MTc=",
      "number": 1253,
      "title": "Performance of basic PyTorch operations",
      "user": {
        "login": "sven-ds",
        "id": 82410848,
        "node_id": "MDQ6VXNlcjgyNDEwODQ4",
        "avatar_url": "https://avatars.githubusercontent.com/u/82410848?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sven-ds",
        "html_url": "https://github.com/sven-ds",
        "followers_url": "https://api.github.com/users/sven-ds/followers",
        "following_url": "https://api.github.com/users/sven-ds/following{/other_user}",
        "gists_url": "https://api.github.com/users/sven-ds/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/sven-ds/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/sven-ds/subscriptions",
        "organizations_url": "https://api.github.com/users/sven-ds/orgs",
        "repos_url": "https://api.github.com/users/sven-ds/repos",
        "events_url": "https://api.github.com/users/sven-ds/events{/privacy}",
        "received_events_url": "https://api.github.com/users/sven-ds/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-07-12T09:31:57Z",
      "updated_at": "2022-02-02T02:57:36Z",
      "closed_at": "2022-02-02T02:57:36Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nHi,\r\n\r\nI'm using coremltools to convert a PyTorch model, and it performs nicely on the phone.\r\n\r\nHowever for a new feature, I use some basic PyTorch operations (like mul, div, add, sub, square). I also keep some stateful variables in the model. With these operations, I observe a massive drop in performance on the phone. On the PC, however, everything runs as fast as ever, and profiling in PyTorch does not show any significant difference.\r\n\r\nCould you share any experience with me what kind of operations rund faster/ slower on the phone, like any operations which are less optimized than others for the phone? Anything particular I should avoid?\r\n\r\n## System Information\r\n- iPhone 8\r\n- iOS 14.5.1\r\n- CoreML\r\n- Metal\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1253/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1253/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1233",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1233/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1233/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1233/events",
      "html_url": "https://github.com/apple/coremltools/issues/1233",
      "id": 935056889,
      "node_id": "MDU6SXNzdWU5MzUwNTY4ODk=",
      "number": 1233,
      "title": "GitLab CI should run unit tests on Linux",
      "user": {
        "login": "TobyRoseman",
        "id": 5420744,
        "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TobyRoseman",
        "html_url": "https://github.com/TobyRoseman",
        "followers_url": "https://api.github.com/users/TobyRoseman/followers",
        "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
        "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
        "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
        "repos_url": "https://api.github.com/users/TobyRoseman/repos",
        "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373894,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTQ=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/enhancement",
          "name": "enhancement",
          "color": "c10f47",
          "default": true,
          "description": "Improvement to existing functionality (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-07-01T17:17:49Z",
      "updated_at": "2021-08-31T21:30:52Z",
      "closed_at": "2021-08-31T21:30:52Z",
      "author_association": "COLLABORATOR",
      "active_lock_reason": null,
      "body": "Currently our [GitLab CI](https://github.com/apple/coremltools/blob/main/.gitlab-ci.yml) doesn't run unit tests on Linux. We should add Linux unit tests to our CI.",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1233/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1233/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1230",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1230/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1230/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1230/events",
      "html_url": "https://github.com/apple/coremltools/issues/1230",
      "id": 934706933,
      "node_id": "MDU6SXNzdWU5MzQ3MDY5MzM=",
      "number": 1230,
      "title": "Converted Coreml output model is not the same as the original",
      "user": {
        "login": "AnasArram",
        "id": 41643551,
        "node_id": "MDQ6VXNlcjQxNjQzNTUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/41643551?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/AnasArram",
        "html_url": "https://github.com/AnasArram",
        "followers_url": "https://api.github.com/users/AnasArram/followers",
        "following_url": "https://api.github.com/users/AnasArram/following{/other_user}",
        "gists_url": "https://api.github.com/users/AnasArram/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/AnasArram/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/AnasArram/subscriptions",
        "organizations_url": "https://api.github.com/users/AnasArram/orgs",
        "repos_url": "https://api.github.com/users/AnasArram/repos",
        "events_url": "https://api.github.com/users/AnasArram/events{/privacy}",
        "received_events_url": "https://api.github.com/users/AnasArram/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-07-01T10:52:31Z",
      "updated_at": "2021-07-05T13:00:58Z",
      "closed_at": "2021-07-05T13:00:58Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "\r\nI have converted HRNET model for pose estimations from pytorch to coreml successfully. But the output of the converted model is not as in pytorch model.\r\nI mean: the output  of the model is the body joints keypoints, the issue in converted coreml is that the predicted keypoints are not exactly at the same position on human on the camera. (All keypoints are there but a little bit moved when you visualize them).\r\n\r\nAny suggestion?\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1230/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1230/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1229",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1229/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1229/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1229/events",
      "html_url": "https://github.com/apple/coremltools/issues/1229",
      "id": 934244796,
      "node_id": "MDU6SXNzdWU5MzQyNDQ3OTY=",
      "number": 1229,
      "title": "Inference overflow when running mlmodel, converted from pytorch model, on ANE. ",
      "user": {
        "login": "whateverThisIs",
        "id": 34944765,
        "node_id": "MDQ6VXNlcjM0OTQ0NzY1",
        "avatar_url": "https://avatars.githubusercontent.com/u/34944765?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/whateverThisIs",
        "html_url": "https://github.com/whateverThisIs",
        "followers_url": "https://api.github.com/users/whateverThisIs/followers",
        "following_url": "https://api.github.com/users/whateverThisIs/following{/other_user}",
        "gists_url": "https://api.github.com/users/whateverThisIs/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/whateverThisIs/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/whateverThisIs/subscriptions",
        "organizations_url": "https://api.github.com/users/whateverThisIs/orgs",
        "repos_url": "https://api.github.com/users/whateverThisIs/repos",
        "events_url": "https://api.github.com/users/whateverThisIs/events{/privacy}",
        "received_events_url": "https://api.github.com/users/whateverThisIs/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-07-01T00:50:22Z",
      "updated_at": "2022-03-17T23:40:00Z",
      "closed_at": "2022-03-17T23:40:00Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "\r\nThis inference overflow error only happens if both below conditions are met:\r\n1. batch size is larger than 1, eg 4x1x100x100. When input is something like 1x1x200x200, error goes away.\r\n2. running on ANE. Error disappears when running in cpu+gpu mode. \r\n\r\nI tried building the model in MIL, same error occurs. \r\n\r\nI tried building with neural network builder directly. Error disappears, but model slow. \r\n\r\nIt seems to be converter related as the network builder function does not need a converter anymore. \r\n\r\nThank.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1229/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1229/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1227",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1227/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1227/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1227/events",
      "html_url": "https://github.com/apple/coremltools/issues/1227",
      "id": 929572875,
      "node_id": "MDU6SXNzdWU5Mjk1NzI4NzU=",
      "number": 1227,
      "title": "speed difference between padding of conv layers vs PaddingLayer operator",
      "user": {
        "login": "whateverThisIs",
        "id": 34944765,
        "node_id": "MDQ6VXNlcjM0OTQ0NzY1",
        "avatar_url": "https://avatars.githubusercontent.com/u/34944765?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/whateverThisIs",
        "html_url": "https://github.com/whateverThisIs",
        "followers_url": "https://api.github.com/users/whateverThisIs/followers",
        "following_url": "https://api.github.com/users/whateverThisIs/following{/other_user}",
        "gists_url": "https://api.github.com/users/whateverThisIs/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/whateverThisIs/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/whateverThisIs/subscriptions",
        "organizations_url": "https://api.github.com/users/whateverThisIs/orgs",
        "repos_url": "https://api.github.com/users/whateverThisIs/repos",
        "events_url": "https://api.github.com/users/whateverThisIs/events{/privacy}",
        "received_events_url": "https://api.github.com/users/whateverThisIs/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-06-24T20:06:52Z",
      "updated_at": "2021-06-29T21:26:25Z",
      "closed_at": "2021-06-29T21:26:25Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "My pytorch model uses replicate padding for convolution layers. However, coreml does not support pytorch replicate padding conversion to mlmodel module, so the reasonable next step for me is to build a mlmodel from scratch manually using add_padding(). But before even trying that, I'm just wondering , for mlmodel, what is the performance difference between zero/constant padding done by conv operators compared to replicate padding done by paddingLayer()? As I suspect that paddinglayers might need to work with memory allocations and stuff, and if the overhead for replicate padding is much higher than zero/constant padding, I might just not use replicate padding at all and then I don't need to manually write my large model manually.",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1227/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1227/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1222",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1222/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1222/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1222/events",
      "html_url": "https://github.com/apple/coremltools/issues/1222",
      "id": 919844069,
      "node_id": "MDU6SXNzdWU5MTk4NDQwNjk=",
      "number": 1222,
      "title": "CoreML export failure: name 'ModelPackage' is not defined ( v5.0b1 ) ",
      "user": {
        "login": "djacobs7",
        "id": 34345,
        "node_id": "MDQ6VXNlcjM0MzQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/34345?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/djacobs7",
        "html_url": "https://github.com/djacobs7",
        "followers_url": "https://api.github.com/users/djacobs7/followers",
        "following_url": "https://api.github.com/users/djacobs7/following{/other_user}",
        "gists_url": "https://api.github.com/users/djacobs7/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/djacobs7/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/djacobs7/subscriptions",
        "organizations_url": "https://api.github.com/users/djacobs7/orgs",
        "repos_url": "https://api.github.com/users/djacobs7/repos",
        "events_url": "https://api.github.com/users/djacobs7/events{/privacy}",
        "received_events_url": "https://api.github.com/users/djacobs7/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        },
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2021-06-13T17:19:16Z",
      "updated_at": "2021-07-03T11:00:02Z",
      "closed_at": "2021-06-14T17:55:11Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "When I  run the following code snippet:\r\n\r\n    # CoreML export\r\n    try:\r\n        import coremltools as ct\r\n\r\n        print('\\nStarting CoreML export with coremltools %s...' % ct.__version__)\r\n        # convert model from torchscript and apply pixel scaling as per detect.py\r\n        model = ct.convert(ts, inputs=[ct.ImageType(name='image', shape=img.shape, scale=1 / 255.0, bias=[0, 0, 0])])\r\n        f = opt.weights.replace('.pt', '.mlmodel')  # filename\r\n        model.save(f)\r\n        print('CoreML export success, saved as %s' % f)\r\n    except Exception as e:\r\n        print('CoreML export failure: %s' % e)\r\n\r\n\r\nI get the following error:\r\n```\r\n  CoreML export failure: name 'ModelPackage' is not defined\r\n```\r\n\r\nThis is using the beta version of coreml tools.\r\n```\r\n\r\nPackage           Version\r\n----------------- -------------------\r\nattrs             21.2.0\r\nbrotlipy          0.7.0\r\ncertifi           2021.5.30\r\ncffi              1.14.5\r\nchardet           4.0.0\r\n**coremltools       5.0b1**\r\ncryptography      3.4.7\r\ncycler            0.10.0\r\ngmpy2             2.1.0b1\r\nidna              2.10\r\nkiwisolver        1.3.1\r\nmatplotlib        3.3.4\r\nmkl-fft           1.3.0\r\nmkl-random        1.1.1\r\nmkl-service       2.3.0\r\nmpmath            1.2.1\r\nnumpy             1.19.2\r\nolefile           0.46\r\npackaging         20.9\r\npandas            1.2.4\r\nPillow            8.2.0\r\npip               21.0.1\r\nprotobuf          3.16.0\r\npycparser         2.20\r\npyOpenSSL         20.0.1\r\npyparsing         2.4.7\r\nPySocks           1.7.1\r\npython-dateutil   2.8.1\r\npytz              2021.1\r\nPyYAML            5.4.1\r\nrequests          2.25.1\r\nscipy             1.6.2\r\nseaborn           0.11.1\r\nsetuptools        52.0.0.post20210125\r\nsix               1.15.0\r\nsympy             1.8\r\ntorch             1.7.1\r\ntorchvision       0.8.0a0\r\ntornado           6.1\r\ntqdm              4.60.0\r\ntyping-extensions 3.7.4.3\r\nurllib3           1.26.4\r\nwheel             0.36.2\r\n```\r\n\r\nAny ideas what to do?\r\n\r\nThanks\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1222/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1222/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1219",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1219/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1219/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1219/events",
      "html_url": "https://github.com/apple/coremltools/issues/1219",
      "id": 918197216,
      "node_id": "MDU6SXNzdWU5MTgxOTcyMTY=",
      "number": 1219,
      "title": "Feedback: Core ML Model Package",
      "user": {
        "login": "lutzroeder",
        "id": 438516,
        "node_id": "MDQ6VXNlcjQzODUxNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/438516?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lutzroeder",
        "html_url": "https://github.com/lutzroeder",
        "followers_url": "https://api.github.com/users/lutzroeder/followers",
        "following_url": "https://api.github.com/users/lutzroeder/following{/other_user}",
        "gists_url": "https://api.github.com/users/lutzroeder/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lutzroeder/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lutzroeder/subscriptions",
        "organizations_url": "https://api.github.com/users/lutzroeder/orgs",
        "repos_url": "https://api.github.com/users/lutzroeder/repos",
        "events_url": "https://api.github.com/users/lutzroeder/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lutzroeder/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2021-06-11T04:08:38Z",
      "updated_at": "2022-01-28T06:23:43Z",
      "closed_at": "2021-06-29T10:45:05Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI'm trying to better understand the decisions that led to using a bundle or directory to implement packages.\r\n\r\nFeedback is from prototyping Core ML Model Package support in Netron.\r\n\r\n* Folder support in browsers is limited and not implemented consistently.\r\n* Users can look inside the bundle which contains multiple files with generic extensions like `.json` or `.bin`. Users try to load such files but detecting the format and connection to other assets can be difficult. For example, a loose `.bin` format with no signature is already used by OpenVINO.\r\n* Bundles are macOS specific and not well supported on other platforms. ML frameworks tend to use uncompressed Zip archives to package assets or have a specific model file as an entry point when run from a folder structure. The approach of opening the directory itself is uncommon and requires extra complexity and support.\r\n\r\nSee lutzroeder/netron#749",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1219/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1219/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1214",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1214/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1214/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1214/events",
      "html_url": "https://github.com/apple/coremltools/issues/1214",
      "id": 917932309,
      "node_id": "MDU6SXNzdWU5MTc5MzIzMDk=",
      "number": 1214,
      "title": "Python 3.9 Support",
      "user": {
        "login": "znation",
        "id": 5673251,
        "node_id": "MDQ6VXNlcjU2NzMyNTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5673251?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/znation",
        "html_url": "https://github.com/znation",
        "followers_url": "https://api.github.com/users/znation/followers",
        "following_url": "https://api.github.com/users/znation/following{/other_user}",
        "gists_url": "https://api.github.com/users/znation/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/znation/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/znation/subscriptions",
        "organizations_url": "https://api.github.com/users/znation/orgs",
        "repos_url": "https://api.github.com/users/znation/repos",
        "events_url": "https://api.github.com/users/znation/events{/privacy}",
        "received_events_url": "https://api.github.com/users/znation/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373894,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTQ=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/enhancement",
          "name": "enhancement",
          "color": "c10f47",
          "default": true,
          "description": "Improvement to existing functionality (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2021-06-10T21:14:42Z",
      "updated_at": "2021-10-20T17:22:16Z",
      "closed_at": "2021-07-08T19:12:37Z",
      "author_association": "CONTRIBUTOR",
      "active_lock_reason": null,
      "body": "5.0b1 appears to have a broken import on macOS with Python 3.9.\r\n\r\n```\r\n~: pip install coremltools==5.0b1\r\nCollecting coremltools==5.0b1\r\n...\r\nSuccessfully built coremltools\r\nInstalling collected packages: coremltools\r\nSuccessfully installed coremltools-5.0b1\r\n~: python\r\nPython 3.9.5 (default, May  3 2021, 19:12:05) \r\n[Clang 12.0.5 (clang-1205.0.22.9)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import coremltools\r\nWARNING:root:scikit-learn version 1.0.dev0 is not supported. Minimum required version: 0.17. Maximum required version: 0.19.2. Disabling scikit-learn conversion API.\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/__init__.py\", line 62, in <module>\r\n    from . import converters\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/converters/__init__.py\", line 7, in <module>\r\n    from . import libsvm\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/converters/libsvm/__init__.py\", line 7, in <module>\r\n    from . import _libsvm_converter\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/converters/libsvm/_libsvm_converter.py\", line 9, in <module>\r\n    from coremltools.models import _METADATA_VERSION, _METADATA_SOURCE\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/models/__init__.py\", line 10, in <module>\r\n    from . import pipeline\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/models/pipeline.py\", line 12, in <module>\r\n    from . import model as _model\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/models/model.py\", line 13, in <module>\r\n    from .utils import _has_custom_layer as _has_custom_layer\r\n  File \"/opt/homebrew/lib/python3.9/site-packages/coremltools/models/utils.py\", line 20, in <module>\r\n    from ..libmodelpackage import ModelPackage\r\nModuleNotFoundError: No module named 'coremltools.libmodelpackage'\r\n>>> \r\n```",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1214/reactions",
        "total_count": 1,
        "+1": 1,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1214/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1211",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1211/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1211/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1211/events",
      "html_url": "https://github.com/apple/coremltools/issues/1211",
      "id": 916973719,
      "node_id": "MDU6SXNzdWU5MTY5NzM3MTk=",
      "number": 1211,
      "title": "VNCoreMLTransform request failed in yolov5 converted ml model",
      "user": {
        "login": "dhgokul",
        "id": 5689804,
        "node_id": "MDQ6VXNlcjU2ODk4MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5689804?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dhgokul",
        "html_url": "https://github.com/dhgokul",
        "followers_url": "https://api.github.com/users/dhgokul/followers",
        "following_url": "https://api.github.com/users/dhgokul/following{/other_user}",
        "gists_url": "https://api.github.com/users/dhgokul/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dhgokul/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dhgokul/subscriptions",
        "organizations_url": "https://api.github.com/users/dhgokul/orgs",
        "repos_url": "https://api.github.com/users/dhgokul/repos",
        "events_url": "https://api.github.com/users/dhgokul/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dhgokul/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-06-10T06:46:16Z",
      "updated_at": "2022-03-17T23:44:16Z",
      "closed_at": "2022-03-17T23:44:15Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Trained custom model in yolov5 and converted to it into ml model.\r\nConverted model is tested on x-code. But facing issue:\r\nVNCoreMLTransform request failed ",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1211/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1211/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1202",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1202/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1202/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1202/events",
      "html_url": "https://github.com/apple/coremltools/issues/1202",
      "id": 908186506,
      "node_id": "MDU6SXNzdWU5MDgxODY1MDY=",
      "number": 1202,
      "title": "How to calculate variance using `reduce_mean()` MIL Op?",
      "user": {
        "login": "RahulBhalley",
        "id": 9640948,
        "node_id": "MDQ6VXNlcjk2NDA5NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9640948?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RahulBhalley",
        "html_url": "https://github.com/RahulBhalley",
        "followers_url": "https://api.github.com/users/RahulBhalley/followers",
        "following_url": "https://api.github.com/users/RahulBhalley/following{/other_user}",
        "gists_url": "https://api.github.com/users/RahulBhalley/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/RahulBhalley/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/RahulBhalley/subscriptions",
        "organizations_url": "https://api.github.com/users/RahulBhalley/orgs",
        "repos_url": "https://api.github.com/users/RahulBhalley/repos",
        "events_url": "https://api.github.com/users/RahulBhalley/events{/privacy}",
        "received_events_url": "https://api.github.com/users/RahulBhalley/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 7,
      "created_at": "2021-06-01T11:19:36Z",
      "updated_at": "2021-06-04T17:37:08Z",
      "closed_at": "2021-06-04T17:36:57Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nHow to calculate variance using `reduce_mean()` MIL Op since `variance()` function is not yet available?\r\n\r\nI tried defining variance ([reference](https://en.wikipedia.org/wiki/Standard_deviation)) in PyTorch (my idea is to port this implementation to MIL Ops) using its `mean()` function as follows:\r\n```python\r\nimport torch as t\r\n_ = t.manual_seed(0)\r\n\r\ndef var(x, dim):\r\n  x_mean = t.mean(x)\r\n  sq_devs = t.square(x - x_mean)\r\n  return t.mean(sq_devs, dim=dim)\r\n\r\nx = t.randn(5, 4, 3)\r\nx_var1 = t.var(x, dim=0)\r\nx_var2 = var(x, dim=0)\r\n\r\nprint(\"x:\", x)\r\nprint(\"x_var1:\", x_var1)\r\nprint(\"x_var2:\", x_var2)\r\n```\r\nBut the results vary from PyTorch's official implementation i.e. `x_var1` and `x_var2` are not equal:\r\n```\r\nx: tensor([[[-1.1258, -1.1524, -0.2506],\r\n         [-0.4339,  0.8487,  0.6920],\r\n         [-0.3160, -2.1152,  0.3223],\r\n         [-1.2633,  0.3500,  0.3081]],\r\n\r\n        [[ 0.1198,  1.2377,  1.1168],\r\n         [-0.2473, -1.3527, -1.6959],\r\n         [ 0.5667,  0.7935,  0.5988],\r\n         [-1.5551, -0.3414,  1.8530]],\r\n\r\n        [[ 0.7502, -0.5855, -0.1734],\r\n         [ 0.1835,  1.3894,  1.5863],\r\n         [ 0.9463, -0.8437, -0.6136],\r\n         [ 0.0316, -0.4927,  0.2484]],\r\n\r\n        [[ 0.4397,  0.1124,  0.6408],\r\n         [ 0.4412, -0.1023,  0.7924],\r\n         [-0.2897,  0.0525,  0.5943],\r\n         [ 1.5419,  0.5073, -0.5910]],\r\n\r\n        [[-0.5692,  0.9200,  1.1108],\r\n         [ 1.2899, -1.4959, -0.1938],\r\n         [ 0.4455,  1.3253, -1.6293],\r\n         [-0.5497, -0.4798, -0.4997]]])\r\nx_var1: tensor([[0.5831, 1.0012, 0.4474],\r\n        [0.4593, 1.6567, 1.5645],\r\n        [0.3082, 1.8627, 0.9353],\r\n        [1.5127, 0.2319, 0.9604]])\r\nx_var2: tensor([[0.4835, 0.8038, 0.5476],\r\n        [0.4048, 1.3637, 1.2851],\r\n        [0.2938, 1.5346, 0.7877],\r\n        [1.3801, 0.2065, 0.8126]])\r\n```\r\n\r\n There's some bug in my implementation but IDK where. Can someone please help me solve this problem?\r\n\r\nThanks in advance,\r\nRahul Bhalley\r\n\r\n## System Information\r\n- N/A\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1202/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1202/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1196",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1196/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1196/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1196/events",
      "html_url": "https://github.com/apple/coremltools/issues/1196",
      "id": 900339704,
      "node_id": "MDU6SXNzdWU5MDAzMzk3MDQ=",
      "number": 1196,
      "title": "Can batchedMatmul take advantage of ANE?",
      "user": {
        "login": "xerothermic",
        "id": 575831,
        "node_id": "MDQ6VXNlcjU3NTgzMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/575831?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xerothermic",
        "html_url": "https://github.com/xerothermic",
        "followers_url": "https://api.github.com/users/xerothermic/followers",
        "following_url": "https://api.github.com/users/xerothermic/following{/other_user}",
        "gists_url": "https://api.github.com/users/xerothermic/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xerothermic/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xerothermic/subscriptions",
        "organizations_url": "https://api.github.com/users/xerothermic/orgs",
        "repos_url": "https://api.github.com/users/xerothermic/repos",
        "events_url": "https://api.github.com/users/xerothermic/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xerothermic/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1722445778,
          "node_id": "MDU6TGFiZWwxNzIyNDQ1Nzc4",
          "url": "https://api.github.com/repos/apple/coremltools/labels/CoreML.Framework",
          "name": "CoreML.Framework",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-05-25T06:33:43Z",
      "updated_at": "2021-12-03T20:13:13Z",
      "closed_at": "2021-12-03T20:13:13Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## System Information\r\n- Apple M1 Macbook Pro 16GB\r\n\r\nHi, \r\n\r\nI'm trying to construct some simple network and check what CPU/GPU/ANE devices those operators are performed under. I have some simple codes that uses NeuralNetworkBuilder.add_inner_product or NeuralNetworkBuilder.add_batched_mat_mul APIs. \r\n\r\nWith add_inner_product created network, I can see ANE been used (dmesg | grep ANE)\r\nbut for add_batched_mat_mul, it seems ANE is never invoked.\r\n\r\nIf batchedMatmul can be used in ANE, is there a small example how to do it?\r\n\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1196/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1196/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1193",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1193/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1193/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1193/events",
      "html_url": "https://github.com/apple/coremltools/issues/1193",
      "id": 897715438,
      "node_id": "MDU6SXNzdWU4OTc3MTU0Mzg=",
      "number": 1193,
      "title": "Getting the output from intermediate layers in the mobileNetv2 network ",
      "user": {
        "login": "letdivedeep",
        "id": 74127861,
        "node_id": "MDQ6VXNlcjc0MTI3ODYx",
        "avatar_url": "https://avatars.githubusercontent.com/u/74127861?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/letdivedeep",
        "html_url": "https://github.com/letdivedeep",
        "followers_url": "https://api.github.com/users/letdivedeep/followers",
        "following_url": "https://api.github.com/users/letdivedeep/following{/other_user}",
        "gists_url": "https://api.github.com/users/letdivedeep/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/letdivedeep/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/letdivedeep/subscriptions",
        "organizations_url": "https://api.github.com/users/letdivedeep/orgs",
        "repos_url": "https://api.github.com/users/letdivedeep/repos",
        "events_url": "https://api.github.com/users/letdivedeep/events{/privacy}",
        "received_events_url": "https://api.github.com/users/letdivedeep/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-05-21T06:13:10Z",
      "updated_at": "2022-03-17T23:46:26Z",
      "closed_at": "2022-03-17T23:46:26Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  wanted to add an intermediate layer output as an additional output from the model\r\n\r\n\r\n## System Information\r\n- coremltools 3.4\r\n- tfcoreml 2\r\n\r\nI am trying to get the intermediate layer(add_node) output and merge it into the existing model outputs (confidences and coordinates)\r\n\r\nExperiments :\r\n\r\nWas able to get the add output from the ssd model, also passed this output as an input to decode model stage where i just add a dummy permute node.\r\nIn the NMS model, it has a fixed set of inputs and outputs set by (confidenceInputFeatureName, confidenceOutputFeatureName ..etc) didn't find anything to forcefully create a new input as its set by the NMS_suppression.proto file\r\nSo thought of creating a new model part that takes input as the NMS outputs(confidences and coordinates) and the previous decode layer add_output.\r\nwith this the coreml model is created as attached below.\r\n<img width=\"1100\" alt=\"Screenshot 2021-05-21 at 10 40 11 AM\" src=\"https://user-images.githubusercontent.com/74127861/119089595-088f4f80-ba28-11eb-9ed0-782228c0655c.png\">\r\n\r\nBut while loading it on through python it gives\r\n\r\nan error saying:\r\nRuntimeWarning: You will not be able to run predict() on this Core ML model. Underlying exception message was: Error compiling model: \"Error reading protobuf spec. validator error: Pipeline: Input 'confidence' of model 'CoreML.Specification.ModelDescription' does not match the type previously specified by the pipeline input or the output of a previous model.\".\r\n<img width=\"1612\" alt=\"predict_error\" src=\"https://user-images.githubusercontent.com/74127861/119089659-1e9d1000-ba28-11eb-9c02-c4df88ee3c72.png\">\r\n\r\nI am assuming this error is prompted bcoz the new model created is taking the input, not from the intermediate layer. Can we add a dummy node in the NMS model to bypass this ... any thoughts on this will be helpful or even is this the correct way of doing it.\r\n\r\nI have attached the coreml and convert pythod code used\r\n[Archive.zip](https://github.com/apple/coremltools/files/6520415/Archive.zip)\r\n\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1193/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1193/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1188",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1188/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1188/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1188/events",
      "html_url": "https://github.com/apple/coremltools/issues/1188",
      "id": 888167932,
      "node_id": "MDU6SXNzdWU4ODgxNjc5MzI=",
      "number": 1188,
      "title": "What replace graph_visualization tool?",
      "user": {
        "login": "xerothermic",
        "id": 575831,
        "node_id": "MDQ6VXNlcjU3NTgzMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/575831?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xerothermic",
        "html_url": "https://github.com/xerothermic",
        "followers_url": "https://api.github.com/users/xerothermic/followers",
        "following_url": "https://api.github.com/users/xerothermic/following{/other_user}",
        "gists_url": "https://api.github.com/users/xerothermic/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xerothermic/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xerothermic/subscriptions",
        "organizations_url": "https://api.github.com/users/xerothermic/orgs",
        "repos_url": "https://api.github.com/users/xerothermic/repos",
        "events_url": "https://api.github.com/users/xerothermic/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xerothermic/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-05-11T18:37:54Z",
      "updated_at": "2021-05-11T19:29:18Z",
      "closed_at": "2021-05-11T19:29:18Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##Question\r\n\r\nHi, I'm trying to visualize the neural network topology from a .mlmodel file. I can extract the spec file, but couldn't find a tool to visualize the neural network nodes.\r\n\r\nI saw from the git history there was some work around visualization in coremltools/graph_visualization folder but it disappeared after Sync cormeltools-4.0b1 (#731).\r\n\r\nCan you please tell us what's the current way of visualizing the spec info?\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1188/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1188/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1184",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1184/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1184/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1184/events",
      "html_url": "https://github.com/apple/coremltools/issues/1184",
      "id": 878094615,
      "node_id": "MDU6SXNzdWU4NzgwOTQ2MTU=",
      "number": 1184,
      "title": "How to control output layers with CoreML?",
      "user": {
        "login": "djacobs7",
        "id": 34345,
        "node_id": "MDQ6VXNlcjM0MzQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/34345?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/djacobs7",
        "html_url": "https://github.com/djacobs7",
        "followers_url": "https://api.github.com/users/djacobs7/followers",
        "following_url": "https://api.github.com/users/djacobs7/following{/other_user}",
        "gists_url": "https://api.github.com/users/djacobs7/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/djacobs7/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/djacobs7/subscriptions",
        "organizations_url": "https://api.github.com/users/djacobs7/orgs",
        "repos_url": "https://api.github.com/users/djacobs7/repos",
        "events_url": "https://api.github.com/users/djacobs7/events{/privacy}",
        "received_events_url": "https://api.github.com/users/djacobs7/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 6,
      "created_at": "2021-05-06T21:59:44Z",
      "updated_at": "2022-03-25T18:31:23Z",
      "closed_at": "2022-03-25T18:31:23Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI'm trying to convert a pytorch model to coreml. The model was based on yolov5.  \r\n\r\nHere is a netron view our our exported coreml model.\r\n![Screen Shot 2021-05-07 at 6 01 48 PM](https://user-images.githubusercontent.com/34345/117520696-64ed6c00-af5e-11eb-9d42-37aa70f65e83.png)\r\n\r\n\r\n\r\nCurrently, the architecture has 3 outputs.  You can see one of the outputs in the screenshot, number '740'.  \r\n\r\nHowever, we want a different output from coreml.  We need  to get the output before the reshapeStatic and transpose layers. So in this image you can see that we need the last convolution layer instead of 740.\r\n\r\nThose reshapeStatic and transpose layers were added by the process which convert the net to coreML, they are not organic layers of yolov5. \r\n\r\n1) Is there any way we can do the conversion to coreml differently in order to have more control over which layers are output?  For example, can we have control over the output layers in the sample code below: \r\n```\r\nmodel = ct.convert(\r\n    traced_model,\r\n    inputs=[ct.ImageType(name=\"input_1\", shape=example_input.shape)], \r\n    classifier_config = ct.ClassifierConfig(class_labels) )\r\n\r\n```\r\n\r\n\r\n2) Alternatively, is there a way where we can choose at runtime which values to pull out of the coreml model?  For example, is there a way to specify in the code below which layers we want to output?\r\n ```\r\nimg = load_image(img_path, resize_to=(img_size, img_size))\r\n//can we specify here which layers to output?\r\n coreml_out_dict = model.predict({'image': img})\r\n```\r\n\r\nThanks! ",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1184/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1184/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1170",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1170/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1170/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1170/events",
      "html_url": "https://github.com/apple/coremltools/issues/1170",
      "id": 867797846,
      "node_id": "MDU6SXNzdWU4Njc3OTc4NDY=",
      "number": 1170,
      "title": "Message CoreML.Specification.Model exceeds maximum protobuf size of 2GB",
      "user": {
        "login": "demangejeremy",
        "id": 13614630,
        "node_id": "MDQ6VXNlcjEzNjE0NjMw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13614630?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/demangejeremy",
        "html_url": "https://github.com/demangejeremy",
        "followers_url": "https://api.github.com/users/demangejeremy/followers",
        "following_url": "https://api.github.com/users/demangejeremy/following{/other_user}",
        "gists_url": "https://api.github.com/users/demangejeremy/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/demangejeremy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/demangejeremy/subscriptions",
        "organizations_url": "https://api.github.com/users/demangejeremy/orgs",
        "repos_url": "https://api.github.com/users/demangejeremy/repos",
        "events_url": "https://api.github.com/users/demangejeremy/events{/privacy}",
        "received_events_url": "https://api.github.com/users/demangejeremy/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-04-26T14:57:33Z",
      "updated_at": "2022-03-25T17:56:10Z",
      "closed_at": "2022-03-25T17:56:10Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nHello, do you know how to increase the 2Gb limit for a model? I want to reproduce the GPT-2XL model with CoreML to make an API / Server under Swift and under Mac M1. Thanks a lot!",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1170/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1170/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1169",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1169/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1169/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1169/events",
      "html_url": "https://github.com/apple/coremltools/issues/1169",
      "id": 866914500,
      "node_id": "MDU6SXNzdWU4NjY5MTQ1MDA=",
      "number": 1169,
      "title": "How load mlmodel file in memory ?",
      "user": {
        "login": "wangzhaode",
        "id": 8401806,
        "node_id": "MDQ6VXNlcjg0MDE4MDY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8401806?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/wangzhaode",
        "html_url": "https://github.com/wangzhaode",
        "followers_url": "https://api.github.com/users/wangzhaode/followers",
        "following_url": "https://api.github.com/users/wangzhaode/following{/other_user}",
        "gists_url": "https://api.github.com/users/wangzhaode/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/wangzhaode/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/wangzhaode/subscriptions",
        "organizations_url": "https://api.github.com/users/wangzhaode/orgs",
        "repos_url": "https://api.github.com/users/wangzhaode/repos",
        "events_url": "https://api.github.com/users/wangzhaode/events{/privacy}",
        "received_events_url": "https://api.github.com/users/wangzhaode/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 5,
      "created_at": "2021-04-25T05:09:55Z",
      "updated_at": "2022-03-25T00:34:48Z",
      "closed_at": "2022-03-25T00:34:48Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I used coremltools generate a mlmodel in memory when APP is running and want inference it. But there only has an API: compileModelAtURL, that just support load a mlmodel from file. So I want now is there an API can load mlmodel from memory?",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1169/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1169/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1166",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1166/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1166/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1166/events",
      "html_url": "https://github.com/apple/coremltools/issues/1166",
      "id": 863911695,
      "node_id": "MDU6SXNzdWU4NjM5MTE2OTU=",
      "number": 1166,
      "title": "PyTorch convert function for op 'hardswish_' not implemented.",
      "user": {
        "login": "MykolaRobot",
        "id": 31663923,
        "node_id": "MDQ6VXNlcjMxNjYzOTIz",
        "avatar_url": "https://avatars.githubusercontent.com/u/31663923?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MykolaRobot",
        "html_url": "https://github.com/MykolaRobot",
        "followers_url": "https://api.github.com/users/MykolaRobot/followers",
        "following_url": "https://api.github.com/users/MykolaRobot/following{/other_user}",
        "gists_url": "https://api.github.com/users/MykolaRobot/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/MykolaRobot/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/MykolaRobot/subscriptions",
        "organizations_url": "https://api.github.com/users/MykolaRobot/orgs",
        "repos_url": "https://api.github.com/users/MykolaRobot/repos",
        "events_url": "https://api.github.com/users/MykolaRobot/events{/privacy}",
        "received_events_url": "https://api.github.com/users/MykolaRobot/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        },
        {
          "id": 2870915972,
          "node_id": "MDU6TGFiZWwyODcwOTE1OTcy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/missing%20layer%20type",
          "name": "missing layer type",
          "color": "0052cc",
          "default": false,
          "description": "Unable to convert a layer type from the relevant framework"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": {
        "login": "TobyRoseman",
        "id": 5420744,
        "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TobyRoseman",
        "html_url": "https://github.com/TobyRoseman",
        "followers_url": "https://api.github.com/users/TobyRoseman/followers",
        "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
        "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
        "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
        "repos_url": "https://api.github.com/users/TobyRoseman/repos",
        "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
        "type": "User",
        "site_admin": false
      },
      "assignees": [
        {
          "login": "TobyRoseman",
          "id": 5420744,
          "node_id": "MDQ6VXNlcjU0MjA3NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5420744?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TobyRoseman",
          "html_url": "https://github.com/TobyRoseman",
          "followers_url": "https://api.github.com/users/TobyRoseman/followers",
          "following_url": "https://api.github.com/users/TobyRoseman/following{/other_user}",
          "gists_url": "https://api.github.com/users/TobyRoseman/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/TobyRoseman/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/TobyRoseman/subscriptions",
          "organizations_url": "https://api.github.com/users/TobyRoseman/orgs",
          "repos_url": "https://api.github.com/users/TobyRoseman/repos",
          "events_url": "https://api.github.com/users/TobyRoseman/events{/privacy}",
          "received_events_url": "https://api.github.com/users/TobyRoseman/received_events",
          "type": "User",
          "site_admin": false
        }
      ],
      "milestone": null,
      "comments": 8,
      "created_at": "2021-04-21T13:47:05Z",
      "updated_at": "2022-02-22T23:45:04Z",
      "closed_at": "2022-02-22T23:45:04Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I was trying to convert pytorch DeepLAbV3 (mobilenetv3) model to coreml. During convertion error happened. Error text:\r\n\"PyTorch convert function for op 'hardswish_' not implemented.\"\r\n\r\nHow can I fix it without changing model architecture? Somehow declare this function for coremltools?\r\nThanks!",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1166/reactions",
        "total_count": 1,
        "+1": 1,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1166/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1160",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1160/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1160/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1160/events",
      "html_url": "https://github.com/apple/coremltools/issues/1160",
      "id": 856999905,
      "node_id": "MDU6SXNzdWU4NTY5OTk5MDU=",
      "number": 1160,
      "title": "Preprocess image - Normalize by mean and std",
      "user": {
        "login": "yonatanbitton",
        "id": 26148975,
        "node_id": "MDQ6VXNlcjI2MTQ4OTc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/26148975?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yonatanbitton",
        "html_url": "https://github.com/yonatanbitton",
        "followers_url": "https://api.github.com/users/yonatanbitton/followers",
        "following_url": "https://api.github.com/users/yonatanbitton/following{/other_user}",
        "gists_url": "https://api.github.com/users/yonatanbitton/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/yonatanbitton/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yonatanbitton/subscriptions",
        "organizations_url": "https://api.github.com/users/yonatanbitton/orgs",
        "repos_url": "https://api.github.com/users/yonatanbitton/repos",
        "events_url": "https://api.github.com/users/yonatanbitton/events{/privacy}",
        "received_events_url": "https://api.github.com/users/yonatanbitton/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1433418622,
          "node_id": "MDU6TGFiZWwxNDMzNDE4NjIy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/docs",
          "name": "docs",
          "color": "c10f47",
          "default": false,
          "description": "Contains documentation or clarification regarding docs (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": {
        "login": "tonybove-apple",
        "id": 70229264,
        "node_id": "MDQ6VXNlcjcwMjI5MjY0",
        "avatar_url": "https://avatars.githubusercontent.com/u/70229264?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tonybove-apple",
        "html_url": "https://github.com/tonybove-apple",
        "followers_url": "https://api.github.com/users/tonybove-apple/followers",
        "following_url": "https://api.github.com/users/tonybove-apple/following{/other_user}",
        "gists_url": "https://api.github.com/users/tonybove-apple/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tonybove-apple/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tonybove-apple/subscriptions",
        "organizations_url": "https://api.github.com/users/tonybove-apple/orgs",
        "repos_url": "https://api.github.com/users/tonybove-apple/repos",
        "events_url": "https://api.github.com/users/tonybove-apple/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tonybove-apple/received_events",
        "type": "User",
        "site_admin": false
      },
      "assignees": [
        {
          "login": "tonybove-apple",
          "id": 70229264,
          "node_id": "MDQ6VXNlcjcwMjI5MjY0",
          "avatar_url": "https://avatars.githubusercontent.com/u/70229264?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/tonybove-apple",
          "html_url": "https://github.com/tonybove-apple",
          "followers_url": "https://api.github.com/users/tonybove-apple/followers",
          "following_url": "https://api.github.com/users/tonybove-apple/following{/other_user}",
          "gists_url": "https://api.github.com/users/tonybove-apple/gists{/gist_id}",
          "starred_url": "https://api.github.com/users/tonybove-apple/starred{/owner}{/repo}",
          "subscriptions_url": "https://api.github.com/users/tonybove-apple/subscriptions",
          "organizations_url": "https://api.github.com/users/tonybove-apple/orgs",
          "repos_url": "https://api.github.com/users/tonybove-apple/repos",
          "events_url": "https://api.github.com/users/tonybove-apple/events{/privacy}",
          "received_events_url": "https://api.github.com/users/tonybove-apple/received_events",
          "type": "User",
          "site_admin": false
        }
      ],
      "milestone": null,
      "comments": 5,
      "created_at": "2021-04-13T14:08:07Z",
      "updated_at": "2021-11-03T21:02:45Z",
      "closed_at": "2021-11-03T21:02:45Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Hello, I have an `mlmodel`,  which was created by this conversion:\r\n```python\r\ninput = ct.ImageType(name='input', shape=(1, 256, 192, 3), color_layout='BGR')\r\nmlmodel = ct.convert(model, inputs=[input], minimum_deployment_target=ct.target.iOS13)\r\n```\r\nNow, my image needs to be normalized before feeding it to the model.\r\nI have a `pixelBuffer: CVPixelBuffer`.\r\n\r\nHow can I normalize it with given std and mean? \r\n\r\nThis is how it's being done in python (From [here](https://github.com/HirataYurina/simple-pose-estimation-torch-techi/blob/master/predict.py)):\r\n   ```python\r\n parser.add_argument('--std', type=list, default=[0.229, 0.224, 0.225],\r\n                        help='the std used to normalize your images')\r\n    parser.add_argument('--mean', type=list, default=[0.485, 0.456, 0.406],\r\n                        help='the mean used to normalize your images')\r\n\r\n    normalize = transforms.Normalize(std=args.std,\r\n                                     mean=args.mean)\r\n\r\n    transformation = transforms.Compose([transforms.ToTensor()])\r\n\r\n    man_normalize = transformation(man_resize)\r\n\r\n```\r\n\r\nThis is how it's being done in Android:\r\n\r\n```java\r\n@Override\r\n  | protected void addPixelValue(int pixelValue) {\r\n  | imgData.putFloat((((pixelValue >> 16) & 0xFF)/255f - IMAGE_MEAN[0]) / IMAGE_STD[0]);\r\n  | imgData.putFloat((((pixelValue >> 8) & 0xFF)/255f - IMAGE_MEAN[1]) / IMAGE_STD[1]);\r\n  | imgData.putFloat(((pixelValue & 0xFF)/255f - IMAGE_MEAN[2]) / IMAGE_STD[2]);\r\n  | }\r\n\r\n```\r\n\r\nHow can I do similar thing in Swift application?\r\n\r\nI would really appreciate any help. Thanks.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1160/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1160/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1159",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1159/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1159/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1159/events",
      "html_url": "https://github.com/apple/coremltools/issues/1159",
      "id": 855591346,
      "node_id": "MDU6SXNzdWU4NTU1OTEzNDY=",
      "number": 1159,
      "title": "app crash when load mlmodel with modelWithContentsOfURL:configuration:error",
      "user": {
        "login": "ToBigboss",
        "id": 40013733,
        "node_id": "MDQ6VXNlcjQwMDEzNzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/40013733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ToBigboss",
        "html_url": "https://github.com/ToBigboss",
        "followers_url": "https://api.github.com/users/ToBigboss/followers",
        "following_url": "https://api.github.com/users/ToBigboss/following{/other_user}",
        "gists_url": "https://api.github.com/users/ToBigboss/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ToBigboss/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ToBigboss/subscriptions",
        "organizations_url": "https://api.github.com/users/ToBigboss/orgs",
        "repos_url": "https://api.github.com/users/ToBigboss/repos",
        "events_url": "https://api.github.com/users/ToBigboss/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ToBigboss/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-04-12T06:15:06Z",
      "updated_at": "2021-04-14T00:28:48Z",
      "closed_at": "2021-04-14T00:28:47Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nApp probabilistic crash when load mlmodel with modelWithContentsOfURL:configuration:error\r\n\r\ncrash stack\r\n0  Espresso                       0x1b3d38c10 Espresso::cpu_context_transfer_algo_t::cpu_context_transfer_algo_t(Espresso::cpu_context_transfer_algo_options const&) + 228\r\n1  Espresso                       0x1b3d9e13c std::__1::__shared_ptr_emplace<Espresso::cpu_context_transfer_algo_t, std::__1::allocator<Espresso::cpu_context_transfer_algo_t> >::__shared_ptr_emplace<Espresso::cpu_context_transfer_algo_options&>(std::__1::allocator<Espresso::cpu_context_transfer_algo_t>, Espresso::cpu_context_transfer_algo_options&) + 48\r\n2  Espresso                       0x1b3d9b054 Espresso::get_net_info_ir(std::__1::shared_ptr<Espresso::abstract_context>, std::__1::shared_ptr<Espresso::net>, std::__1::vector<std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object>, std::__1::allocator<std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object> > > const&, Espresso::network_shape const&, Espresso::compute_path const&, Espresso::platform const&, Espresso::compute_path const&, std::__1::shared_ptr<Espresso::cpu_context_transfer_algo_t>&, std::__1::shared_ptr<Espresso::net_info_ir_t>&, std::__1::shared_ptr<Espresso::kernels_validation_status_t>&) + 440\r\n3  Espresso                       0x1b3d9b450 try_dispatch(std::__1::shared_ptr<Espresso::abstract_context>, std::__1::shared_ptr<Espresso::net>, std::__1::vector<std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object>, std::__1::allocator<std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object> > > const&, Espresso::network_shape const&, Espresso::compute_path const&, std::__1::basic_istream<char, std::__1::char_traits<char> >*, Espresso::platform const&, Espresso::compute_path const&) + 468\r\n4  Espresso                       0x1b3d9c56c Espresso::run_dispatch_v2(std::__1::shared_ptr<Espresso::abstract_context>, std::__1::shared_ptr<Espresso::net>, std::__1::vector<std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object>, std::__1::allocator<std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object> > > const&, Espresso::network_shape const&, Espresso::compute_path const&, std::__1::basic_istream<char, std::__1::char_traits<char> >*) + 1680\r\n5  Espresso                       0x1b3dac470 Espresso::load_network_layers_internal(std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object>, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<Espresso::abstract_context> const&, Espresso::network_shape const&, std::__1::basic_istream<char, std::__1::char_traits<char> >*, Espresso::compute_path, bool, std::__1::shared_ptr<Espresso::blob_storage_abstract> const&) + 244\r\n6  Espresso                       0x1b3da8850 Espresso::load_and_shape_network(std::__1::shared_ptr<Espresso::SerDes::generic_serdes_object> const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<Espresso::abstract_context> const&, Espresso::network_shape const&, Espresso::compute_path, std::__1::shared_ptr<Espresso::blob_storage_abstract> const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) + 508\r\n7  Espresso                       0x1b3dab31c Espresso::load_network(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<Espresso::abstract_context> const&, Espresso::compute_path, bool) + 1892\r\n8  Espresso                       0x1b3ccce60 EspressoLight::espresso_plan::add_network(char const*, espresso_storage_type_t) + 304\r\n9  Espresso                       0x1b3cdb2d0 espresso_plan_add_network + 340\r\n10 CoreML                         0x1b389c36c -[MLNeuralNetworkEngine _setupContextAndPlanWithConfiguration:usingCPU:error:] + 752\r\n11 CoreML                         0x1b389d754 -[MLNeuralNetworkEngine initWithContainer:configuration:error:] + 384\r\n12 CoreML                         0x1b38a28e8 +[MLNeuralNetworkEngine loadModelFromCompiledArchive:modelVersionInfo:compilerVersionInfo:configuration:error:] + 208\r\n13 CoreML                         0x1b38f4cb0 +[MLLoader loadModelFromArchive:configuration:loaderEvent:error:] + 624\r\n14 CoreML                         0x1b38f61ec +[MLLoader loadModelFromAssetAtURL:configuration:loaderEvent:error:] + 280\r\n15 CoreML                         0x1b38f648c +[MLLoader loadModelFromAssetAtURL:configuration:error:] + 120\r\n16 CoreML                         0x1b38dcacc -[MLModelAsset load:] + 220\r\n17 CoreML                         0x1b38dc8d0 -[MLModelAsset modelWithError:] + 68\r\n18 CoreML                         0x1b391f28c +[MLModel modelWithContentsOfURL:configuration:error:] + 156\r\n19 appName                      0x105156438 XYAIBridge::CoremlInit(char const*, XYAIBridge::tag_Config const&, void**) + 4385399864\r\n\r\nLoad the mlmodel code\r\n`  if (@available(iOS 12.0, *)) {\r\n    MLModelConfiguration* config = [MLModelConfiguration alloc];\r\n    config.computeUnits = MLComputeUnitsAll;\r\n    _model = [MLModel modelWithContentsOfURL:compileUrl configuration:config error:&error];\r\n  } else {\r\n    _model = [MLModel modelWithContentsOfURL:compileUrl error:&error];\r\n  }`\r\n\r\n## System Information\r\niPhone 11\r\niOS 14\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1159/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1159/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1150",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1150/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1150/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1150/events",
      "html_url": "https://github.com/apple/coremltools/issues/1150",
      "id": 841503104,
      "node_id": "MDU6SXNzdWU4NDE1MDMxMDQ=",
      "number": 1150,
      "title": "Support of iOS 10 and macOS 10.13",
      "user": {
        "login": "rose-jinyang",
        "id": 47862419,
        "node_id": "MDQ6VXNlcjQ3ODYyNDE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/47862419?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rose-jinyang",
        "html_url": "https://github.com/rose-jinyang",
        "followers_url": "https://api.github.com/users/rose-jinyang/followers",
        "following_url": "https://api.github.com/users/rose-jinyang/following{/other_user}",
        "gists_url": "https://api.github.com/users/rose-jinyang/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rose-jinyang/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rose-jinyang/subscriptions",
        "organizations_url": "https://api.github.com/users/rose-jinyang/orgs",
        "repos_url": "https://api.github.com/users/rose-jinyang/repos",
        "events_url": "https://api.github.com/users/rose-jinyang/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rose-jinyang/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [

      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-03-26T01:15:57Z",
      "updated_at": "2021-07-13T00:20:49Z",
      "closed_at": "2021-07-13T00:20:49Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\n- A clear and concise description of what the problem is.\r\nI found that the latest version of this tool supports minimum iOS10 and macOS 10.13.\r\nI need a model for iOS10 and macOS10.13.\r\n\r\n- CoreML / iOS version you are using?\r\niOS10\r\n\r\n- Are you interested in contributing?\r\nNo\r\n\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1150/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1150/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1149",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1149/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1149/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1149/events",
      "html_url": "https://github.com/apple/coremltools/issues/1149",
      "id": 840767077,
      "node_id": "MDU6SXNzdWU4NDA3NjcwNzc=",
      "number": 1149,
      "title": "Does CoreML not support TensorType as input on ANE?",
      "user": {
        "login": "lyj96",
        "id": 21219022,
        "node_id": "MDQ6VXNlcjIxMjE5MDIy",
        "avatar_url": "https://avatars.githubusercontent.com/u/21219022?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lyj96",
        "html_url": "https://github.com/lyj96",
        "followers_url": "https://api.github.com/users/lyj96/followers",
        "following_url": "https://api.github.com/users/lyj96/following{/other_user}",
        "gists_url": "https://api.github.com/users/lyj96/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lyj96/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lyj96/subscriptions",
        "organizations_url": "https://api.github.com/users/lyj96/orgs",
        "repos_url": "https://api.github.com/users/lyj96/repos",
        "events_url": "https://api.github.com/users/lyj96/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lyj96/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 0,
      "created_at": "2021-03-25T10:06:01Z",
      "updated_at": "2021-03-26T08:21:11Z",
      "closed_at": "2021-03-26T08:21:11Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI have two CoreML models. The model using ImageType works well, but another model using TensorType generates this error message:\r\n\r\n`[espresso] ANE Batch: Async request 1 returned error: code=5 err=Error Domain=com.apple.appleneuralengine Code=5 \"processRequest:qos:qIndex:modelStringID:options:error:: 0x3: Program Inference overflow\" UserInfo={NSLocalizedDescription=processRequest:qos:qIndex:modelStringID:options:error:: 0x3: Program Inference overflow}\r\n[espresso] [Espresso::overflow_error]\r\n`\r\n\r\nBoth models are very similar,only the input type is different.",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1149/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1149/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1148",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1148/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1148/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1148/events",
      "html_url": "https://github.com/apple/coremltools/issues/1148",
      "id": 840764510,
      "node_id": "MDU6SXNzdWU4NDA3NjQ1MTA=",
      "number": 1148,
      "title": "Image and  multi-array as input got different results throught the same model?",
      "user": {
        "login": "MrCrazyCrab",
        "id": 52489106,
        "node_id": "MDQ6VXNlcjUyNDg5MTA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/52489106?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MrCrazyCrab",
        "html_url": "https://github.com/MrCrazyCrab",
        "followers_url": "https://api.github.com/users/MrCrazyCrab/followers",
        "following_url": "https://api.github.com/users/MrCrazyCrab/following{/other_user}",
        "gists_url": "https://api.github.com/users/MrCrazyCrab/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/MrCrazyCrab/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/MrCrazyCrab/subscriptions",
        "organizations_url": "https://api.github.com/users/MrCrazyCrab/orgs",
        "repos_url": "https://api.github.com/users/MrCrazyCrab/repos",
        "events_url": "https://api.github.com/users/MrCrazyCrab/events{/privacy}",
        "received_events_url": "https://api.github.com/users/MrCrazyCrab/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-03-25T10:03:18Z",
      "updated_at": "2021-10-22T21:16:39Z",
      "closed_at": "2021-10-22T21:16:39Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## System Information\r\n- If applicable\r\n\r\n\r\ni change my Core ML model input from multiArray to image input, but when i run it, i got different result. For example, Both the input size is (3,512,512), and the multiArray'output is 512 * 512, which is right. However, the image'output is 4 * 512 * 512, whose value is zero. How can i to deal it?\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1148/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1148/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1147",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1147/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1147/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1147/events",
      "html_url": "https://github.com/apple/coremltools/issues/1147",
      "id": 840115866,
      "node_id": "MDU6SXNzdWU4NDAxMTU4NjY=",
      "number": 1147,
      "title": "How to add sound preprocessing into a coreml model that is converted from tf1?",
      "user": {
        "login": "elyorman",
        "id": 60263344,
        "node_id": "MDQ6VXNlcjYwMjYzMzQ0",
        "avatar_url": "https://avatars.githubusercontent.com/u/60263344?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/elyorman",
        "html_url": "https://github.com/elyorman",
        "followers_url": "https://api.github.com/users/elyorman/followers",
        "following_url": "https://api.github.com/users/elyorman/following{/other_user}",
        "gists_url": "https://api.github.com/users/elyorman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/elyorman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/elyorman/subscriptions",
        "organizations_url": "https://api.github.com/users/elyorman/orgs",
        "repos_url": "https://api.github.com/users/elyorman/repos",
        "events_url": "https://api.github.com/users/elyorman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/elyorman/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-03-24T19:54:25Z",
      "updated_at": "2021-03-24T21:38:28Z",
      "closed_at": "2021-03-24T21:38:28Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nI have converted a sound classier model from tf1 and having an issue in making a pipeline that takes the preprocessing and classifier models. Can anyone help? \r\n## System Information\r\n- If applicable\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1147/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1147/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1143",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1143/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1143/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1143/events",
      "html_url": "https://github.com/apple/coremltools/issues/1143",
      "id": 838336018,
      "node_id": "MDU6SXNzdWU4MzgzMzYwMTg=",
      "number": 1143,
      "title": "How to modify inputs and classifier_config of existing MLModel",
      "user": {
        "login": "willbattel",
        "id": 13490339,
        "node_id": "MDQ6VXNlcjEzNDkwMzM5",
        "avatar_url": "https://avatars.githubusercontent.com/u/13490339?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willbattel",
        "html_url": "https://github.com/willbattel",
        "followers_url": "https://api.github.com/users/willbattel/followers",
        "following_url": "https://api.github.com/users/willbattel/following{/other_user}",
        "gists_url": "https://api.github.com/users/willbattel/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/willbattel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/willbattel/subscriptions",
        "organizations_url": "https://api.github.com/users/willbattel/orgs",
        "repos_url": "https://api.github.com/users/willbattel/repos",
        "events_url": "https://api.github.com/users/willbattel/events{/privacy}",
        "received_events_url": "https://api.github.com/users/willbattel/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-03-23T04:23:41Z",
      "updated_at": "2021-03-23T22:13:54Z",
      "closed_at": "2021-03-23T22:13:54Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nI have a CoreML image classification model that was exported from Google's AutoML Vision service with a suboptimal configuration. The model is currently configured to have a `MLMultiArray` input instead of an `Image` input optimal for image-based models. Also, I would like to change the `classifier_config` to include the labels.\r\n\r\nIn essense, I am trying to figure out how to run the equivalent of this:\r\n\r\n```\r\nimport coremltools as ct\r\nlabels = ['foo', 'bar', 'baz']\r\nmlmodel = ct.models.MLModel('path/to/my.mlmodel')\r\noptimal_model = ct.convert(mlmodel, inputs=[ct.ImageType()], classifier_config=ct.ClassifierConfig(labels))\r\n```\r\n\r\nUnfortunately, there is not an easy way to access the pre-converted model and I cannot re-convert an MLModel to add these properties. I searched [the docs][1] but didn't see any means of changing these on the existing MLModel. I would have thought this would be easy to change but now I'm not so sure.\r\n\r\n\r\n  [1]: https://coremltools.readme.io/docs/mlmodel\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1143/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1143/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1141",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1141/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1141/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1141/events",
      "html_url": "https://github.com/apple/coremltools/issues/1141",
      "id": 837568302,
      "node_id": "MDU6SXNzdWU4Mzc1NjgzMDI=",
      "number": 1141,
      "title": "ValueError: x should be at least rank 3",
      "user": {
        "login": "CoCa520",
        "id": 22894599,
        "node_id": "MDQ6VXNlcjIyODk0NTk5",
        "avatar_url": "https://avatars.githubusercontent.com/u/22894599?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/CoCa520",
        "html_url": "https://github.com/CoCa520",
        "followers_url": "https://api.github.com/users/CoCa520/followers",
        "following_url": "https://api.github.com/users/CoCa520/following{/other_user}",
        "gists_url": "https://api.github.com/users/CoCa520/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/CoCa520/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/CoCa520/subscriptions",
        "organizations_url": "https://api.github.com/users/CoCa520/orgs",
        "repos_url": "https://api.github.com/users/CoCa520/repos",
        "events_url": "https://api.github.com/users/CoCa520/events{/privacy}",
        "received_events_url": "https://api.github.com/users/CoCa520/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 6,
      "created_at": "2021-03-22T10:21:27Z",
      "updated_at": "2021-03-25T01:25:24Z",
      "closed_at": "2021-03-25T01:25:24Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## convert rnet error\r\n\r\n## System Information\r\n* Python 3.7.6 \r\n* torch    1.4.0\r\n* coremltools     4.1\r\n\r\n### when I use this tool convert rnet of mtcnn, I got this error: ValueError: x should be at least rank 3, how can I fix it?\r\n### this is the Struct of rnet:\r\n```\r\n        self.conv1 = nn.Conv2d(3, 28, kernel_size=3)\r\n        self.prelu1 = nn.PReLU(28)\r\n        self.pool1 = nn.MaxPool2d(3, 2, ceil_mode=True)\r\n        self.conv2 = nn.Conv2d(28, 48, kernel_size=3)\r\n        self.prelu2 = nn.PReLU(48)\r\n        self.pool2 = nn.MaxPool2d(3, 2, ceil_mode=True)\r\n        self.conv3 = nn.Conv2d(48, 64, kernel_size=2)\r\n        self.prelu3 = nn.PReLU(64)\r\n        self.dense4 = nn.Linear(576, 128)\r\n        self.prelu4 = nn.PReLU(128)\r\n        self.dense5_1 = nn.Linear(128, 2)\r\n        self.dense5_2 = nn.Linear(128, 4)\r\n        self.dense5_3 = nn.Linear(128, 10)\r\n\r\n        self.apply(weights_init)\r\n\r\n    def forward(self, x):\r\n        x = self.conv1(x)\r\n        x = self.prelu1(x)\r\n        x = self.pool1(x)\r\n        x = self.conv2(x)\r\n        x = self.prelu2(x)\r\n        x = self.pool2(x)\r\n        x = self.conv3(x)\r\n        x = self.prelu3(x)\r\n        x = x.view(x.size(0), -1)\r\n        x = self.dense4(x)\r\n        x = self.prelu4(x)\r\n        c = self.dense5_1(x)\r\n        b = self.dense5_2(x)\r\n        l = self.dense5_3(x)\r\n        return c, b, l\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1141/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1141/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1132",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1132/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1132/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1132/events",
      "html_url": "https://github.com/apple/coremltools/issues/1132",
      "id": 829455354,
      "node_id": "MDU6SXNzdWU4Mjk0NTUzNTQ=",
      "number": 1132,
      "title": "PyTorch convert function for op 'index' not implemented.",
      "user": {
        "login": "Ostroverkhov",
        "id": 20270559,
        "node_id": "MDQ6VXNlcjIwMjcwNTU5",
        "avatar_url": "https://avatars.githubusercontent.com/u/20270559?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Ostroverkhov",
        "html_url": "https://github.com/Ostroverkhov",
        "followers_url": "https://api.github.com/users/Ostroverkhov/followers",
        "following_url": "https://api.github.com/users/Ostroverkhov/following{/other_user}",
        "gists_url": "https://api.github.com/users/Ostroverkhov/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Ostroverkhov/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Ostroverkhov/subscriptions",
        "organizations_url": "https://api.github.com/users/Ostroverkhov/orgs",
        "repos_url": "https://api.github.com/users/Ostroverkhov/repos",
        "events_url": "https://api.github.com/users/Ostroverkhov/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Ostroverkhov/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-03-11T19:26:09Z",
      "updated_at": "2021-03-12T00:37:10Z",
      "closed_at": "2021-03-12T00:37:09Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nHow to fix this problem?\r\n\r\nCode:\r\n```\r\nimport torch\r\nimport coremltools as ct \r\n\r\nclass Test(torch.nn.Module):\r\n    def __init__(self):\r\n        super(Test, self).__init__()\r\n    \r\n    def forward(self, inp):\r\n        return inp[inp > 0.2]\r\n\r\ntest = Test()\r\ntest.eval()\r\n\r\nscripted_model = torch.jit.script(test)\r\n\r\ntensor_input = ct.TensorType(\r\n    name='tensor', \r\n    shape=example.shape)\r\n\r\nmodel = ct.convert(\r\n    scripted_model,\r\n    inputs=[tensor_input])\r\n```\r\n\r\nTrace:\r\n```\r\nConverting Frontend ==> MIL Ops:  75%|  | 3/4 [00:00<00:00, 6783.24 ops/s]\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-369-f44910ed816b> in <module>\r\n      3     shape=example.shape)\r\n      4 \r\n----> 5 model = ct.convert(\r\n      6     scripted_model,\r\n      7     inputs=[tensor_input])\r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/_converters_entry.py in convert(model, source, inputs, outputs, classifier_config, minimum_deployment_target, convert_to, **kwargs)\r\n    174         **kwargs)\r\n    175 \r\n--> 176     mlmodel = mil_convert(\r\n    177         model,\r\n    178         convert_from=exact_source,\r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in mil_convert(model, convert_from, convert_to, **kwargs)\r\n    126         See `coremltools.converters.convert`\r\n    127     \"\"\"\r\n--> 128     proto = mil_convert_to_proto(model, convert_from, convert_to,\r\n    129         ConverterRegistry, **kwargs)\r\n    130     if convert_to == 'mil':\r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in mil_convert_to_proto(model, convert_from, convert_to, converter_registry, **kwargs)\r\n    169     frontend_converter = frontend_converter_type()\r\n    170 \r\n--> 171     prog = frontend_converter(model, **kwargs)\r\n    172     common_pass(prog)\r\n    173 \r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/converter.py in __call__(self, *args, **kwargs)\r\n     83         from .frontend.torch import load\r\n     84 \r\n---> 85         return load(*args, **kwargs)\r\n     86 \r\n     87 \r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/load.py in load(model_spec, debug, **kwargs)\r\n     81             print(\"the following model ops are MISSING:\")\r\n     82             print(\"\\n\".join([\"  \" + str(x) for x in sorted(missing)]))\r\n---> 83         raise e\r\n     84     except Exception as e:\r\n     85         raise e\r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/load.py in load(model_spec, debug, **kwargs)\r\n     73 \r\n     74     try:\r\n---> 75         prog = converter.convert()\r\n     76     except RuntimeError as e:\r\n     77         if debug and \"convert function\" in str(e):\r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/converter.py in convert(self)\r\n    222 \r\n    223             # Add the rest of the operations\r\n--> 224             convert_nodes(self.context, self.graph)\r\n    225 \r\n    226             graph_outputs = [self.context[name] for name in self.graph.outputs]\r\n\r\n~/anaconda3/lib/python3.8/site-packages/coremltools/converters/mil/frontend/torch/ops.py in convert_nodes(context, graph)\r\n     50         _logging.info(\"Converting op {} : {}\".format(node.name, node.kind))\r\n     51         if _add_op is None:\r\n---> 52             raise RuntimeError(\r\n     53                 \"PyTorch convert function for op '{}' not implemented.\".format(node.kind)\r\n     54             )\r\n\r\nRuntimeError: PyTorch convert function for op 'index' not implemented.\r\n```\r\n\r\n\r\n## System Information\r\n\r\ncoremltools version: 4.1\r\nMacOS version: 10.15.7\r\nPython version: 3.8.5\r\nPyTorch version: 1.7.1",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1132/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1132/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1129",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1129/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1129/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1129/events",
      "html_url": "https://github.com/apple/coremltools/issues/1129",
      "id": 825738368,
      "node_id": "MDU6SXNzdWU4MjU3MzgzNjg=",
      "number": 1129,
      "title": "NotImplementedError: Conversion for TF op 'Switch' not implemented.",
      "user": {
        "login": "xaviviro",
        "id": 369452,
        "node_id": "MDQ6VXNlcjM2OTQ1Mg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/369452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/xaviviro",
        "html_url": "https://github.com/xaviviro",
        "followers_url": "https://api.github.com/users/xaviviro/followers",
        "following_url": "https://api.github.com/users/xaviviro/following{/other_user}",
        "gists_url": "https://api.github.com/users/xaviviro/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/xaviviro/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xaviviro/subscriptions",
        "organizations_url": "https://api.github.com/users/xaviviro/orgs",
        "repos_url": "https://api.github.com/users/xaviviro/repos",
        "events_url": "https://api.github.com/users/xaviviro/events{/privacy}",
        "received_events_url": "https://api.github.com/users/xaviviro/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1539237861,
          "node_id": "MDU6TGFiZWwxNTM5MjM3ODYx",
          "url": "https://api.github.com/repos/apple/coremltools/labels/tf2.x%20/%20tf.keras",
          "name": "tf2.x / tf.keras",
          "color": "ff8000",
          "default": false,
          "description": "Issue could be related to tf2.x where coremltools isn't supported (component)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        },
        {
          "id": 2870915972,
          "node_id": "MDU6TGFiZWwyODcwOTE1OTcy",
          "url": "https://api.github.com/repos/apple/coremltools/labels/missing%20layer%20type",
          "name": "missing layer type",
          "color": "0052cc",
          "default": false,
          "description": "Unable to convert a layer type from the relevant framework"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 6,
      "created_at": "2021-03-09T11:04:10Z",
      "updated_at": "2022-03-21T23:11:51Z",
      "closed_at": "2022-03-21T23:11:51Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "NotImplementedError: Conversion for TF op 'Switch' not implemented.\r\n \r\nname: \"batch_normalization_12/cond/Switch\"\r\nop: \"Switch\"\r\ninput: \"keras_learning_phase\"\r\ninput: \"keras_learning_phase\"\r\nattr {\r\n  key: \"T\"\r\n  value {\r\n    type: DT_BOOL\r\n  }\r\n}",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1129/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1129/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1127",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1127/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1127/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1127/events",
      "html_url": "https://github.com/apple/coremltools/issues/1127",
      "id": 823724779,
      "node_id": "MDU6SXNzdWU4MjM3MjQ3Nzk=",
      "number": 1127,
      "title": "Gather operation runs very slow.",
      "user": {
        "login": "leonzfa",
        "id": 8134783,
        "node_id": "MDQ6VXNlcjgxMzQ3ODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8134783?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/leonzfa",
        "html_url": "https://github.com/leonzfa",
        "followers_url": "https://api.github.com/users/leonzfa/followers",
        "following_url": "https://api.github.com/users/leonzfa/following{/other_user}",
        "gists_url": "https://api.github.com/users/leonzfa/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/leonzfa/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/leonzfa/subscriptions",
        "organizations_url": "https://api.github.com/users/leonzfa/orgs",
        "repos_url": "https://api.github.com/users/leonzfa/repos",
        "events_url": "https://api.github.com/users/leonzfa/events{/privacy}",
        "received_events_url": "https://api.github.com/users/leonzfa/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1433388520,
          "node_id": "MDU6TGFiZWwxNDMzMzg4NTIw",
          "url": "https://api.github.com/repos/apple/coremltools/labels/perf",
          "name": "perf",
          "color": "ededed",
          "default": false,
          "description": "Issue is related to performance (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-03-06T19:12:38Z",
      "updated_at": "2021-03-24T22:46:52Z",
      "closed_at": "2021-03-24T22:46:52Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## System Information\r\n- No mater config.computeUnits = MLComputeUnitsAll or  config.computeUnits = MLComputeUnitsCPUOnly, the gather operation runs very slow. I tried to implement gather operation using metal. It runs much faster than the provided operation in MIL. Could you please improve the running speed? Much thanks.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1127/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1127/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1120",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1120/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1120/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1120/events",
      "html_url": "https://github.com/apple/coremltools/issues/1120",
      "id": 819060188,
      "node_id": "MDU6SXNzdWU4MTkwNjAxODg=",
      "number": 1120,
      "title": "'Tensor' object has no attribute 'astype'",
      "user": {
        "login": "NaviTrosa",
        "id": 78093537,
        "node_id": "MDQ6VXNlcjc4MDkzNTM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/78093537?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/NaviTrosa",
        "html_url": "https://github.com/NaviTrosa",
        "followers_url": "https://api.github.com/users/NaviTrosa/followers",
        "following_url": "https://api.github.com/users/NaviTrosa/following{/other_user}",
        "gists_url": "https://api.github.com/users/NaviTrosa/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/NaviTrosa/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/NaviTrosa/subscriptions",
        "organizations_url": "https://api.github.com/users/NaviTrosa/orgs",
        "repos_url": "https://api.github.com/users/NaviTrosa/repos",
        "events_url": "https://api.github.com/users/NaviTrosa/events{/privacy}",
        "received_events_url": "https://api.github.com/users/NaviTrosa/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-03-01T16:55:26Z",
      "updated_at": "2021-03-01T18:35:20Z",
      "closed_at": "2021-03-01T18:35:20Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## System Information\r\n- If applicable\r\n\r\nHi im trying convert pytorch trained model to coreml and while converting i am struct with this issue.\r\ntorch = 1.7.1\r\ntorchvision = 0.8.2\r\ncoremltools = 4.1\r\n\r\nKindly help me in this regard\r\n<img width=\"1009\" alt=\"Screenshot 2021-03-01 at 10 24 01 PM\" src=\"https://user-images.githubusercontent.com/78093537/109530593-e2b77600-7adc-11eb-9f67-3acd93146e72.png\">\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1120/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1120/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1119",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1119/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1119/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1119/events",
      "html_url": "https://github.com/apple/coremltools/issues/1119",
      "id": 817663728,
      "node_id": "MDU6SXNzdWU4MTc2NjM3Mjg=",
      "number": 1119,
      "title": "Will there be Weight_norm Ops for Pytorch conversion?",
      "user": {
        "login": "wuyushuwys",
        "id": 16226176,
        "node_id": "MDQ6VXNlcjE2MjI2MTc2",
        "avatar_url": "https://avatars.githubusercontent.com/u/16226176?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/wuyushuwys",
        "html_url": "https://github.com/wuyushuwys",
        "followers_url": "https://api.github.com/users/wuyushuwys/followers",
        "following_url": "https://api.github.com/users/wuyushuwys/following{/other_user}",
        "gists_url": "https://api.github.com/users/wuyushuwys/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/wuyushuwys/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/wuyushuwys/subscriptions",
        "organizations_url": "https://api.github.com/users/wuyushuwys/orgs",
        "repos_url": "https://api.github.com/users/wuyushuwys/repos",
        "events_url": "https://api.github.com/users/wuyushuwys/events{/privacy}",
        "received_events_url": "https://api.github.com/users/wuyushuwys/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 1433382939,
          "node_id": "MDU6TGFiZWwxNDMzMzgyOTM5",
          "url": "https://api.github.com/repos/apple/coremltools/labels/feature%20request",
          "name": "feature request",
          "color": "c10f47",
          "default": false,
          "description": "Functionality does not currently exist, would need to be created as a new feature (type)"
        },
        {
          "id": 2030793194,
          "node_id": "MDU6TGFiZWwyMDMwNzkzMTk0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/pytorch",
          "name": "pytorch",
          "color": "ff8000",
          "default": false,
          "description": ""
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 4,
      "created_at": "2021-02-26T21:07:28Z",
      "updated_at": "2021-03-08T19:18:47Z",
      "closed_at": "2021-02-27T03:57:48Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "##  Describe your Feature Request\r\n- A clear and concise description of what the problem is.\r\n  - Will coremltools support Pytorch weight_norm ops conversion in the future?\r\n- CoreML / iOS version you are using?\r\n  - coremltools: 4.1\r\n- Are you interested in contributing?\r\n  - No, I am not familiar with this kind of coding.\r\n\r\n## Use cases\r\n- Please describe the use cases\r\n  - convert model from pytorch to coreml. It dose't support Pytorch weight_norm  Ops. hence, i have to convert pytorch model to onnx and then convert onnx model to coreml model like the outdated way.\r\n- Please provide examples\r\n\r\n## Describe alternatives you've considered\r\nA clear and concise description of any alternative solutions or features you've considered.\r\n- convert pytorch model to onnx and then convert onnx model to coreml model is another approach.\r\n## Additional context\r\nAdd any other context or screenshots about the feature request here.\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1119/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1119/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1117",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1117/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1117/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1117/events",
      "html_url": "https://github.com/apple/coremltools/issues/1117",
      "id": 816759288,
      "node_id": "MDU6SXNzdWU4MTY3NTkyODg=",
      "number": 1117,
      "title": "is PyTorch 1.7.x supported?",
      "user": {
        "login": "apivovarov",
        "id": 218087,
        "node_id": "MDQ6VXNlcjIxODA4Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/218087?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apivovarov",
        "html_url": "https://github.com/apivovarov",
        "followers_url": "https://api.github.com/users/apivovarov/followers",
        "following_url": "https://api.github.com/users/apivovarov/following{/other_user}",
        "gists_url": "https://api.github.com/users/apivovarov/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/apivovarov/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/apivovarov/subscriptions",
        "organizations_url": "https://api.github.com/users/apivovarov/orgs",
        "repos_url": "https://api.github.com/users/apivovarov/repos",
        "events_url": "https://api.github.com/users/apivovarov/events{/privacy}",
        "received_events_url": "https://api.github.com/users/apivovarov/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-02-25T20:12:51Z",
      "updated_at": "2021-02-25T20:22:17Z",
      "closed_at": "2021-02-25T20:22:17Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nThe documentation says that coremltools supports PyTorch up to 1.6.0.\r\nhttps://coremltools.readme.io/docs/what-are-coreml-tools#supported-libraries-and-frameworks\r\n\r\nI just want to double check that PyTorch 1.7.x is not supported?\r\n\r\nBTW, default pypi torch version is 1.7.1 (since Dec 10, 2020)\r\nhttps://pypi.org/project/torch/#history",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1117/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1117/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1114",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1114/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1114/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1114/events",
      "html_url": "https://github.com/apple/coremltools/issues/1114",
      "id": 815023151,
      "node_id": "MDU6SXNzdWU4MTUwMjMxNTE=",
      "number": 1114,
      "title": "Converting apple forked tensorflow-2.4 model to mlmodel failed.",
      "user": {
        "login": "wanfade",
        "id": 20272543,
        "node_id": "MDQ6VXNlcjIwMjcyNTQz",
        "avatar_url": "https://avatars.githubusercontent.com/u/20272543?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/wanfade",
        "html_url": "https://github.com/wanfade",
        "followers_url": "https://api.github.com/users/wanfade/followers",
        "following_url": "https://api.github.com/users/wanfade/following{/other_user}",
        "gists_url": "https://api.github.com/users/wanfade/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/wanfade/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/wanfade/subscriptions",
        "organizations_url": "https://api.github.com/users/wanfade/orgs",
        "repos_url": "https://api.github.com/users/wanfade/repos",
        "events_url": "https://api.github.com/users/wanfade/events{/privacy}",
        "received_events_url": "https://api.github.com/users/wanfade/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1539237861,
          "node_id": "MDU6TGFiZWwxNTM5MjM3ODYx",
          "url": "https://api.github.com/repos/apple/coremltools/labels/tf2.x%20/%20tf.keras",
          "name": "tf2.x / tf.keras",
          "color": "ff8000",
          "default": false,
          "description": "Issue could be related to tf2.x where coremltools isn't supported (component)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-02-24T02:32:25Z",
      "updated_at": "2021-02-25T01:15:00Z",
      "closed_at": "2021-02-25T01:15:00Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\nHello developers, \r\n\r\nI'm trying to convert a tensorflow-2.4 model to mlmodel on a M1 ARM Mac.\r\nI installed the tensorflow from https://github.com/apple/tensorflow_macos, which is optimized with ML Compute framework.\r\nBut coremltools got a error like below. So is it possible now to convert to mlmodel with a apple forked version tensorflow-2.4?\r\n\r\n```\r\n>>> import coremltools as ct\r\nWARNING:root:TensorFlow version 2.4.0-rc0 detected. Last version known to be fully compatible is 2.3.1 .\r\n>>> ct.convert(\"./savedmodel\")\r\nRunning TensorFlow Graph Passes: 100%|| 5/5 [00:10<00:00,  2.02s/ passes]\r\nConverting Frontend ==> MIL Ops:  59%|                                 | 382/645 [00:00<00:00, 5548.12 ops/s]\r\nTraceback (most recent call last):\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/_converters_entry.py\", line 175, in convert\r\n    mlmodel = mil_convert(\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 128, in mil_convert\r\n    proto = mil_convert_to_proto(model, convert_from, convert_to,\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 171, in mil_convert_to_proto\r\n    prog = frontend_converter(model, **kwargs)\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/converter.py\", line 75, in __call__\r\n    return tf2_loader.load()\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/load.py\", line 79, in load\r\n    program = self._program_from_tf_ssa()\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow2/load.py\", line 177, in _program_from_tf_ssa\r\n    return converter.convert()\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/converter.py\", line 406, in convert\r\n    self.convert_main_graph(prog, graph)\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/converter.py\", line 335, in convert_main_graph\r\n    outputs = convert_graph(self.context, graph, self.outputs)\r\n  File \"/Users/administrator/miniforge3/envs/py38/lib/python3.8/site-packages/coremltools/converters/mil/frontend/tensorflow/convert_utils.py\", line 180, in convert_graph\r\n    raise NotImplementedError(msg)\r\nNotImplementedError: Conversion for TF op 'MLCConv2D' not implemented.\r\n\r\nname: \"StatefulPartitionedCall/model/conv2d/Conv2D\"\r\nop: \"MLCConv2D\"\r\ninput: \"input_1\"\r\ninput: \"StatefulPartitionedCall/model/conv2d/Conv2D/ReadVariableOp\"\r\nattr {\r\n  key: \"T\"\r\n  value {\r\n    type: DT_FLOAT\r\n  }\r\n}\r\nattr {\r\n  key: \"data_format\"\r\n  value {\r\n    s: \"NHWC\"\r\n  }\r\n}\r\nattr {\r\n  key: \"dilations\"\r\n  value {\r\n    list {\r\n      i: 1\r\n      i: 1\r\n      i: 1\r\n      i: 1\r\n    }\r\n  }\r\n}\r\nattr {\r\n  key: \"explicit_paddings\"\r\n  value {\r\n    list {\r\n    }\r\n  }\r\n}\r\nattr {\r\n  key: \"num_args\"\r\n  value {\r\n    i: 0\r\n  }\r\n}\r\nattr {\r\n  key: \"padding\"\r\n  value {\r\n    s: \"SAME\"\r\n  }\r\n}\r\nattr {\r\n  key: \"strides\"\r\n  value {\r\n    list {\r\n      i: 1\r\n      i: 1\r\n      i: 1\r\n      i: 1\r\n    }\r\n  }\r\n}\r\nattr {\r\n  key: \"transpose\"\r\n  value {\r\n    b: false\r\n  }\r\n}\r\nattr {\r\n  key: \"use_cudnn_on_gpu\"\r\n  value {\r\n    b: true\r\n  }\r\n}\r\n```\r\n\r\n## System Information\r\n- If applicable\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1114/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1114/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1113",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1113/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1113/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1113/events",
      "html_url": "https://github.com/apple/coremltools/issues/1113",
      "id": 814831163,
      "node_id": "MDU6SXNzdWU4MTQ4MzExNjM=",
      "number": 1113,
      "title": "Why numpy 1.20.1 is not supported?",
      "user": {
        "login": "apivovarov",
        "id": 218087,
        "node_id": "MDQ6VXNlcjIxODA4Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/218087?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apivovarov",
        "html_url": "https://github.com/apivovarov",
        "followers_url": "https://api.github.com/users/apivovarov/followers",
        "following_url": "https://api.github.com/users/apivovarov/following{/other_user}",
        "gists_url": "https://api.github.com/users/apivovarov/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/apivovarov/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/apivovarov/subscriptions",
        "organizations_url": "https://api.github.com/users/apivovarov/orgs",
        "repos_url": "https://api.github.com/users/apivovarov/repos",
        "events_url": "https://api.github.com/users/apivovarov/events{/privacy}",
        "received_events_url": "https://api.github.com/users/apivovarov/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373893,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTM=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/duplicate",
          "name": "duplicate",
          "color": "27bbce",
          "default": true,
          "description": "Status: Progress will be shown on similar, previously logged issue (status)"
        },
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-02-23T21:06:56Z",
      "updated_at": "2021-02-23T21:58:54Z",
      "closed_at": "2021-02-23T21:58:54Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Setup.py says that numpy version should be less than 1.20\r\nhttps://github.com/apple/coremltools/blob/master/setup.py#L72\r\n\r\nDefault numpy version in pypi is 1.20.1 https://pypi.org/project/numpy/\r\n\r\nWhy coremltools is not supporting default numpy version?\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1113/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1113/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1112",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1112/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1112/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1112/events",
      "html_url": "https://github.com/apple/coremltools/issues/1112",
      "id": 814277954,
      "node_id": "MDU6SXNzdWU4MTQyNzc5NTQ=",
      "number": 1112,
      "title": "Predictions from CoreML model ",
      "user": {
        "login": "asimniazi63",
        "id": 15937296,
        "node_id": "MDQ6VXNlcjE1OTM3Mjk2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15937296?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/asimniazi63",
        "html_url": "https://github.com/asimniazi63",
        "followers_url": "https://api.github.com/users/asimniazi63/followers",
        "following_url": "https://api.github.com/users/asimniazi63/following{/other_user}",
        "gists_url": "https://api.github.com/users/asimniazi63/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/asimniazi63/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/asimniazi63/subscriptions",
        "organizations_url": "https://api.github.com/users/asimniazi63/orgs",
        "repos_url": "https://api.github.com/users/asimniazi63/repos",
        "events_url": "https://api.github.com/users/asimniazi63/events{/privacy}",
        "received_events_url": "https://api.github.com/users/asimniazi63/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-02-23T09:29:03Z",
      "updated_at": "2021-02-25T06:29:22Z",
      "closed_at": "2021-02-25T06:29:22Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\n\r\n## System Information\r\n- Is this problem at coremltools end or TVM (i got this from documentaton)\r\n\r\nHi, I am trying to get predictions from CoreML model and I got this error. Pasted below:\r\n\r\nTraceback (most recent call last):\r\n  File \"tvm_coreml.py\", line 25, in <module>\r\n    mod, params = relay.frontend.from_coreml(mlmodel, shape_dict)\r\n  File \"/home/asim/.local/lib/python3.8/site-packages/tvm-0.8.dev609+gcfe88c1ee-py3.8-linux-x86_64.egg/tvm/relay/frontend/coreml.py\", line 593, in from_coreml\r\n    coreml_op_to_relay(layerop, list(l.input), l.output, etab)\r\n  File \"/home/asim/.local/lib/python3.8/site-packages/tvm-0.8.dev609+gcfe88c1ee-py3.8-linux-x86_64.egg/tvm/relay/frontend/coreml.py\", line 513, in coreml_op_to_relay\r\n    raise tvm.error.OpNotImplemented(\r\ntvm.error.OpNotImplemented: Operator LoadConstantNDLayerParams is not supported in frontend CoreML.\r\n\r\nCode:\r\n```\r\nimage = np.expand_dims(image, 0)\r\nmask = np.expand_dims(mask, 0)\r\n\r\n\r\ntarget = \"llvm\"\r\nshape_dict = {\"import/image:0\": image, \"import/mask:0\": mask }\r\n\r\n# Parse CoreML model and convert into Relay computation graph\r\nmod, params = relay.frontend.from_coreml(mlmodel, shape_dict)\r\n```\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1112/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1112/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1106",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1106/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1106/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1106/events",
      "html_url": "https://github.com/apple/coremltools/issues/1106",
      "id": 812243775,
      "node_id": "MDU6SXNzdWU4MTIyNDM3NzU=",
      "number": 1106,
      "title": "Core ML exception=ANECF error:",
      "user": {
        "login": "Siq1982",
        "id": 78929964,
        "node_id": "MDQ6VXNlcjc4OTI5OTY0",
        "avatar_url": "https://avatars.githubusercontent.com/u/78929964?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Siq1982",
        "html_url": "https://github.com/Siq1982",
        "followers_url": "https://api.github.com/users/Siq1982/followers",
        "following_url": "https://api.github.com/users/Siq1982/following{/other_user}",
        "gists_url": "https://api.github.com/users/Siq1982/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Siq1982/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Siq1982/subscriptions",
        "organizations_url": "https://api.github.com/users/Siq1982/orgs",
        "repos_url": "https://api.github.com/users/Siq1982/repos",
        "events_url": "https://api.github.com/users/Siq1982/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Siq1982/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 2,
      "created_at": "2021-02-19T18:30:56Z",
      "updated_at": "2021-10-22T20:52:20Z",
      "closed_at": "2021-10-22T20:52:20Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "I am using converted mlmodel. MLmodel works without crashes and errors on Mac mini. It works on iOS too, but with errors and very slowly.I has the next errors\r\n\r\n[espresso] [Espresso::handle_ex_plan] exception=ANECF error:\r\n\r\n[coreml] Error plan build: -1.\r\n\r\n[client] doUnloadModel:options:qos:error:: nil _ANEModel\r\n\r\n[espresso] ANECF error:What do these errors mean? I cannot find anything about it in the Internet. What should I do to avoid these errors? \r\n\r\n## Question\r\n\r\n## System Information\r\n- If applicable\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1106/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1106/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1104",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1104/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1104/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1104/events",
      "html_url": "https://github.com/apple/coremltools/issues/1104",
      "id": 811760410,
      "node_id": "MDU6SXNzdWU4MTE3NjA0MTA=",
      "number": 1104,
      "title": "upsample_bilinear cannot work with dynamic input shapes",
      "user": {
        "login": "buptlj",
        "id": 22720234,
        "node_id": "MDQ6VXNlcjIyNzIwMjM0",
        "avatar_url": "https://avatars.githubusercontent.com/u/22720234?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/buptlj",
        "html_url": "https://github.com/buptlj",
        "followers_url": "https://api.github.com/users/buptlj/followers",
        "following_url": "https://api.github.com/users/buptlj/following{/other_user}",
        "gists_url": "https://api.github.com/users/buptlj/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/buptlj/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/buptlj/subscriptions",
        "organizations_url": "https://api.github.com/users/buptlj/orgs",
        "repos_url": "https://api.github.com/users/buptlj/repos",
        "events_url": "https://api.github.com/users/buptlj/events{/privacy}",
        "received_events_url": "https://api.github.com/users/buptlj/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        },
        {
          "id": 1564616064,
          "node_id": "MDU6TGFiZWwxNTY0NjE2MDY0",
          "url": "https://api.github.com/repos/apple/coremltools/labels/awaiting%20response",
          "name": "awaiting response",
          "color": "27bbce",
          "default": false,
          "description": "Please respond to this issue to provide further clarification (status)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 3,
      "created_at": "2021-02-19T07:03:39Z",
      "updated_at": "2021-10-22T20:49:23Z",
      "closed_at": "2021-10-22T20:49:23Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nWhen converting PyTorch bilinear upsampling to CoreML with dynamic input shapes, i encounter an error:\r\n```\r\ncoremltools/converters/mil/mil/ops/defs/image_resizing.py\", line 149, in type_inference  \r\n\r\n    ret_shape[-1] = np.floor(self.scale_factor_width.val * ret_shape[-1])  \r\n\r\n  File \"/home/mi/anaconda3/envs/zero-dce/lib/python3.8/site-packages/sympy/core/expr.py\", line 350, in __float__  \r\n\r\n    raise TypeError(\"can't convert expression to float\")\r\n```\r\n\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1104/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1104/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1103",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1103/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1103/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1103/events",
      "html_url": "https://github.com/apple/coremltools/issues/1103",
      "id": 810392872,
      "node_id": "MDU6SXNzdWU4MTAzOTI4NzI=",
      "number": 1103,
      "title": "It seems that gather operation only runs on CPU.",
      "user": {
        "login": "leonzfa",
        "id": 8134783,
        "node_id": "MDQ6VXNlcjgxMzQ3ODM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8134783?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/leonzfa",
        "html_url": "https://github.com/leonzfa",
        "followers_url": "https://api.github.com/users/leonzfa/followers",
        "following_url": "https://api.github.com/users/leonzfa/following{/other_user}",
        "gists_url": "https://api.github.com/users/leonzfa/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/leonzfa/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/leonzfa/subscriptions",
        "organizations_url": "https://api.github.com/users/leonzfa/orgs",
        "repos_url": "https://api.github.com/users/leonzfa/repos",
        "events_url": "https://api.github.com/users/leonzfa/events{/privacy}",
        "received_events_url": "https://api.github.com/users/leonzfa/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-02-17T17:35:40Z",
      "updated_at": "2022-03-25T00:21:10Z",
      "closed_at": "2022-03-25T00:21:10Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "## Question\r\nI convert Pytorch model to mlmodel. The operation in Pytorch is torch.gather, and it becomes GatherAlongAxis in mlmodel.\r\n\r\nI set the computeUnits to  MLComputeUnitsCPUOnly and MLComputeUnitsAll, respectively. However, the run-time is the same!! So the gather operation can only run in CPU? Can it be accelerated in ANE?\r\n\r\nMy test code contains only conv and gather.\r\n```\r\nimport torch\r\nimport torch.nn as nn\r\nimport torch.nn.functional as F\r\n\r\ndef conv(in_planes, out_planes, kernel_size=3, stride=1, padding=1, dilation=1):\r\n    return nn.Sequential(\r\n        nn.Conv2d(in_planes, out_planes, kernel_size=kernel_size, stride=stride,\r\n                  padding=padding, dilation=dilation, bias=False),\r\n        nn.BatchNorm2d(out_planes),\r\n        nn.ReLU(out_planes)\r\n    )\r\n\r\n\r\nclass gatherNet(nn.Module):\r\n    def __init__(self):\r\n        super(gatherNet, self).__init__()\r\n        channel = 8\r\n        self.channel = channel\r\n        idx_a = (torch.arange(512*512)+1)%262144\r\n        self.idx_a = idx_a.unsqueeze(1).repeat(1,channel).type(torch.LongTensor)\r\n        idx_b = (torch.arange(512*512)+2)%262144\r\n        self.idx_b = idx_b.unsqueeze(1).repeat(1,channel).type(torch.LongTensor)\r\n        idx_c = (torch.arange(512*512)+3)%262144\r\n        self.idx_c = idx_c.unsqueeze(1).repeat(1,channel).type(torch.LongTensor)\r\n        idx_d = (torch.arange(512*512)+4)%262144\r\n        self.idx_d = idx_d.unsqueeze(1).repeat(1,channel).type(torch.LongTensor)\r\n        \r\n        self.conv0 = conv(3, channel, 3, 1, 1)\r\n        self.conv1 = conv(channel, channel, 3, 1, 1)\r\n        self.conv2 = conv(channel, channel, 3, 1, 1)\r\n        self.conv3 = conv(channel, channel, 3, 1, 1)\r\n        self.conv4 = conv(channel, channel, 3, 1, 1)\r\n        self.conv5 = conv(channel, channel, 3, 1, 1)\r\n        self.conv6 = conv(channel, channel, 3, 1, 1)\r\n        self.final = nn.Conv2d(channel, 3, kernel_size=3, stride=1,\r\n                  padding=1, bias=False)\r\n        \r\n    \r\n    def forward(self, imgs):\r\n        x0 = self.conv0(imgs)\r\n        x1 = self.conv1(x0)\r\n        x1 = x1.reshape(-1, self.channel)\r\n        #ya = x1*0\r\n        #yb = x1*0\r\n        #yc = x1*0\r\n        #yd = x1*0\r\n        yd = x1\r\n        #for i in range(100):\r\n        ya =  torch.gather(yd, dim=0, index=self.idx_a)\r\n        yb =  torch.gather(ya, dim=0, index=self.idx_b)\r\n        yc =  torch.gather(yb, dim=0, index=self.idx_c)\r\n        yd =  torch.gather(yc, dim=0, index=self.idx_d)\r\n        \r\n        ya =  torch.gather(yd, dim=0, index=self.idx_a)\r\n        yb =  torch.gather(ya, dim=0, index=self.idx_b)\r\n        yc =  torch.gather(yb, dim=0, index=self.idx_c)\r\n        yd =  torch.gather(yc, dim=0, index=self.idx_d)\r\n        \r\n        ya =  torch.gather(yd, dim=0, index=self.idx_a)\r\n        yb =  torch.gather(ya, dim=0, index=self.idx_b)\r\n        yc =  torch.gather(yb, dim=0, index=self.idx_c)\r\n        yd =  torch.gather(yc, dim=0, index=self.idx_d)\r\n        \r\n        ya =  torch.gather(yd, dim=0, index=self.idx_a)\r\n        yb =  torch.gather(ya, dim=0, index=self.idx_b)\r\n        yc =  torch.gather(yb, dim=0, index=self.idx_c)\r\n        yd =  torch.gather(yc, dim=0, index=self.idx_d)\r\n        \r\n        ya =  torch.gather(yd, dim=0, index=self.idx_a)\r\n        yb =  torch.gather(ya, dim=0, index=self.idx_b)\r\n        yc =  torch.gather(yb, dim=0, index=self.idx_c)\r\n        yd =  torch.gather(yc, dim=0, index=self.idx_d)\r\n\r\n\r\n        fout = ya+yb+yc+yd\r\n        fout = fout.reshape(1,self.channel, 512, 512)\r\n        fout = self.final(fout)\r\n        out = torch.sigmoid(fout) * 255\r\n        return out\r\n\r\n```\r\nThe code I used to convert my model is as follows:\r\n```\r\nimport torch\r\nimport coremltools as ct\r\nimport coremltools.proto.FeatureTypes_pb2 as ft\r\nfrom coremltools.models.neural_network import flexible_shape_utils\r\n\r\nfrom gatherNet import gatherNet as gmodel\r\nimport numpy as np\r\n\r\n#define model\r\nmodel = gmodel()\r\nmodel.eval()\r\n\r\nhh = 512\r\nww = 512\r\nimgs = torch.rand((1,3,hh,ww))\r\nout  = model(imgs)\r\nprint(out.shape)\r\n\r\ntraced_model = torch.jit.trace(model, imgs)\r\n# image type\r\nimage_input = ct.ImageType(shape=(1, 3, hh, ww), bias=[0,0,0], scale=1/255)\r\nmlmodel = ct.convert(traced_model, inputs=[image_input])\r\nspec = mlmodel.get_spec()\r\ninput = spec.description.input[0]\r\nct.utils.rename_feature(spec, input.name, 'image')\r\n\r\noutput = spec.description.output[0]\r\noutput.type.imageType.colorSpace = ft.ImageFeatureType.RGB\r\noutput.type.imageType.height = hh\r\noutput.type.imageType.width = ww\r\nct.utils.rename_feature(spec, output.name, 'output')\r\n\r\nimg_size_ranges = flexible_shape_utils.NeuralNetworkImageSizeRange(height_range=(256, 4096), width_range=(256, 4096))\r\nflexible_shape_utils.update_image_size_range(spec, feature_name='image', size_range=img_size_ranges)\r\nflexible_shape_utils.update_image_size_range(spec, feature_name='output', size_range=img_size_ranges)\r\n\r\nct.utils.save_spec(spec, \"gather.mlmodel\")\r\nprint('Converted!!!')\r\n```\r\n\r\n\r\n## System Information\r\n- coremltools 4.1\r\n- Xcode 12.3\r\n- Pytorch 1.5.0\r\n- Python 3.6.2\r\n- Mac 11.1\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1103/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1103/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    },
    {
      "url": "https://api.github.com/repos/apple/coremltools/issues/1102",
      "repository_url": "https://api.github.com/repos/apple/coremltools",
      "labels_url": "https://api.github.com/repos/apple/coremltools/issues/1102/labels{/name}",
      "comments_url": "https://api.github.com/repos/apple/coremltools/issues/1102/comments",
      "events_url": "https://api.github.com/repos/apple/coremltools/issues/1102/events",
      "html_url": "https://github.com/apple/coremltools/issues/1102",
      "id": 809846918,
      "node_id": "MDU6SXNzdWU4MDk4NDY5MTg=",
      "number": 1102,
      "title": "Will CoreML use the GPU automatically?",
      "user": {
        "login": "59339639",
        "id": 6176863,
        "node_id": "MDQ6VXNlcjYxNzY4NjM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6176863?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/59339639",
        "html_url": "https://github.com/59339639",
        "followers_url": "https://api.github.com/users/59339639/followers",
        "following_url": "https://api.github.com/users/59339639/following{/other_user}",
        "gists_url": "https://api.github.com/users/59339639/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/59339639/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/59339639/subscriptions",
        "organizations_url": "https://api.github.com/users/59339639/orgs",
        "repos_url": "https://api.github.com/users/59339639/repos",
        "events_url": "https://api.github.com/users/59339639/events{/privacy}",
        "received_events_url": "https://api.github.com/users/59339639/received_events",
        "type": "User",
        "site_admin": false
      },
      "labels": [
        {
          "id": 637373897,
          "node_id": "MDU6TGFiZWw2MzczNzM4OTc=",
          "url": "https://api.github.com/repos/apple/coremltools/labels/question",
          "name": "question",
          "color": "c10f47",
          "default": true,
          "description": "Response providing clarification needed. Will not be assigned to a release. (type)"
        }
      ],
      "state": "closed",
      "locked": false,
      "assignee": null,
      "assignees": [

      ],
      "milestone": null,
      "comments": 1,
      "created_at": "2021-02-17T04:39:39Z",
      "updated_at": "2021-10-22T20:45:03Z",
      "closed_at": "2021-10-22T20:45:03Z",
      "author_association": "NONE",
      "active_lock_reason": null,
      "body": "Not very fast in MacBookPro. \r\nOriginal Model with CPU cost about 1.2s\r\nWhile the converted CoreML model cost about 0.5s. \r\nNot sure if it speed up. \r\n\r\n## Question\r\n\r\n## System Information\r\n- If applicable\r\n",
      "reactions": {
        "url": "https://api.github.com/repos/apple/coremltools/issues/1102/reactions",
        "total_count": 0,
        "+1": 0,
        "-1": 0,
        "laugh": 0,
        "hooray": 0,
        "confused": 0,
        "heart": 0,
        "rocket": 0,
        "eyes": 0
      },
      "timeline_url": "https://api.github.com/repos/apple/coremltools/issues/1102/timeline",
      "performed_via_github_app": null,
      "score": 1.0
    }
  ]
}
